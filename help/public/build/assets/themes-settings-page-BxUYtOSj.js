import{r as j,f as b,j as e,aw as z,aj as B,ax as L,az as y,T as l,av as w,t as q,m as f,d as _,al as $,am as A,an as M,ap as E,aP as O,aq as R,B as T,F as U,e as D,y as G,af as H,aG as K,bG as J,bB as Q,p as X}from"./client-DtfdVV77.js";import{A as Y}from"./admin-config-DXsixO44.js";import{u as v}from"./settings-layout-FQP6W4_q.js";import{a as Z,S as k}from"./settings-section-button-CSsdbx0L.js";import{u as F}from"./use-admin-settings-DArjpbC9.js";import{D as ee}from"./Delete-DWP7kvj0.js";import{M as se}from"./MoreVert-BVDYtk4z.js";import{R as te}from"./RestartAlt-DTi82oFC.js";import{T as ae}from"./Tune-B3kaKuXY.js";import{C as re}from"./confirmation-dialog-BzXs9ksK.js";import{A as ie}from"./Add-B1HfWgJf.js";import{S as le,F as oe}from"./select-D9niWe2H.js";import{C as ne}from"./color-picker-dialog-CeCHU4u7.js";import{$ as me}from"./Color-DrXN9ww8.js";import{t as de}from"./theme-value-to-hex-rRzfvjBj.js";import{l as ce}from"./main-BGmGAxtx.js";import{F as ue}from"./font-selector-fL3ytPy7.js";import{A as he,a as N}from"./accordion-Dmxnze9z.js";import"./dashboard-icons-BJ4c3Z5i.js";import"./library-icon-h4d3s9Ef.js";import"./messages-square-icon-D_3IR-rK.js";import"./Home-iO0iebLw.js";import"./SupervisorAccount-Bkn2ibMi.js";import"./Translate-DPB2wdvD.js";import"./TextFields-CM1xUWDR.js";import"./settings-links-CRsxvJIZ.js";import"./external-link-Cxcw6nc_.js";import"./book-open-D91H26Dq.js";import"./custom-menu-Dvq-fOnC.js";import"./use-admin-settings-page-nav-config-D58KRD8y.js";import"./datatable-page-with-header-layout-xcCtlWaX.js";import"./use-toggle-dashboard-left-sidebar-DxaOS7gK.js";import"./toggle-left-sidebar-icon-j-5uTef5.js";import"./file-upload-provider-B4w-VsYu.js";import"./uploaded-file-DOXWsty7.js";import"./pretty-bytes-bO14ePu9.js";import"./with-selector-DPNnjGhI.js";import"./useMutationState-Bmyxea6H.js";import"./blocker-dialog-B0Vc-LIE.js";import"./OpenInFull-mOMLBQ1Z.js";import"./useSuspenseQuery-Bmt2-NKx.js";import"./combobox-end-adornment-CWQ4Xgal.js";import"./use-filter-XfxMyUPQ.js";import"./skeleton-D178v0-U.js";import"./accordtion-animation-BGCK95Hj.js";function fe({selectedThemeId:a,initialThemeId:r,onSelectedThemeChange:i}){const o=v(u=>u.preview),[d,m]=j.useState(!1),[s,h]=j.useState(!1),{setValue:n,getValues:c}=b(),{data:{defaults:x}}=F(),t=()=>{if(c("themes").length<=1){q.danger(f("At least one theme is required"));return}if(a){n("themes",c("themes").filter(p=>p.id!==a),{shouldDirty:!0});const u=c("themes").find(p=>p.id===r);r===a?window.location.reload():i(u?r:c("themes")[0].id)}},g=()=>{const p=`themes.${c("themes").findIndex(C=>C.id===a)}`,S=c(`${p}.is_dark`)?x.themes.dark:x.themes.light;Object.entries(S).forEach(([C,W])=>{o.setThemeValue(C,W)}),o.setThemeFont(null),n(`${p}.values`,S,{shouldDirty:!0}),n(`${p}.font`,void 0,{shouldDirty:!0})};return e.jsxs(j.Fragment,{children:[e.jsxs(z,{children:[e.jsx(B,{variant:"outline",size:"sm",children:e.jsx(se,{})}),e.jsxs(L,{children:[e.jsx(y,{value:"settings",startIcon:e.jsx(ae,{}),onSelected:()=>h(!0),children:e.jsx(l,{message:"Settings"})}),e.jsx(y,{value:"reset",startIcon:e.jsx(te,{}),onSelected:()=>g(),children:e.jsx(l,{message:"Reset to default"})}),e.jsx(y,{value:"delete",startIcon:e.jsx(ee,{}),onSelected:()=>m(!0),children:e.jsx(l,{message:"Delete"})})]})]}),e.jsx(w,{type:"modal",isOpen:d,onClose:u=>{u&&t(),m(!1)},children:e.jsx(re,{isDanger:!0,title:e.jsx(l,{message:"Delete theme"}),body:e.jsx(l,{message:"Are you sure you want to delete this theme?"}),confirm:e.jsx(l,{message:"Delete"})})}),e.jsx(w,{type:"modal",isOpen:s,onClose:()=>h(!1),children:e.jsx(xe,{theme:c("themes").find(u=>u.id===a)})})]})}function xe({theme:a}){const r=b(),i=_({defaultValues:a}),{close:o,formId:d}=$();j.useEffect(()=>{const s=i.watch((h,{name:n})=>{n==="default_light"&&h.default_light&&i.setValue("default_dark",!1),n==="default_dark"&&h.default_dark&&i.setValue("default_light",!1)});return()=>s.unsubscribe()},[i]);const m=s=>{r.getValues("themes").forEach((h,n)=>{if(h.id===s.id){r.setValue(`themes.${n}`,s,{shouldDirty:!0});return}if(s.default_light){r.setValue(`themes.${n}`,{...h,default_light:!1},{shouldDirty:!0});return}if(s.default_dark){r.setValue(`themes.${n}`,{...h,default_dark:!1},{shouldDirty:!0});return}})};return e.jsxs(A,{children:[e.jsx(M,{children:e.jsx(l,{message:"Update settings"})}),e.jsx(E,{children:e.jsx(O,{form:i,id:d,onSubmit:s=>{m(s),o()},children:e.jsx(P,{})})}),e.jsxs(R,{children:[e.jsx(T,{onClick:()=>{o()},children:e.jsx(l,{message:"Cancel"})}),e.jsx(T,{variant:"flat",color:"primary",type:"submit",form:d,disabled:!i.formState.isDirty,children:e.jsx(l,{message:"Save"})})]})]})}function P(){return e.jsxs(j.Fragment,{children:[e.jsx(U,{name:"name",label:e.jsx(l,{message:"Name"}),className:"mb-24",autoFocus:!0,required:!0}),e.jsx(D,{name:"is_dark",className:"mb-20 border-b pb-20",description:e.jsx(l,{message:"Whether this theme has light text on dark background."}),children:e.jsx(l,{message:"Dark theme"})}),e.jsx(D,{name:"default_light",className:"mb-24",description:e.jsx(l,{message:"When light mode is selected, this theme will be used."}),children:e.jsx(l,{message:"Default for light mode"})}),e.jsx(D,{name:"default_dark",description:e.jsx(l,{message:"When dark mode is selected, this theme will be used."}),children:e.jsx(l,{message:"Default for dark mode"})})]})}function ge(a=1,r=1e4){const i=new Uint32Array(1);window.crypto.getRandomValues(i);const o=i[0]/4294967296;return a=Math.ceil(a),r=Math.floor(r),Math.floor(o*(r-a+1))+a}function pe({type:a="site",onCreated:r}){return e.jsxs(w,{type:"modal",onClose:i=>{i!=null&&(r==null||r(i))},children:[e.jsx(B,{variant:"outline",shadow:"shadow",size:"sm",className:"ml-auto",children:e.jsx(ie,{})}),e.jsx(je,{type:a})]})}function je({type:a}){const{formId:r,close:i}=$(),{data:{defaults:o}}=F(),d=b(),m=_({defaultValues:{default_dark:!1,default_light:!1,is_dark:!1}}),s=h=>{const n=h.is_dark?o.themes.dark:o.themes.light,c=d.getValues("themes"),x=ge(100,1e3);d.setValue("themes",[...c,{...h,id:x,type:a,values:n}],{shouldDirty:!0}),i(x)};return e.jsxs(A,{children:[e.jsx(M,{children:e.jsx(l,{message:"New theme"})}),e.jsx(E,{children:e.jsx(O,{id:r,form:m,onSubmit:s,children:e.jsx(P,{})})}),e.jsxs(R,{children:[e.jsx(T,{onClick:()=>i(),children:e.jsx(l,{message:"Cancel"})}),e.jsx(T,{variant:"flat",color:"primary",type:"submit",form:r,disabled:!m.formState.isDirty,children:e.jsx(l,{message:"Save"})})]})]})}function be({selectedThemeId:a,onSelectionChange:r,allThemes:i}){return e.jsx(le,{size:"sm",selectionMode:"single",selectedValue:a,onSelectionChange:o=>r(o),appearance:"dropdown",children:i.map(o=>e.jsx(y,{value:o.id,children:o.name},o.id))})}const ye=G(e.jsx("path",{stroke:"#E0E0E0",d:"M24,44c-7.168,0-13-5.816-13-12.971C11,24,24,4,24,4s13,20,13,27.029C37,38.184,31.168,44,24,44z"}));function I(a){return me(a).toString("rgb").replace("rgb(","").replace(")","").replace(/, ?/g," ")}function ve({label:a,colorName:r,initialThemeValue:i,themeId:o,size:d="lg"}){const m=v(t=>t.preview),{setValue:s,getValues:h}=b(),[n,c]=j.useState(i),x=t=>{c(t),m.setThemeValue(r,t)};return j.useEffect(()=>{c(i)},[i]),e.jsxs(w,{value:de(n),type:"popover",placement:"right",offset:10,onValueChange:t=>{x(I(t))},onClose:(t,{valueChanged:g,initialValue:u})=>{if(t&&g){const p=h("themes").findIndex(S=>S.id===o);s(`themes.${p}.values.${r}`,I(t),{shouldDirty:!0})}else x(u?I(u):"")},children:[e.jsx(Z,{size:d,radius:"rounded-panel",startIcon:e.jsx(ye,{viewBox:"0 0 48 48",className:"icon-lg",style:{fill:n.startsWith("#")?n:`rgb(${n})`}}),children:a}),e.jsx(ne,{})]})}const Se=[{label:f("Background"),key:"--be-background"},{label:f("Background alt"),key:"--be-bg-alt"},{label:f("Background elevated"),key:"--be-bg-elevated"},{label:f("Foreground"),key:"--be-fg-base"},{label:f("Accent light"),key:"--be-primary-light"},{label:f("Accent"),key:"--be-primary"},{label:f("Accent dark"),key:"--be-primary-dark"},{label:f("Text on accent"),key:"--be-on-primary"},{label:f("Chip"),key:"--be-bg-chip"}],ke={"rounded-none":{label:f("Square"),value:"0px"},rounded:{label:f("Small"),value:"0.25rem"},"rounded-md":{label:f("Medium"),value:"0.375rem"},"rounded-lg":{label:f("Large"),value:"0.5rem"},"rounded-xl":{label:f("Larger"),value:"0.75rem"},"rounded-full":{label:f("Pill"),value:"9999px"}};function ps(){var d,m;const{data:a}=F(),{auth:r}=j.use(ce),i=a.themes.filter(s=>s.type==="site"),o=_({defaultValues:{themes:i,client:{themes:{default_id:(d=a.client.themes)!=null&&d.default_id?parseInt(a.client.themes.default_id):0,user_change:((m=a.client.themes)==null?void 0:m.user_change)??!1}}}});return e.jsxs(k,{title:e.jsx(l,{message:"Themes"}),defaultRoute:H().auth_redirect_uri??"/",docsLink:Y.settings.themes,children:[e.jsx(k.Content,{children:e.jsxs(k.Form,{form:o,children:[e.jsxs("div",{className:"mb-20 border-b pb-20",children:[e.jsxs(oe,{className:"mb-20",size:"sm",name:"client.themes.default_id",selectionMode:"single",label:e.jsx(l,{message:"Default site theme"}),children:[e.jsx(y,{value:0,children:e.jsx(l,{message:"System"})}),i.map(s=>e.jsx(y,{value:s.id,children:s.name},s.id))]}),e.jsx(D,{name:"client.themes.user_change",children:e.jsx(l,{message:"Allow users to switch theme"})})]}),e.jsx(De,{})]})}),e.jsx(k.Preview,{})]})}function De({size:a="lg",type:r="site"}){var x;const i=v(t=>t.preview),o=b(),d=K({name:"themes"}).filter(t=>t.type===r),{selectedTheme:m}=J(),[s,h]=j.useState(()=>{var g;const t=d.find(u=>u.id===m.id);return t?t.id:(g=d[0])==null?void 0:g.id}),n=o.watch("themes").find(t=>t.id===s),c=t=>{if(t===s)return;h(t);const g=o.getValues("themes").find(u=>u.id===t);g&&i.setActiveTheme(g.id)};return e.jsxs("div",{children:[e.jsxs("div",{className:"mb-24 flex items-center gap-8",children:[e.jsx(be,{selectedThemeId:s,onSelectionChange:c,allThemes:d}),e.jsx(fe,{selectedThemeId:s,initialThemeId:m.id,onSelectedThemeChange:c}),e.jsx(pe,{type:r,onCreated:c})]}),e.jsxs(he,{variant:"outline",size:a,className:"mb-10",children:[e.jsx(N,{fontClassName:"text-sm",label:e.jsx(l,{message:"Font"}),descriptionClassName:"overflow-hidden text-ellipsis whitespace-nowrap text-xs text-muted",description:(x=n==null?void 0:n.font)!=null&&x.family?n.font.family:e.jsx(l,{message:"System"}),children:e.jsx(we,{themeId:s})}),e.jsxs(N,{label:e.jsx(l,{message:"Rounding"}),fontClassName:"text-sm",children:[e.jsx(V,{label:e.jsx(l,{message:"Button rounding"}),name:"button-radius",themeId:s,className:"mb-24"}),e.jsx(V,{label:e.jsx(l,{message:"Input rounding"}),name:"input-radius",themeId:s,className:"mb-24"}),e.jsx(V,{label:e.jsx(l,{message:"Panel rounding"}),name:"panel-radius",hidePill:!0,themeId:s})]})]}),Se.map(t=>e.jsx(ve,{colorName:t.key,size:a,label:e.jsx(l,{...t.label}),initialThemeValue:(n==null?void 0:n.values[t.key])??"",themeId:s},t.key))]})}function we({themeId:a}){const r=v(s=>s.preview),{setValue:i,watch:o}=b(),m=`themes.${o("themes").findIndex(s=>s.id===a)}.font`;return e.jsx(ue,{value:o(m),onChange:s=>{i(m,s,{shouldDirty:!0}),r.setThemeFont(s)}})}function V({label:a,name:r,hidePill:i,themeId:o,className:d}){const m=v(t=>t.preview),{watch:s,setValue:h}=b(),c=`themes.${s("themes").findIndex(t=>t.id===o)}.values.--be-${r}`,x=s(c);return e.jsxs("div",{className:d,children:[e.jsx("div",{className:"mb-10 text-sm font-semibold",children:a}),e.jsx("div",{className:"grid grid-cols-3 gap-10 text-sm",children:Object.entries(ke).filter(([t])=>!i||!t.includes("full")).map(([t,{label:g,value:u}])=>e.jsx(Q,{display:"block",className:X("h-36 border-2 hover:bg-hover",t,u===x&&"border-primary"),onClick:()=>{h(c,u,{shouldDirty:!0}),m.setThemeValue(`--be-${r}`,u)},children:e.jsx(l,{...g})},t))})]})}export{ps as Component,De as ThemeEditor};
