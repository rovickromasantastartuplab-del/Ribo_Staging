var U=s=>{throw TypeError(s)};var B=(s,e,t)=>e.has(s)||U("Cannot "+t);var o=(s,e,t)=>(B(s,e,"read from private field"),t?t.call(s):e.get(s)),f=(s,e,t)=>e.has(s)?U("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,t),c=(s,e,t,r)=>(B(s,e,"write to private field"),r?r.call(s,t):e.set(s,t),t),b=(s,e,t)=>(B(s,e,"access private method"),t);import{c1 as X,M as F,c2 as Y,K as Z,S as G,J as ee,c3 as te,c4 as se,r as E,c5 as re,c6 as ie,c7 as oe,c8 as ne,c9 as N,ca as V,cb as ae,cc as ue,ag as pe,i as ce,q as me,l as I,t as he,m as le,k as de,j as g,T as W,h as fe,d as be}from"./client-DtfdVV77.js";import{p as ye,C as ge}from"./use-create-canned-reply-wkbM3An4.js";import{o as ve}from"./custom-menu-Dvq-fOnC.js";import{C as Oe}from"./crupdate-resource-layout-BeHzVG7e.js";import{h as Re}from"./main-BGmGAxtx.js";import{u as Ce}from"./use-required-params-BhaT_-q3.js";import{B as Ee,a as _}from"./breadcrumb-CaNBY_Ut.js";import"./variable-extension-BUEoymSX.js";import"./get-default-values-for-form-with-attributes-htMbgWW2.js";import"./campaign-conditions-config-DZmli5NZ.js";import"./select-D9niWe2H.js";import"./combobox-end-adornment-CWQ4Xgal.js";import"./Event-DDJ424UR.js";import"./ToggleOn-DbVFGpQu.js";import"./TextFields-CM1xUWDR.js";import"./Add-B1HfWgJf.js";import"./index-uUjpwT6n.js";import"./with-selector-DPNnjGhI.js";import"./DataObject-3cjjRxnv.js";import"./action-menu-dialog-CHnxQQPs.js";import"./combobox-CFh39yI7.js";import"./article-link-kVBPNf7I.js";import"./slugify-string-CGmMIJK7.js";import"./article-path-CQn_uF_m.js";import"./category-link-DefoIvjU.js";import"./list-buttons-CxLBLRRO.js";import"./FormatListNumbered-BcAdH5KM.js";import"./tiptap-editor-context-CeN7pXcf.js";import"./Link-WHWZ7SV6.js";import"./library-icon-h4d3s9Ef.js";import"./use-keybind-DRgaCeX0.js";import"./useGlobalListeners-BGMP113F.js";import"./is-ctrl-key-pressed-CaS-AM38.js";import"./emoji-picker-button-Cm_kBrZ5.js";import"./enhance-text-with-ai-button-D92qi4Qc.js";import"./use-is-module-installed-CDjratdW.js";import"./OpenInFull-mOMLBQ1Z.js";import"./Spellcheck-Bj2fiFlW.js";import"./progress-bar-BMzArYUQ.js";import"./upload-attachments-button-y2TJXF13.js";import"./image-button-DUyjpM_5.js";import"./image-up-hBoBC5iJ.js";import"./use-active-upload-CGOT7g6R.js";import"./file-upload-provider-B4w-VsYu.js";import"./uploaded-file-DOXWsty7.js";import"./pretty-bytes-bO14ePu9.js";import"./open-upload-window-DE9Q8gNs.js";import"./shallow-BH2jDtXM.js";import"./file-preview-dialog-BrkfZ0k6.js";import"./file-thumbnail-DlIWt16b.js";import"./file-type-icon-CNIGAaMG.js";import"./ChevronLeft-IHWIEiah.js";import"./ChevronRight-C5OrfRtB.js";import"./FileDownload-DjsfzW8M.js";import"./download-file-from-url-hJ3EUwXO.js";import"./formatted-bytes-CFeeP1Iy.js";import"./use-upload-attachments-CRLnN22_.js";import"./use-droppable-CpvjuNXE.js";import"./paperclip-1tb_aUIl.js";import"./reply-composer-container-Bpt_j9aL.js";import"./formatted-message-body-N3ejX0-V.js";import"./index-BCY5Ekxi.js";import"./core-l5OAWFa0.js";import"./index-Y7xUBCAo.js";import"./floating-toolbar-CKeOgwrE.js";import"./button-group-DAgYjIi8.js";import"./form-chip-field-C7l8nGPv.js";import"./chip-list-DHXDGW6X.js";import"./PushPin-DEBAXBqb.js";import"./datatable-page-with-header-layout-xcCtlWaX.js";import"./use-toggle-dashboard-left-sidebar-DxaOS7gK.js";import"./toggle-left-sidebar-icon-j-5uTef5.js";import"./useEffectEvent-Offmqu_S.js";import"./MoreHoriz-Df3_bV9s.js";function J(s,e){const t=new Set(e);return s.filter(r=>!t.has(r))}function Qe(s,e,t){const r=s.slice(0);return r[e]=t,r}var Q,h,x,S,l,O,j,M,P,u,T,z,H,A,D,$,xe=($=class extends X{constructor(e,t,r){super();f(this,u);f(this,Q);f(this,h);f(this,x);f(this,S);f(this,l);f(this,O);f(this,j);f(this,M);f(this,P,[]);c(this,Q,e),c(this,S,r),c(this,x,[]),c(this,l,[]),c(this,h,[]),this.setQueries(t)}onSubscribe(){this.listeners.size===1&&o(this,l).forEach(e=>{e.subscribe(t=>{b(this,u,A).call(this,e,t)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,o(this,l).forEach(e=>{e.destroy()})}setQueries(e,t){c(this,x,e),c(this,S,t),F.batch(()=>{const r=o(this,l),n=b(this,u,H).call(this,o(this,x));c(this,P,n),n.forEach(a=>a.observer.setOptions(a.defaultedQueryOptions));const i=n.map(a=>a.observer),p=i.map(a=>a.getCurrentResult()),d=r.length!==i.length,w=i.some((a,C)=>a!==r[C]),R=d||w,L=R?!0:p.some((a,C)=>{const q=o(this,h)[C];return!q||!Y(a,q)});!R&&!L||(R&&c(this,l,i),c(this,h,p),this.hasListeners()&&(R&&(J(r,i).forEach(a=>{a.destroy()}),J(i,r).forEach(a=>{a.subscribe(C=>{b(this,u,A).call(this,a,C)})})),b(this,u,D).call(this)))})}getCurrentResult(){return o(this,h)}getQueries(){return o(this,l).map(e=>e.getCurrentQuery())}getObservers(){return o(this,l)}getOptimisticResult(e,t){const r=b(this,u,H).call(this,e),n=r.map(i=>i.observer.getOptimisticResult(i.defaultedQueryOptions));return[n,i=>b(this,u,z).call(this,i??n,t),()=>b(this,u,T).call(this,n,r)]}},Q=new WeakMap,h=new WeakMap,x=new WeakMap,S=new WeakMap,l=new WeakMap,O=new WeakMap,j=new WeakMap,M=new WeakMap,P=new WeakMap,u=new WeakSet,T=function(e,t){return t.map((r,n)=>{const i=e[n];return r.defaultedQueryOptions.notifyOnChangeProps?i:r.observer.trackResult(i,p=>{t.forEach(d=>{d.observer.trackProp(p)})})})},z=function(e,t){return t?((!o(this,O)||o(this,h)!==o(this,M)||t!==o(this,j))&&(c(this,j,t),c(this,M,o(this,h)),c(this,O,Z(o(this,O),t(e)))),o(this,O)):e},H=function(e){const t=new Map(o(this,l).map(n=>[n.options.queryHash,n])),r=[];return e.forEach(n=>{const i=o(this,Q).defaultQueryOptions(n),p=t.get(i.queryHash);p?r.push({defaultedQueryOptions:i,observer:p}):r.push({defaultedQueryOptions:i,observer:new G(o(this,Q),i)})}),r},A=function(e,t){const r=o(this,l).indexOf(e);r!==-1&&(c(this,h,Qe(o(this,h),r,t)),b(this,u,D).call(this))},D=function(){var e;if(this.hasListeners()){const t=o(this,O),r=b(this,u,T).call(this,o(this,h),o(this,P)),n=b(this,u,z).call(this,r,(e=o(this,S))==null?void 0:e.combine);t!==n&&F.batch(()=>{this.listeners.forEach(i=>{i(o(this,h))})})}},$);function Se({queries:s,...e},t){const r=ee(t),n=te(),i=se(),p=E.useMemo(()=>s.map(m=>{const v=r.defaultQueryOptions(m);return v._optimisticResults=n?"isRestoring":"optimistic",v}),[s,r,n]);p.forEach(m=>{re(m),ie(m,i)}),oe(i);const[d]=E.useState(()=>new xe(r,p,e)),[w,R,L]=d.getOptimisticResult(p,e.combine),a=!n&&e.subscribed!==!1;E.useSyncExternalStore(E.useCallback(m=>a?d.subscribe(F.batchCalls(m)):ne,[d,a]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),E.useEffect(()=>{d.setQueries(p,e)},[p,e,d]);const q=w.some((m,v)=>N(p[v],m))?w.flatMap((m,v)=>{const y=p[v];if(y){const K=new G(r,y);if(N(y,m))return V(y,K,i);ae(m,n)&&V(y,K,i)}return[]}):[];if(q.length>0)throw Promise.all(q);const k=w.find((m,v)=>{const y=p[v];return y&&ue({result:m,errorResetBoundary:i,throwOnError:y.throwOnError,query:r.getQueryCache().get(y.queryHash),suspense:y.suspense})});if(k!=null&&k.error)throw k.error;return R(L())}function we(s,e){return Se({...s,queries:s.queries.map(t=>({...t,suspense:!0,throwOnError:pe,enabled:!0,placeholderData:void 0}))},e)}function qe(s,e){return ce({mutationFn:t=>je(e,t),onSuccess:async()=>{await me.invalidateQueries({queryKey:I.cannedReplies.invalidateKey}),he(le("Reply updated"))},onError:t=>ve(t,s)})}function je(s,e){return de.put(`helpdesk/canned-replies/${s}`,ye(e)).then(t=>t.data)}function Yt(){const{replyId:s}=Ce(["replyId"]),[,e]=we({queries:[I.groups.normalizedList,I.cannedReplies.get(s)]});return g.jsxs(E.Fragment,{children:[g.jsx(Re,{children:g.jsx(W,{message:"Edit saved reply"})}),g.jsx(Me,{cannedReply:e.data.reply})]})}function Me({cannedReply:s}){const e=fe(),t=be({defaultValues:{name:s.name,body:s.body,attachments:s.attachments,shared:s.shared,groupId:s.group_id,tags:s.tags}}),r=qe(t,s.id),n=i=>{i=i||t.getValues(),r.mutate(i,{onSuccess:()=>{e("../..",{relative:"path"})}})};return g.jsx(Oe,{form:t,onSubmit:n,title:g.jsxs(Ee,{size:"xl",children:[g.jsx(_,{to:"../saved-replies",children:g.jsx(W,{message:"Saved replies"})}),g.jsx(_,{children:s.name})]}),isLoading:r.isPending,disableSaveWhenNotDirty:!0,children:g.jsx(ge,{})})}export{Yt as Component};
