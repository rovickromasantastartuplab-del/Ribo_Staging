import{j as e,p as i,as as p,r as u,T as c,L as h,l as v}from"./client-DtfdVV77.js";import{A as b}from"./AlternateEmail-JgjChVK8.js";import{f as N}from"./main-BGmGAxtx.js";import{V as y,S as g,L as I,P as w}from"./ViewDay-0YjWc40J.js";import{u as A,a as x,b as L,r as M}from"./reverse-conversation-messages-D589XwPM.js";import{M as E}from"./message-author-name-Bk8LQSvQ.js";import{A as C}from"./attribute-renderer-C6KvryoI.js";import{u as k}from"./useInfiniteQuery-CRfa2XSO.js";function f({messages:s,index:t}){return s.length===t+1?null:e.jsx("div",{className:"mx-auto h-1 w-[calc(100%-34px)] w-full bg-divider"})}function D({message:s,size:t,className:a}){const r=i("text-muted",a);if(s.type==="cards")return e.jsx(y,{className:r,size:t});if(s.type==="collectDetailsForm")return e.jsx(N,{className:r,size:t});if(s.type!=="event")return null;switch(s.body.name){case"closed.inactivity":case"closed.byTrigger":case"closed.byAgent":case"closed.byCustomer":case"closed.byAiAgent":return e.jsx(p,{size:t,className:r});case"customer.enteredEmail":return e.jsx(b,{size:t,className:r});case"customer.idle":return e.jsx(w,{size:t,className:r});case"customer.leftChat":case"agent.leftChat":return e.jsx(I,{size:t,className:r});case"agent.changed":case"group.changed":return e.jsx(g,{size:t,className:r});default:return null}}function B({message:s,messages:t,index:a,variant:r,className:n}){var m,d;const l=A({message:s,variant:r});if(l===null)return null;const j=((m=t[a-1])==null?void 0:m.type)==="event",o=((d=t[a+1])==null?void 0:d.type)==="event";return e.jsxs(u.Fragment,{children:[e.jsxs("div",{className:i("flex items-center gap-12 text-sm",n,o?"pb-4":"pb-24",j?"pt-4":"pt-24"),children:[e.jsx(D,{message:s,size:"sm",className:"ml-4 mr-8"}),e.jsx(c,{...l}),e.jsx("time",{className:"ml-auto text-xs text-muted",children:e.jsx(x,{date:s.created_at})})]}),!o&&e.jsx(f,{messages:t,index:a})]})}function T({message:s,children:t,actions:a,className:r}){let n=e.jsx(L,{message:s,size:"sm"});return s.user&&(n=e.jsx(h,{to:`/dashboard/customers/${s.user.id}`,className:"flex-shrink-0",target:"_blank",children:n})),e.jsxs("div",{className:i("flex items-start gap-12 py-36",r,s.type==="note"&&"bg-note dark:bg-[#45380c]"),children:[n,e.jsxs("div",{className:"min-w-0 flex-auto",children:[e.jsxs("div",{className:"mb-4 flex min-h-30 items-center gap-8",children:[e.jsx("div",{className:"-mt-6 mr-auto text-sm font-semibold",children:e.jsx(E,{message:s})}),a,e.jsx("div",{className:"flex-shrink-0 text-xs text-muted",children:e.jsx(x,{date:s.created_at})})]}),t]})]})}function S({message:s,className:t}){return e.jsxs("div",{className:t,children:[e.jsx("div",{className:"mb-14 text-left font-semibold",children:e.jsx(F,{message:s})}),e.jsx("div",{className:"space-y-14 text-left",children:s.body.attributes.map(a=>e.jsxs("div",{children:[e.jsx("div",{className:"mb-2 text-muted",children:a.name}),e.jsx("div",{children:e.jsx(C,{attribute:a})})]},a.key))})]})}function F({message:s}){switch(s.body.formType){case"preChat":return e.jsx(c,{message:"Pre-chat form"});case"postChat":return e.jsx(c,{message:"Post-chat form"});default:return e.jsx(c,{message:"Submitted details"})}}function G({message:s,messages:t,index:a,className:r}){return e.jsxs(u.Fragment,{children:[e.jsx(T,{message:s,className:r,children:e.jsx(S,{message:s,className:"w-max rounded-panel border p-12 text-sm"})}),e.jsx(f,{messages:t,index:a})]})}function J(s){return k({...v.conversations.messages(s),select:M})}export{G as L,T as M,S,B as a,f as b,J as u};
