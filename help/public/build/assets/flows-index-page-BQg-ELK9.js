import{h as S,r as d,j as e,T as a,al as h,d as P,i as f,am as C,an as T,ap as A,aP as I,F as x,aq as E,B as c,aZ as N,av as j,D as O,s as y,k as w,q as b,t as D,m as F,aw as q,aj as k,ax as H,az as g,L}from"./client-DtfdVV77.js";import{A as M}from"./ai-agent-page-header-B8HWeYwY.js";import{g as u,h as B}from"./main-BGmGAxtx.js";import{P as K}from"./toggle-preview-button-BfqVe6Bw.js";import{G as Q}from"./global-loading-progress-DVC8NxPo.js";import{D as _}from"./data-table-add-item-button-B_2m2pad.js";import{D as V}from"./data-table-header-CdCZHch7.js";import{D as $}from"./data-table-pagination-footer-B4yyc06A.js";import{u as R}from"./use-datatable-search-params-dzq5X78n.js";import{D as W}from"./data-table-emty-state-message-DsPxSC6g.js";import{a as G,b as U,c as z}from"./datatable-page-with-header-layout-xcCtlWaX.js";import{u as Z}from"./use-datatable-query-v3pOHYke.js";import{T as J}from"./table-CynOKbaN.js";import{F as X}from"./formatted-number-CIAFur2S.js";import{A as Y}from"./AccountTree-BVzukxeW.js";import{M as ee}from"./MoreVert-BVDYtk4z.js";import{C as ae}from"./confirmation-dialog-BzXs9ksK.js";import"./custom-menu-Dvq-fOnC.js";import"./admin-config-DXsixO44.js";import"./dashboard-icons-BJ4c3Z5i.js";import"./library-icon-h4d3s9Ef.js";import"./messages-square-icon-D_3IR-rK.js";import"./Delete-DWP7kvj0.js";import"./Home-iO0iebLw.js";import"./SupervisorAccount-Bkn2ibMi.js";import"./Translate-DPB2wdvD.js";import"./TextFields-CM1xUWDR.js";import"./use-url-backed-tabs-BirCk8wN.js";import"./tabs-spjnXvK6.js";import"./useSuspenseQuery-Bmt2-NKx.js";import"./book-open-D91H26Dq.js";import"./preview-messages-B_u8VttT.js";import"./RestartAlt-DTi82oFC.js";import"./use-is-module-installed-CDjratdW.js";import"./Add-B1HfWgJf.js";import"./FilterAlt-CRhKT7zD.js";import"./select-filter-panel-hjhYEdoY.js";import"./form-chip-field-C7l8nGPv.js";import"./chip-list-DHXDGW6X.js";import"./filter-operator-names-BbrFb9i0.js";import"./select-D9niWe2H.js";import"./combobox-end-adornment-CWQ4Xgal.js";import"./normalized-model-field-D3Ui05eZ.js";import"./Edit-BaEHOLuK.js";import"./skeleton-D178v0-U.js";import"./accordion-Dmxnze9z.js";import"./accordtion-animation-BGCK95Hj.js";import"./checkbox-CS7ILu6P.js";import"./CheckBoxOutlineBlank-DU0ZdwTb.js";import"./use-toggle-dashboard-left-sidebar-DxaOS7gK.js";import"./toggle-left-sidebar-icon-j-5uTef5.js";import"./ArrowDownward-DHtsWMyK.js";import"./useEffectEvent-Offmqu_S.js";import"./is-ctrl-key-pressed-CaS-AM38.js";import"./useGlobalListeners-BGMP113F.js";function ma(){const t=S(),{searchParams:i,sortDescriptor:o,mergeIntoSearchParams:r,setSearchQuery:n,isFiltering:s}=R(N),l=Z(u.flows.index(i)),[p,v]=d.useState(!1);return e.jsxs(d.Fragment,{children:[e.jsxs(G,{className:"dashboard-grid-content dashboard-rounded-panel",children:[e.jsx(Q,{query:l}),e.jsx(B,{children:e.jsx(a,{message:"Flows"})}),e.jsx(M,{previewVisible:p,onTogglePreview:()=>v(!p)}),e.jsxs(U,{children:[e.jsx(V,{searchValue:i.query,onSearchChange:n,actions:e.jsx(oe,{})}),e.jsxs(z,{children:[!l.isEmpty||s?e.jsx(J,{columns:te,data:l.items,sortDescriptor:o,onSortChange:r,cellHeight:"h-64",enableSelection:!1,onAction:m=>t(`../flows/${m.id}/edit`)}):null,l.isEmpty?e.jsx(W,{isFiltering:s,icon:e.jsx(Y,{}),title:e.jsx(a,{message:"No flows yet"}),filteringTitle:e.jsx(a,{message:"No matching flows"}),description:e.jsx(a,{message:"Get started by adding a new flow."})}):null,e.jsx($,{query:l,onPageChange:m=>r({page:m}),onPerPageChange:m=>r({perPage:m}),hideIfOnlyOnePage:!0})]})]})]}),p&&e.jsx(K,{onClose:()=>v(!1)})]})}const te=[{key:"name",width:"flex-3",visibleInMode:"all",header:()=>e.jsx(a,{message:"Name"}),body:t=>t.name},{key:"activation_count",allowsSorting:!0,maxWidth:"max-w-100",header:()=>e.jsx(a,{message:"Activations"}),body:t=>t.activation_count?e.jsx(X,{value:t.activation_count}):""},{key:"updated_at",allowsSorting:!0,maxWidth:"max-w-124",header:()=>e.jsx(a,{message:"Last updated"}),body:t=>t.updated_at?e.jsx(O,{date:t.updated_at}):""},{key:"actions",header:()=>e.jsx(a,{message:"Actions"}),hideHeader:!0,visibleInMode:"all",align:"end",width:"w-84 flex-shrink-0",body:t=>e.jsx(se,{flow:t})}];function se({flow:t}){const[i,o]=d.useState(!1),[r,n]=d.useState(!1);return e.jsxs(d.Fragment,{children:[e.jsxs(q,{children:[e.jsx(k,{className:"text-muted",children:e.jsx(ee,{})}),e.jsxs(H,{children:[e.jsx(g,{value:"edit",elementType:L,to:`../flows/${t.id}/edit`,children:e.jsx(a,{message:"Edit"})}),e.jsx(g,{value:"rename",onSelected:()=>o(!0),children:e.jsx(a,{message:"Rename"})}),e.jsx(g,{value:"delete",onSelected:()=>n(!0),children:e.jsx(a,{message:"Delete"})})]})]}),e.jsx(j,{type:"modal",isOpen:i,onOpenChange:o,children:e.jsx(re,{flow:t})}),e.jsx(j,{type:"modal",isOpen:r,onOpenChange:n,children:e.jsx(ne,{flow:t})})]})}function oe(){return e.jsxs(j,{type:"modal",children:[e.jsx(_,{children:e.jsx(a,{message:"Add new flow"})}),e.jsx(ie,{})]})}function ie(){const t=S(),{formId:i,close:o}=h(),r=P(),n=f({mutationFn:s=>w.post("lc/ai-agent/flows",s),onSuccess:async s=>{await b.invalidateQueries({queryKey:u.flows.invalidateKey}),D(F("Flow created")),o(),t(`../flows/${s.data.flow.id}/edit`,{relative:"path"})},onError:s=>y(s)});return e.jsxs(C,{children:[e.jsx(T,{children:e.jsx(a,{message:"New flow"})}),e.jsx(A,{children:e.jsx(I,{id:i,form:r,onSubmit:s=>{n.mutate(s)},children:e.jsx(x,{required:!0,name:"name",autoFocus:!0,label:e.jsx(a,{message:"Name"})})})}),e.jsxs(E,{children:[e.jsx(c,{type:"button",onClick:()=>o(),children:e.jsx(a,{message:"Cancel"})}),e.jsx(c,{type:"submit",disabled:n.isPending,variant:"flat",color:"primary",form:i,children:e.jsx(a,{message:"Create"})})]})]})}function re({flow:t}){const{formId:i,close:o}=h(),r=P({defaultValues:{name:t.name,intent:t.intent}}),n=f({mutationFn:s=>w.put(`lc/ai-agent/flows/${t.id}`,s),onSuccess:async()=>{await b.invalidateQueries({queryKey:u.flows.invalidateKey}),D(F("Flow updated")),o()},onError:s=>y(s)});return e.jsxs(C,{children:[e.jsx(T,{children:e.jsx(a,{message:"Update flow"})}),e.jsx(A,{children:e.jsxs(I,{id:i,form:r,onSubmit:s=>n.mutate(s),children:[e.jsx(x,{required:!0,name:"name",autoFocus:!0,label:e.jsx(a,{message:"Name"}),className:"mb-24"}),e.jsx(x,{name:"intent",autoFocus:!0,label:e.jsx(a,{message:"Intent"}),inputElementType:"textarea",rows:2,minLength:10,maxLength:200})]})}),e.jsxs(E,{children:[e.jsx(c,{type:"button",onClick:()=>o(),children:e.jsx(a,{message:"Cancel"})}),e.jsx(c,{type:"submit",disabled:n.isPending,variant:"flat",color:"primary",form:i,children:e.jsx(a,{message:"Update"})})]})]})}function ne({flow:t}){const{close:i}=h(),o=f({mutationFn:()=>w.delete(`lc/ai-agent/flows/${t.id}`),onSuccess:async()=>{await b.invalidateQueries({queryKey:u.flows.invalidateKey}),D(F("Flow deleted")),i()},onError:r=>y(r)});return e.jsx(ae,{isDanger:!0,isLoading:o.isPending,title:e.jsx(a,{message:"Delete flow"}),body:e.jsx(a,{message:"Are you sure you want to delete this flow?"}),confirm:e.jsx(a,{message:"Delete"}),onConfirm:()=>o.mutate()})}export{ma as Component,ne as DeleteFlowDialog,re as RenameFlowDialog};
