import{r as d,j as e,aP as H,F as T,T as t,az as U,ac as S,i as x,t as w,m as l,q as j,k as y,al as h,d as C,am as F,an as v,ap as P,aq as E,B as c,b1 as _,b2 as K,aZ as M,av as p,D as L,aj as R,s as V}from"./client-DtfdVV77.js";import{l as f,i as z,j as G,o as I}from"./main-BGmGAxtx.js";import{G as O}from"./global-loading-progress-DVC8NxPo.js";import{D as W}from"./data-table-header-CdCZHch7.js";import{D as $}from"./data-table-pagination-footer-B4yyc06A.js";import{u as Z}from"./use-datatable-search-params-dzq5X78n.js";import{D as J}from"./datatable-filters-KJfH8nG0.js";import{a as X,D as Y,b as ee,c as ae}from"./datatable-page-with-header-layout-xcCtlWaX.js";import{u as se}from"./use-datatable-query-v3pOHYke.js";import{T as te}from"./table-CynOKbaN.js";import{E as re}from"./Edit-BaEHOLuK.js";import{C as ne}from"./confirmation-dialog-BzXs9ksK.js";import{D as oe}from"./data-table-add-item-button-B_2m2pad.js";import{D as ie}from"./data-table-emty-state-message-DsPxSC6g.js";import{F as me}from"./select-D9niWe2H.js";import{D as k}from"./paginated-resources-DUi9UwyN.js";import{o as q}from"./custom-menu-Dvq-fOnC.js";import{s as N}from"./slugify-string-CGmMIJK7.js";import"./FilterAlt-CRhKT7zD.js";import"./select-filter-panel-hjhYEdoY.js";import"./form-chip-field-C7l8nGPv.js";import"./chip-list-DHXDGW6X.js";import"./filter-operator-names-BbrFb9i0.js";import"./normalized-model-field-D3Ui05eZ.js";import"./skeleton-D178v0-U.js";import"./accordion-Dmxnze9z.js";import"./accordtion-animation-BGCK95Hj.js";import"./checkbox-CS7ILu6P.js";import"./CheckBoxOutlineBlank-DU0ZdwTb.js";import"./formatted-number-CIAFur2S.js";import"./use-toggle-dashboard-left-sidebar-DxaOS7gK.js";import"./toggle-left-sidebar-icon-j-5uTef5.js";import"./ArrowDownward-DHtsWMyK.js";import"./useEffectEvent-Offmqu_S.js";import"./is-ctrl-key-pressed-CaS-AM38.js";import"./useGlobalListeners-BGMP113F.js";import"./Add-B1HfWgJf.js";import"./combobox-end-adornment-CWQ4Xgal.js";function B({form:a,onSubmit:s,formId:r}){const{tags:{types:n}}=d.useContext(f),o=a.watch("type"),m=!!n.find(i=>i.name===o&&i.system),u=n.filter(i=>!i.system);return e.jsxs(H,{id:r,form:a,onSubmit:s,children:[e.jsx(T,{name:"name",label:e.jsx(t,{message:"Name"}),description:e.jsx(t,{message:"Unique tag identifier."}),className:"mb-20",required:!0,autoFocus:!0}),e.jsx(T,{name:"display_name",label:e.jsx(t,{message:"Display name"}),description:e.jsx(t,{message:"User friendly tag name."}),className:"mb-20"}),u.length>1&&e.jsx(me,{label:e.jsx(t,{message:"Type"}),name:"type",selectionMode:"single",disabled:m,children:u.map(i=>e.jsx(U,{value:i.name,children:e.jsx(t,{message:i.name})},i.name))})]})}function le(a){const{trans:s}=S();return x({mutationFn:r=>de(r),onSuccess:()=>{w(s(l("Tag created"))),j.invalidateQueries({queryKey:k("tags")})},onError:r=>q(r,a)})}function de(a){return a.name=N(a.name),y.post("tags",a).then(s=>s.data)}function ce(){const{close:a,formId:s}=h(),{tags:{types:r}}=d.useContext(f),n=C({defaultValues:{type:r[0].name}}),o=le(n);return e.jsxs(F,{children:[e.jsx(v,{children:e.jsx(t,{message:"Add new tag"})}),e.jsx(P,{children:e.jsx(B,{formId:s,form:n,onSubmit:m=>{o.mutate(m,{onSuccess:()=>{a()}})}})}),e.jsxs(E,{children:[e.jsx(c,{onClick:()=>{a()},children:e.jsx(t,{message:"Cancel"})}),e.jsx(c,{form:s,disabled:o.isPending,variant:"flat",color:"primary",type:"submit",children:e.jsx(t,{message:"Save"})})]})]})}const ue=""+new URL("software-engineer-BUg928cK.svg",import.meta.url).href,ge=a=>[{key:"type",label:l("Type"),description:l("Type of the tag"),defaultOperator:K.ne,control:{type:_.Select,defaultValue:a[0].name,options:a.map(s=>({key:s.name,label:l(s.name),value:s.name}))}},z({description:l("Date tag was created")}),G({description:l("Date tag was last updated")})];function pe(a){const{trans:s}=S();return x({mutationFn:r=>xe(r),onSuccess:()=>{w(s(l("Tag updated"))),j.invalidateQueries({queryKey:k("tags")})},onError:r=>q(r,a)})}function xe({id:a,...s}){return s.name&&(s.name=N(s.name)),y.put(`tags/${a}`,s).then(r=>r.data)}function je({tag:a}){const{close:s,formId:r}=h(),n=C({defaultValues:{id:a.id,name:a.name,display_name:a.display_name,type:a.type}}),o=pe(n);return e.jsxs(F,{children:[e.jsx(v,{children:e.jsx(t,{message:"Update “:name“ tag",values:{name:a.name}})}),e.jsx(P,{children:e.jsx(B,{formId:r,form:n,onSubmit:m=>{o.mutate(m,{onSuccess:()=>{s()}})}})}),e.jsxs(E,{children:[e.jsx(c,{onClick:()=>{s()},children:e.jsx(t,{message:"Cancel"})}),e.jsx(c,{form:r,disabled:o.isPending,variant:"flat",color:"primary",type:"submit",children:e.jsx(t,{message:"Save"})})]})]})}const ye=[{key:"name",allowsSorting:!0,visibleInMode:"all",width:"flex-3 min-w-200",header:()=>e.jsx(t,{message:"Name"}),body:a=>a.name},{key:"type",allowsSorting:!0,header:()=>e.jsx(t,{message:"Type"}),body:a=>a.type},{key:"display_name",allowsSorting:!0,header:()=>e.jsx(t,{message:"Display name"}),body:a=>a.display_name},{key:"updated_at",allowsSorting:!0,width:"w-100",header:()=>e.jsx(t,{message:"Last updated"}),body:a=>e.jsx(L,{date:a.updated_at})},{key:"actions",header:()=>e.jsx(t,{message:"Actions"}),hideHeader:!0,align:"end",width:"w-42 flex-shrink-0",visibleInMode:"all",body:a=>e.jsxs(p,{type:"modal",children:[e.jsx(R,{size:"md",className:"text-muted",children:e.jsx(re,{})}),e.jsx(je,{tag:a})]})}];function ta(){const[a,s]=d.useState([]),{searchParams:r,sortDescriptor:n,mergeIntoSearchParams:o,setSearchQuery:m,isFiltering:u}=Z(M),i=se({...I.tags.index({...r})}),{tags:D}=d.useContext(f),b=d.useMemo(()=>ge(D.types),[D.types]),A=e.jsxs(p,{type:"modal",children:[e.jsx(c,{variant:"flat",color:"danger",children:e.jsx(t,{message:"Delete"})}),e.jsx(he,{selectedIds:a,onDelete:()=>s([])})]}),Q=e.jsxs(p,{type:"modal",children:[e.jsx(oe,{children:e.jsx(t,{message:"Add new tag"})}),e.jsx(ce,{})]});return e.jsxs(X,{children:[e.jsx(O,{query:i}),e.jsx(Y,{title:e.jsx(t,{message:"Tags"}),showSidebarToggleButton:!0}),e.jsxs(ee,{children:[e.jsx(W,{searchValue:r.query,onSearchChange:m,actions:Q,selectedItems:a,selectedActions:A,filters:b}),e.jsx(J,{filters:b}),e.jsxs(ae,{children:[e.jsx(te,{columns:ye,data:i.items,sortDescriptor:n,onSortChange:o,enableSelection:!0,selectedRows:a,onSelectionChange:s}),i.isEmpty?e.jsx(ie,{image:ue,isFiltering:u,title:e.jsx(t,{message:"No tags have been created yet"}),filteringTitle:e.jsx(t,{message:"No matching tags"})}):null,e.jsx($,{query:i,onPageChange:g=>o({page:g}),onPerPageChange:g=>o({perPage:g})})]})]})]})}function he({selectedIds:a,onDelete:s}){const{close:r}=h(),n=x({mutationFn:()=>y.delete(`tags/${a.join(",")}`),onSuccess:()=>{j.invalidateQueries({queryKey:I.tags.invalidateKey}),s(),r()},onError:o=>V(o)});return e.jsx(ne,{isDanger:!0,title:e.jsx(t,{message:"Delete tags"}),body:e.jsx(t,{message:"Are you sure you want to delete selected tags?"}),confirm:e.jsx(t,{message:"Delete"}),isLoading:n.isPending,onConfirm:()=>{n.mutate()}})}export{ta as Component};
