import{j as t,r as d,bP as F,bQ as y,bR as R,bH as S,bI as B}from"./client-DtfdVV77.js";import{u as p}from"./tiptap-editor-context-CeN7pXcf.js";import{F as M,L as N,a as k,C as H,b as D}from"./list-buttons-CxLBLRRO.js";import{i as L,p as q,a as O}from"./index-uUjpwT6n.js";function U({children:e,submitButtons:n}){const s=p();return t.jsxs("div",{className:"flex flex-shrink-0 items-end gap-24 p-8",onClick:()=>{s==null||s.commands.focus()},children:[e&&t.jsx("div",{className:"flex items-center gap-6 overflow-x-auto text-muted",children:e}),n&&t.jsx("div",{className:"ml-auto flex items-center gap-4 pb-4",children:n})]})}function V({size:e="sm"}){return p()?t.jsxs("div",{className:"flex items-center gap-4 rounded-panel border bg py-2 shadow",children:[t.jsx(M,{size:e}),t.jsx(m,{}),t.jsx(N,{size:e}),t.jsx(m,{}),t.jsx(k,{size:e}),t.jsx(m,{}),t.jsx(H,{size:e}),t.jsx(D,{size:e})]}):null}function m(){return t.jsx("div",{className:"w-1 flex-shrink-0 self-stretch bg-divider"})}function G(){const e=p(),n=d.useRef(!1),[s,i]=d.useState(null),c=d.useRef(e==null?void 0:e.view.dom),{x,y:u,strategy:C,refs:T}=F({whileElementsMounted:R,middleware:[y({crossAxis:!0,mainAxis:!0})],placement:"top",elements:{reference:s}});return d.useEffect(()=>{const l=c.current;if(!e)return;const g=()=>{const{ranges:o}=e.view.state.selection,a=Math.min(...o.map(r=>r.$from.pos)),E=Math.max(...o.map(r=>r.$to.pos));if(!A({editor:e,from:a,to:E})){i(null);return}i({contextElement:c.current??void 0,getBoundingClientRect:()=>{if(L(e.view.state.selection)){let r=e.view.nodeDOM(a);if(r){const j=r.dataset.nodeViewWrapper?r:r.querySelector("[data-node-view-wrapper]");if(j&&(r=j.firstChild),r)return r.getBoundingClientRect()}}return q(e.view,a,E)}})},w=()=>{i(null)},h=()=>{setTimeout(()=>g())},v=({event:o})=>{var a;if(n.current){n.current=!1;return}o!=null&&o.relatedTarget&&((a=l==null?void 0:l.parentNode)!=null&&a.contains(o.relatedTarget))||(o==null?void 0:o.relatedTarget)!==e.view.dom&&i(null)};let f=e.view.state;const b=()=>{const o=!f.selection.eq(e.view.state.selection),a=!f.doc.eq(e.view.state.doc);(o||a)&&g(),f=e.view.state};if(l)return l.addEventListener("dragstart",w),e.on("focus",h),e.on("blur",v),e.on("transaction",b),()=>{l.removeEventListener("dragstart",w),e.off("focus",h),e.off("blur",v),e.off("transaction",b)}},[c,e]),s?S.createPortal(t.jsx("div",{className:"reply-composer-floating-toolbar z-tooltip",onMouseDownCapture:()=>{n.current=!0},style:{position:C,top:u??"",left:x??""},ref:T.setFloating,children:t.jsx(V,{size:"sm"})}),B):null}function A({from:e,to:n,editor:s}){var u;const i=!s.view.state.doc.textBetween(e,n).length||!O(s.view.state.selection),c=(u=document.activeElement)==null?void 0:u.closest(".reply-composer-floating-toolbar");return!(!(s.view.hasFocus()||c)||s.view.state.selection.empty||i||!s.isEditable)}export{G as F,U as R};
