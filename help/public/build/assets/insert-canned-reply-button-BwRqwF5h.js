import{r as o,al as y,d as f,j as e,am as C,an as R,T as d,ap as D,aP as S,aq as F,B as m,t as b,m as h,X as v,l as g,q as k,ak as w,av as j,a_ as p,aj as x,L as I}from"./client-DtfdVV77.js";import{u as q,C as z}from"./use-create-canned-reply-wkbM3An4.js";import{u as O}from"./use-filter-XfxMyUPQ.js";import{A as B}from"./action-menu-dialog-CHnxQQPs.js";import{A as T}from"./Add-B1HfWgJf.js";import{b as L}from"./main-BGmGAxtx.js";import{u as P}from"./use-keybind-DRgaCeX0.js";function N({getInitialData:a}){const[r]=o.useState(()=>a==null?void 0:a()),{close:n,formId:i}=y(),s=f({defaultValues:{shared:!0,groupId:1,...r}}),t=q(s),l=c=>{c=c||s.getValues(),t.mutate(c,{onSuccess:()=>{b(h("Reply created")),n()}})};return e.jsxs(C,{size:"fullscreen",children:[e.jsx(R,{children:e.jsx(d,{message:"New saved reply"})}),e.jsx(D,{children:e.jsx(S,{id:i,form:s,onSubmit:l,children:e.jsx(z,{})})}),e.jsxs(F,{children:[e.jsx(m,{onClick:()=>n(),children:e.jsx(d,{message:"Cancel"})}),e.jsx(m,{type:"submit",variant:"flat",color:"primary",form:i,disabled:t.isPending,children:e.jsx(d,{message:"Create"})})]})]})}function Q(a=""){var i;const{contains:r}=O({sensitivity:"base"}),n=v({...g.cannedReplies.index({query:a,forCurrentUser:!0}),initialData:()=>{const s=k.getQueryData(g.cannedReplies.index({query:"",forCurrentUser:!0}).queryKey);if(s&&!s.pagination.next_page)return{...s,pagination:{...s.pagination,data:s.pagination.data.filter(t=>r(t.name,a))}}}});return{replies:((i=n.data)==null?void 0:i.pagination.data)??[],isLoading:n.isLoading,isFetching:n.isFetching,isPlaceholderData:n.isPlaceholderData}}const A=o.forwardRef((a,r)=>e.jsxs(w,{...a,ref:r,children:[e.jsx("path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z"}),e.jsx("line",{x1:"12",x2:"12",y1:"7",y2:"13"}),e.jsx("line",{x1:"15",x2:"9",y1:"10",y2:"10"})]}));function X({getInitialData:a,onSelected:r}){const[n,i]=o.useState(!1),[s,t]=o.useState(!1);return P("window","ctrl+k",()=>{i(!0)},{allowedInputSelector:".ProseMirror"}),e.jsxs(o.Fragment,{children:[e.jsxs(j,{type:"modal",isOpen:n,onOpenChange:i,underlayTransparent:!0,underlayBlurred:!1,returnFocusToTrigger:!1,onClose:l=>{l&&r(l)},children:[e.jsx(p,{label:e.jsx(d,{message:"Saved replies (ctrl+k)"}),children:e.jsx(x,{size:"xs",iconSize:"sm",children:e.jsx(A,{})})}),e.jsx(M,{onNewReplyDialogOpen:()=>t(!0)})]}),e.jsx(j,{type:"modal",isOpen:s,onOpenChange:t,children:e.jsx(N,{getInitialData:a})})]})}function M({onNewReplyDialogOpen:a}){const[r,n]=o.useState(""),{replies:i,isLoading:s,isFetching:t}=Q(r),{close:l}=y(),c=e.jsxs(o.Fragment,{children:[e.jsx(p,{label:e.jsx(d,{message:"Create new reply"}),children:e.jsx(x,{onClick:()=>{l(),a()},className:"ml-auto",variant:"outline",size:"xs",iconSize:"sm",children:e.jsx(T,{})})}),e.jsx(p,{label:e.jsx(d,{message:"Manage saved replies"}),children:e.jsx(x,{elementType:I,to:"/dashboard/saved-replies",className:"ml-8",variant:"outline",size:"xs",iconSize:"sm",children:e.jsx(L,{})})})]});return e.jsx(B,{placeholder:h("Search saved replies..."),query:r,onQueryChange:n,isLoading:s,isFetching:t,data:i,actions:c,itemData:u=>(u=u,{title:u.name,description:u.description})})}export{X as I};
