import{j as s,a_ as d,aj as m,p as u,T as h}from"./client-DtfdVV77.js";import{I as g}from"./image-up-hBoBC5iJ.js";import{u as w}from"./use-active-upload-CGOT7g6R.js";import{u as p}from"./tiptap-editor-context-CeN7pXcf.js";async function f(o){if(!o.type.startsWith("image/"))throw new Error("File is not an image");const n=await new Promise((e,r)=>{const t=new FileReader;t.onload=()=>e(t.result),t.onerror=()=>r(new Error("Failed to read file")),t.readAsDataURL(o)}),a=new Image;return await new Promise((e,r)=>{a.onload=()=>e(),a.onerror=()=>r(new Error("Failed to load image")),a.src=n}),{width:a.naturalWidth,height:a.naturalHeight}}function U({size:o,iconSize:n,uploadType:a}){const e=p(),{selectAndUploadFile:r}=w(),t=()=>{r({uploadType:a,showToastOnRestrictionFail:!0,onSuccess:async(l,c)=>{if(!e)return;const i=await f(c.native);e.commands.focus(),e.commands.setImage({src:l.url,width:i.width,height:i.height})}})};return s.jsx(d,{label:s.jsx(h,{message:"Insert image"}),children:s.jsx(m,{size:o,iconSize:n,onClick:t,className:u("flex-shrink-0"),disabled:!e,children:s.jsx(g,{})})})}export{U as I};
