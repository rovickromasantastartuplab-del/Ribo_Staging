import{r as S,j as e,T as s,b1 as u,b2 as x,m as t,al as P,i as T,aZ as k,av as C,B as v,L as h,aX as c,D as I,aj as B,s as F,k as q,q as _,t as A}from"./client-DtfdVV77.js";import{g as j,h as W,i as H,j as E}from"./main-BGmGAxtx.js";import{o as L}from"./online-articles-CqWeBVNj.js";import{G as z}from"./global-loading-progress-DVC8NxPo.js";import{D as N}from"./data-table-header-CdCZHch7.js";import{D as V}from"./data-table-pagination-footer-B4yyc06A.js";import{u as M}from"./use-datatable-search-params-dzq5X78n.js";import{D as Q}from"./data-table-emty-state-message-DsPxSC6g.js";import{D as $}from"./datatable-filters-KJfH8nG0.js";import{a as K,D as O,b as R,c as G}from"./datatable-page-with-header-layout-xcCtlWaX.js";import{u as X}from"./use-datatable-query-v3pOHYke.js";import{u as f}from"./use-required-params-BhaT_-q3.js";import{T as Z}from"./table-CynOKbaN.js";import{B as J,a as g}from"./breadcrumb-CaNBY_Ut.js";import{V as U}from"./Visibility-BlnkCOzB.js";import{C as Y}from"./confirmation-dialog-BzXs9ksK.js";import"./custom-menu-Dvq-fOnC.js";import"./FilterAlt-CRhKT7zD.js";import"./select-filter-panel-hjhYEdoY.js";import"./form-chip-field-C7l8nGPv.js";import"./chip-list-DHXDGW6X.js";import"./filter-operator-names-BbrFb9i0.js";import"./select-D9niWe2H.js";import"./combobox-end-adornment-CWQ4Xgal.js";import"./normalized-model-field-D3Ui05eZ.js";import"./Edit-BaEHOLuK.js";import"./skeleton-D178v0-U.js";import"./accordion-Dmxnze9z.js";import"./accordtion-animation-BGCK95Hj.js";import"./checkbox-CS7ILu6P.js";import"./CheckBoxOutlineBlank-DU0ZdwTb.js";import"./formatted-number-CIAFur2S.js";import"./use-toggle-dashboard-left-sidebar-DxaOS7gK.js";import"./toggle-left-sidebar-icon-j-5uTef5.js";import"./ArrowDownward-DHtsWMyK.js";import"./useEffectEvent-Offmqu_S.js";import"./is-ctrl-key-pressed-CaS-AM38.js";import"./useGlobalListeners-BGMP113F.js";import"./ChevronRight-C5OrfRtB.js";import"./MoreHoriz-Df3_bV9s.js";const ee=[{key:"name",width:"flex-3 min-w-200",visibleInMode:"all",header:()=>e.jsx(s,{message:"Page"}),body:a=>e.jsxs("div",{children:[e.jsx(h,{to:a.fully_scanned?`${a.id}`:"",className:"block hover:underline",children:a.title}),e.jsx("a",{href:a.url,target:"_blank",rel:"noreferrer",className:"text-xs text-muted hover:underline",children:a.url})]})},{key:"fully_scanned",allowsSorting:!0,width:"w-100 flex-shrink-0",header:()=>e.jsx(s,{message:"Status"}),body:a=>a.fully_scanned?a.scan_pending?e.jsx(c,{color:"primary",size:"xs",children:e.jsx(s,{message:"Sync pending"})}):e.jsx(c,{color:"positive",size:"xs",children:e.jsx(s,{message:"Synced"})}):e.jsx(c,{color:"danger",size:"xs",children:e.jsx(s,{message:"Scan pending"})})},{key:"updatedAt",allowsSorting:!0,width:"w-96",header:()=>e.jsx(s,{message:"Last updated"}),body:a=>e.jsx("time",{children:e.jsx(I,{date:a.updated_at})})},{key:"actions",header:()=>e.jsx(s,{message:"Actions"}),width:"w-42 flex-shrink-0",hideHeader:!0,align:"end",visibleInMode:"all",body:a=>e.jsx("div",{className:"text-muted",children:e.jsx(B,{size:"md",elementType:h,to:`${a.id}`,disabled:!a.fully_scanned,children:e.jsx(U,{})})})}],b=[{key:"fully_scanned",label:t("Fully scanned"),description:t("Whether webpage was fully scanned at least once"),defaultOperator:x.eq,control:{type:u.BooleanToggle,defaultValue:!0}},{key:"scan_pending",label:t("Scan pending"),description:t("Whether webpage is queued for scanning"),defaultOperator:x.eq,control:{type:u.BooleanToggle,defaultValue:!0}},H({label:t("First scanned"),description:t("Date webpage was first scanned")}),E({description:t("Date webpage was last updated")})];function Me(){var p;const[a,o]=S.useState([]),{websiteId:d}=f(["websiteId"]),{searchParams:n,sortDescriptor:l,mergeIntoSearchParams:r,setSearchQuery:y,isFiltering:w}=M(k),i=X(j.webpages.index(d,n)),D=e.jsxs(C,{type:"modal",children:[e.jsx(v,{variant:"flat",color:"danger",children:e.jsx(s,{message:"Delete"})}),e.jsx(ae,{selectedIds:a,onDelete:()=>o([])})]});return e.jsxs(K,{children:[e.jsx(z,{query:i}),e.jsx(W,{children:e.jsx(s,{message:"Webpages"})}),e.jsx(O,{showSidebarToggleButton:!0,children:e.jsxs(J,{size:"xl",children:[e.jsx(g,{to:"../knowledge",children:e.jsx(s,{message:"Knowledge"})}),e.jsx(g,{to:"../knowledge/websites",children:e.jsx(s,{message:"Websites"})}),e.jsx(g,{children:(p=i.data)==null?void 0:p.website.title})]})}),e.jsxs(R,{children:[e.jsx(N,{searchValue:n.query,onSearchChange:y,filters:b,selectedItems:a,selectedActions:D}),e.jsx($,{filters:b}),e.jsxs(G,{children:[e.jsx(Z,{columns:ee,data:i.items,sortDescriptor:l,onSortChange:r,cellHeight:"h-64",selectedRows:a,onSelectionChange:o}),i.isEmpty?e.jsx(Q,{image:L,isFiltering:w,title:e.jsx(s,{message:"No webpages have been scanned yet"}),filteringTitle:e.jsx(s,{message:"No matching webpages"})}):null,e.jsx(V,{query:i,onPageChange:m=>r({page:m}),onPerPageChange:m=>r({perPage:m})})]})]})]})}function ae({selectedIds:a,onDelete:o}){const{websiteId:d}=f(["websiteId"]),{close:n}=P(),l=T({mutationFn:()=>q.delete(`lc/ai-agent/websites/${d}/webpages/${a.join(",")}`),onSuccess:async()=>{await _.invalidateQueries({queryKey:j.knowledge.invalidateKey}),A(t("Webpages deleted")),o(),n()},onError:r=>F(r)});return e.jsx(Y,{isDanger:!0,isLoading:l.isPending,title:e.jsx(s,{message:"Delete webpages"}),body:e.jsx(s,{message:"Are you sure you want to delete selected webpages?",values:{count:a.length}}),confirm:e.jsx(s,{message:"Delete"}),onConfirm:()=>l.mutate()})}export{Me as Component,ae as DeleteWebpagesDialog};
