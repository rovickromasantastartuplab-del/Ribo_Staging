import{ac as w,d as S,j as e,B as d,T as a,bg as N,m as C,f as x,aG as f,r as c,av as g,am as F,an as M,ap as k,be as h,b6 as z,F as R,az as E}from"./client-DtfdVV77.js";import{A as P}from"./admin-config-DXsixO44.js";import{c as v}from"./main-BGmGAxtx.js";import{A as V,M as T}from"./add-menu-item-dialog-BbUou4e9.js";import{u as W}from"./settings-layout-FQP6W4_q.js";import{S as p,a as $}from"./settings-section-button-CSsdbx0L.js";import{u as L}from"./use-admin-settings-DArjpbC9.js";import{u as y}from"./useSuspenseQuery-Bmt2-NKx.js";import{A as B,a as O}from"./accordion-Dmxnze9z.js";import{F as G}from"./form-chip-field-C7l8nGPv.js";import{A as b}from"./Add-B1HfWgJf.js";import{A as H}from"./ArrowRight-BrD9zeUx.js";import{D as Q}from"./Delete-DWP7kvj0.js";import{D as U}from"./DragIndicator-CvftiD3i.js";import{I as K,S as X}from"./custom-menu-Dvq-fOnC.js";import{m as _,u as q}from"./use-sortable-CsHM4tcn.js";import{C as D}from"./confirmation-dialog-BzXs9ksK.js";import"./dashboard-icons-BJ4c3Z5i.js";import"./library-icon-h4d3s9Ef.js";import"./messages-square-icon-D_3IR-rK.js";import"./Home-iO0iebLw.js";import"./SupervisorAccount-Bkn2ibMi.js";import"./Translate-DPB2wdvD.js";import"./TextFields-CM1xUWDR.js";import"./permission-selector-CRaW7I2O.js";import"./uc-first-pSl3nM3z.js";import"./select-D9niWe2H.js";import"./combobox-end-adornment-CWQ4Xgal.js";import"./Edit-BaEHOLuK.js";import"./use-previous-BLaxBq_s.js";import"./skeleton-D178v0-U.js";import"./use-filter-XfxMyUPQ.js";import"./settings-links-CRsxvJIZ.js";import"./external-link-Cxcw6nc_.js";import"./book-open-D91H26Dq.js";import"./use-admin-settings-page-nav-config-D58KRD8y.js";import"./datatable-page-with-header-layout-xcCtlWaX.js";import"./use-toggle-dashboard-left-sidebar-DxaOS7gK.js";import"./toggle-left-sidebar-icon-j-5uTef5.js";import"./file-upload-provider-B4w-VsYu.js";import"./uploaded-file-DOXWsty7.js";import"./pretty-bytes-bO14ePu9.js";import"./with-selector-DPNnjGhI.js";import"./useMutationState-Bmyxea6H.js";import"./blocker-dialog-B0Vc-LIE.js";import"./OpenInFull-mOMLBQ1Z.js";import"./accordtion-animation-BGCK95Hj.js";import"./chip-list-DHXDGW6X.js";import"./isScrollable-BSEN4xi5.js";import"./use-droppable-CpvjuNXE.js";import"./useGlobalListeners-BGMP113F.js";const J=""+new URL("dropdown-menu-X8e8OTGW.svg",import.meta.url).href;function ss(){const{trans:t}=w(),{data:n}=L(),r=S({defaultValues:{client:{menus:(n==null?void 0:n.client.menus)??[]}}});return e.jsxs(p,{title:e.jsx(a,{message:"Menus"}),defaultRoute:"/",docsLink:P.settings.menus,children:[e.jsx(p.Content,{children:e.jsxs(p.Form,{form:r,children:[e.jsx("div",{className:"mb-12",children:e.jsx(d,{variant:"outline",color:"primary",startIcon:e.jsx(b,{}),size:"xs",onClick:()=>{const s=N(10);r.setValue("client.menus",[...r.getValues("client.menus"),{name:t(C("New menu :number",{values:{number:r.getValues("client.menus").length+1}})),id:s,positions:[],items:[]}],{shouldDirty:!0})},children:e.jsx(a,{message:"Add new menu"})})}),e.jsx(Y,{})]})}),e.jsx(p.Preview,{})]})}function I(){const t=x(),n=W(s=>s.setPreviewRoute),{data:{config:r}}=y(v.settings.menuEditorConfig());return c.useCallback(s=>{const o=t.getValues("client.menus").find(i=>i.id===s);o?o.positions.forEach(i=>{const m=r.positions.find(l=>l.name===i);m&&n(m.route)}):n("/")},[])}function Y(){const t=I(),n=x(),{fields:r}=h({control:n.control,name:"client.menus",keyName:"key"});return e.jsx(B,{variant:"outline",size:"lg",onExpandedChange:([s])=>{t(s)},children:r.map((s,o)=>e.jsx(O,{label:s.name,value:s.id,children:e.jsx(Z,{id:s.id,index:o})},s.key))})}function Z({id:t,index:n}){const r=I(),{data:s}=y(v.settings.menuEditorConfig()),o=`client.menus.${n}`;return e.jsxs(c.Fragment,{children:[e.jsxs("div",{className:"mb-30 border-b pb-30",children:[e.jsx(R,{name:`${o}.name`,label:e.jsx(a,{message:"Name"}),className:"mb-20",autoFocus:!0}),e.jsx(G,{chipSize:"sm",name:`${o}.positions`,valueKey:"id",label:e.jsx(a,{message:"Where should this menu appear on the site?"}),onChange:()=>{r(t)},children:s.config.positions.map(i=>e.jsx(E,{value:i.name,children:i.label},i.name))})]}),e.jsx(ee,{formPath:`${o}.items`}),e.jsx("div",{className:"mt-24 text-right",children:e.jsx(se,{menuId:t})})]})}function ee({formPath:t}){const n=t,r=x(),s=f({control:r.control,name:t})??[],[o,i]=c.useState(null);return e.jsxs(c.Fragment,{children:[e.jsxs("div",{className:"flex flex-shrink-0 items-center justify-between gap-16",children:[e.jsx(a,{message:"Menu items"}),e.jsxs(g,{type:"drawer",placement:"right",onClose:m=>{m&&r.setValue(n,[...s,m],{shouldDirty:!0})},children:[e.jsx(d,{color:"primary",size:"xs",startIcon:e.jsx(b,{}),children:e.jsx(a,{message:"Add"})}),e.jsx(V,{})]})]}),e.jsxs("div",{className:"mt-12 flex-shrink-0",children:[s.map((m,l)=>e.jsx(te,{item:m,items:s,onClick:()=>i(l),onSortEnd:(u,j)=>{r.setValue(n,_(s,u,j),{shouldDirty:!0})}},m.id)),s.length?null:e.jsx(K,{size:"xs",className:"my-40",image:e.jsx(X,{src:J}),title:e.jsx(a,{message:"No menu items yet"}),description:e.jsx(a,{message:"Click “add“ button to start adding links, pages, routes and other items to this menu. "})})]}),e.jsx(g,{isOpen:o!==null,type:"drawer",onClose:()=>i(null),children:e.jsxs(F,{children:[e.jsx(M,{rightAdornment:e.jsx(d,{variant:"outline",size:"xs",onClick:()=>i(null),children:e.jsx(a,{message:"Save & close"})}),children:e.jsx(a,{message:"Edit menu item"})}),e.jsxs(k,{children:[e.jsx(T,{formPathPrefix:`${t}.${o}`}),e.jsx("div",{className:"mt-24 text-right",children:e.jsx(ne,{itemsPath:t,itemIndex:o,onDelete:()=>i(null)})})]})]})})]})}function se({menuId:t}){const n=x(),r="client.menus",s=f({control:n.control,name:r}),o=s.find(i=>i.id===t);return o?e.jsxs(g,{type:"modal",onClose:i=>{i&&n.setValue(r,s.filter(m=>m.id!==t),{shouldDirty:!0})},children:[e.jsx(d,{color:"danger",size:"xs",children:e.jsx(a,{message:"Delete menu"})}),e.jsx(D,{isDanger:!0,title:e.jsx(a,{message:"Delete menu"}),body:e.jsx(a,{message:"Are you sure you want to delete “:name“?",values:{name:o.name}}),confirm:e.jsx(a,{message:"Delete"})})]}):null}function te({item:t,items:n,onSortEnd:r,onClick:s}){const o=c.useRef(null),{sortableProps:i,dragHandleRef:m}=q({item:t,items:n,type:"menuEditorSortable",ref:o,onSortEnd:r,strategy:"liveSort"}),l=t.icon&&z(t.icon),u=e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted",children:[l&&e.jsx(l,{size:"sm"}),"(",e.jsx(a,{message:"No label..."}),")"]});return e.jsx(c.Fragment,{children:e.jsx($,{ref:o,...i,onClick:s,endIcon:e.jsx(H,{className:"text-muted"}),children:e.jsxs("div",{className:"flex items-center gap-10",children:[e.jsx("div",{className:"flex h-36 w-36 items-center justify-center",ref:m,children:e.jsx(U,{size:"sm",className:"text-muted hover:cursor-move"})}),e.jsx("div",{children:t.label||u})]})})})}function ne({itemsPath:t,itemIndex:n,onDelete:r}){const{fields:s}=h({name:t}),{setValue:o,getValues:i}=x(),m=s[+n];return m?e.jsxs(g,{type:"modal",onClose:l=>{if(l&&n>-1){const u=i(t);o(t,u.filter((j,A)=>A!==+n),{shouldDirty:!0}),r()}},children:[e.jsx(d,{variant:"outline",color:"danger",size:"xs",startIcon:e.jsx(Q,{}),children:e.jsx(a,{message:"Delete this item"})}),e.jsx(D,{isDanger:!0,title:e.jsx(a,{message:"Delete item"}),body:e.jsx(a,{message:"Are you sure you want to delete “:name“?",values:{name:m.label}}),confirm:e.jsx(a,{message:"Delete"})})]}):null}export{ss as Component,ee as MenuItemsManager};
