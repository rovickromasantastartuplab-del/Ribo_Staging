import{X as N,l as u,r as m,j as e,aw as A,T as i,ae as C,ax as M,az as V,t as b,m as y,i as L,s as k,k as q,q as p,av as g,al as E,p as w,B as K,am as z,a_ as F,aj as H}from"./client-DtfdVV77.js";import{u as Q,C as x,T as G,A as R,a as S,b as X,c as _}from"./use-active-view-name-eHdWvZpI.js";import{D as $,h as J,E as U}from"./main-BGmGAxtx.js";import{C as W,u as Y}from"./conversations-list-item-CdxWS0I6.js";import{u as Z,C as ee}from"./column-selector-BkqZD6fQ.js";import{S as se}from"./get-status-color-DZZVbbOS.js";import{F as te,a as oe}from"./dashboard-icons-BJ4c3Z5i.js";import{u as j}from"./use-keybind-DRgaCeX0.js";import{D as ae}from"./Delete-DWP7kvj0.js";import{C as ne}from"./confirmation-dialog-BzXs9ksK.js";import{S as ie}from"./SupervisorAccount-Bkn2ibMi.js";import{G as re}from"./generic-conversations-table-DyafXkg6.js";import{I as me,a as le}from"./inbox-views-sidebar-CzlQ26Xo.js";import{G as I}from"./global-loading-progress-DVC8NxPo.js";import{D as T}from"./data-table-pagination-footer-B4yyc06A.js";import{D}from"./datatable-page-with-header-layout-xcCtlWaX.js";import{M as ce}from"./messages-square-icon-D_3IR-rK.js";import{T as ue}from"./toggle-left-sidebar-icon-j-5uTef5.js";import{I as de}from"./custom-menu-Dvq-fOnC.js";import"./action-menu-dialog-CHnxQQPs.js";import"./combobox-CFh39yI7.js";import"./combobox-end-adornment-CWQ4Xgal.js";import"./PushPin-DEBAXBqb.js";import"./agent-avatar-zWPNofnN.js";import"./use-compact-agents-BbfR0BTv.js";import"./helpdesk-channel-CQKSbeKg.js";import"./online-status-circle-Nb704kAK.js";import"./HourglassEmpty-T3VQEBmq.js";import"./useSuspenseQuery-Bmt2-NKx.js";import"./checkbox-CS7ILu6P.js";import"./CheckBoxOutlineBlank-DU0ZdwTb.js";import"./use-filter-XfxMyUPQ.js";import"./Add-B1HfWgJf.js";import"./use-is-module-installed-CDjratdW.js";import"./use-datatable-search-params-dzq5X78n.js";import"./useInfiniteQuery-CRfa2XSO.js";import"./infiniteQueryObserver-JD1WF4OJ.js";import"./customer-avatar-ul3Z1Bt5.js";import"./ConfirmationNumber-CY9CjtLz.js";import"./use-all-available-columns-CB_-a0g_.js";import"./DragIndicator-CvftiD3i.js";import"./use-sortable-CsHM4tcn.js";import"./isScrollable-BSEN4xi5.js";import"./use-droppable-CpvjuNXE.js";import"./uploaded-file-DOXWsty7.js";import"./useGlobalListeners-BGMP113F.js";import"./library-icon-h4d3s9Ef.js";import"./Home-iO0iebLw.js";import"./is-ctrl-key-pressed-CaS-AM38.js";import"./attribute-renderer-C6KvryoI.js";import"./ThumbDown-BB-li-Gi.js";import"./ThumbUp-CTCneb2T.js";import"./conversation-priority-CeA32zhn.js";import"./unseen-messages-badge-CODRuz4h.js";import"./websocket-updates-notifier-3Xk6dITh.js";import"./chip-list-DHXDGW6X.js";import"./table-CynOKbaN.js";import"./skeleton-D178v0-U.js";import"./ArrowDownward-DHtsWMyK.js";import"./useEffectEvent-Offmqu_S.js";import"./formatted-number-CIAFur2S.js";import"./Tune-B3kaKuXY.js";import"./select-D9niWe2H.js";import"./use-toggle-dashboard-left-sidebar-DxaOS7gK.js";function pe({conversationIds:t,onSuccess:s}){var c;const o=Q(),n=N(u.statuses.dropdownList("agent")),[a,l]=m.useState(!1);return j("window","s",()=>l(!0)),e.jsxs(A,{isOpen:a,onOpenChange:l,onItemSelected:r=>o.mutate({conversationIds:t,statusId:r},{onSuccess:()=>{s==null||s(),b(y("Status changed"))}}),children:[e.jsx(x,{startIcon:e.jsx(te,{}),endIcon:e.jsx(C,{}),disabled:o.isPending,children:e.jsx(i,{message:"Status (s)"})}),e.jsx(M,{children:(c=n.data)==null?void 0:c.statuses.map(r=>e.jsx(V,{value:r.id,startIcon:e.jsx(se,{category:r.category}),children:e.jsx(i,{message:r.label})},r.id))})]})}function ge(){return L({mutationFn:t=>q.delete(`helpdesk/agent/conversations/${t.ids.join(",")}`).then(s=>s.data),onSuccess:async()=>{await p.invalidateQueries({queryKey:u.conversations.invalidateKey}),p.invalidateQueries({queryKey:u.views.invalidateKey}),b(y("Conversations deleted"))},onError:t=>k(t)})}function xe({conversationIds:t,onSuccess:s,isCompact:o}){const[n,a]=m.useState(!1);return j("window","d",()=>a(!0)),e.jsxs(g,{type:"modal",isOpen:n,onOpenChange:a,children:[e.jsx(x,{startIcon:e.jsx(ae,{}),color:"danger",isCompact:o,children:e.jsx(i,{message:"Delete (d)"})}),e.jsx(je,{conversationIds:t,onDeleted:s})]})}function je({conversationIds:t,onDeleted:s}){const o=ge(),{close:n}=E();return e.jsx(ne,{isDanger:!0,isLoading:o.isPending,onConfirm:()=>{o.mutate({ids:t},{onSuccess:()=>{n(),s==null||s()}})},title:e.jsx(i,{message:"Delete conversations"}),body:e.jsx(i,{message:"Are you sure you want to delete selected conversations?"}),confirm:e.jsx(i,{message:"delete"})})}function fe({conversationIds:t,onSuccess:s,isCompact:o}){const[n,a]=m.useState(!1);return j("window","a",()=>a(!0)),e.jsxs(g,{type:"modal",isOpen:n,onOpenChange:a,children:[e.jsx(x,{isCompact:o,startIcon:e.jsx(ie,{}),endIcon:e.jsx(C,{}),children:e.jsx(i,{message:"Assign (a)"})}),e.jsx(G,{conversationIds:t,onTransfer:s})]})}function he({conversationIds:t,onActionCompleted:s,className:o}){return e.jsxs("div",{className:w("flex w-max items-center justify-center gap-12",o),children:[e.jsx(fe,{conversationIds:t,onSuccess:s}),e.jsx(pe,{conversationIds:t,onSuccess:s}),e.jsx(R,{conversationIds:t,onSuccess:s}),e.jsx(xe,{conversationIds:t,onSuccess:s})]})}function Ms(){const{isMobileMode:t}=m.useContext($),s=t?e.jsx(Ce,{}):e.jsx(ve,{});return e.jsxs(m.Fragment,{children:[e.jsx(me,{location:"conversationsTable"}),s]})}function ve(){var v;const t=Y(),[s,o]=m.useState([]),{query:n,items:a,isEmpty:l,mergeIntoSearchParams:c,sortDescriptor:r}=S(),f="conversationsPage",h=(v=n.data)==null?void 0:v.columns,[B]=Z(f,h);return e.jsxs("div",{className:"dashboard-rounded-panel dashboard-grid-content flex flex-col lg:ml-8",children:[e.jsx(I,{query:n}),e.jsx(D,{title:e.jsx(P,{}),toggleButton:e.jsx(ye,{}),padding:"p-12",rightContent:e.jsxs("div",{children:[e.jsx(ee,{tableName:f,defaultColumns:h}),e.jsx(X,{size:"sm"})]}),leftContent:s.length?e.jsx(he,{className:"ml-12",conversationIds:s,onActionCompleted:()=>{o([]),p.invalidateQueries({queryKey:u.conversations.invalidateKey})}}):null}),e.jsx("div",{className:w("flex-auto overflow-y-auto",l&&"flex items-center justify-center"),children:l?e.jsx(O,{}):e.jsx(re,{data:a,activeColumns:B,selectedTickets:s,onSelectionChange:o,sortDescriptor:r,onSortChange:c,onRowAction:d=>{t(d.id)}})}),e.jsx(T,{hideIfOnlyOnePage:!0,className:"flex-shrink-0",onPageChange:d=>c({page:d}),query:n})]})}function Ce(){const{query:t,items:s,isEmpty:o,mergeIntoSearchParams:n}=S();return e.jsxs("div",{className:"dashboard-grid-content flex min-h-0 flex-col",children:[e.jsx(I,{query:t}),e.jsx(D,{title:e.jsx(P,{}),showSidebarToggleButton:!0,padding:"p-12",rightContent:e.jsx(be,{})}),e.jsx("div",{className:"space-y-4 overflow-y-auto px-8",children:s.map(a=>e.jsx(W,{conversation:a},a.id))}),o&&e.jsx(O,{}),e.jsx(T,{hideIfOnlyOnePage:!0,className:"flex-shrink-0",onPageChange:a=>n({page:a}),query:t})]})}function be(){const[t,s]=m.useState(!1);return e.jsxs(g,{type:"modal",isOpen:t,onOpenChange:s,children:[e.jsx(K,{variant:"outline",startIcon:e.jsx(oe,{}),size:"xs",children:e.jsx(i,{message:"Views"})}),e.jsx(z,{onClick:o=>{o.target instanceof HTMLElement&&o.target.closest("button,a")&&s(!1)},children:e.jsx(le,{})})]})}function O(){return e.jsx(de,{size:"sm",image:e.jsx(ce,{size:"xl"}),imageMargin:"mb-12",imageHeight:"h-auto",title:e.jsx(i,{message:"There are no conversations in this view"})})}function P(){const t=_(),s=t?e.jsx(i,{message:t}):e.jsx(i,{message:"All"});return e.jsxs(m.Fragment,{children:[s,e.jsx(J,{children:s})]})}function ye(){const{conversationsTableViewsSidebarOpen:t,toggleConversationsTableViewsSidebar:s}=U();return e.jsx(F,{placement:"bottom",label:t?e.jsx(i,{message:"Hide views sidebar"}):e.jsx(i,{message:"Show views sidebar"}),children:e.jsx(H,{size:"xs",onClick:()=>s(),children:e.jsx(ue,{})})})}export{Ms as Component};
