import{r as j,j as e,B as v,T as u,ae as y,b1 as m,p as C,av as I,d as z,al as B,am as P,an as N,ap as S,aP as T,aq as A,Q as L,ac as R,aj as V,as as M,z as F,C as w,A as $}from"./client-DtfdVV77.js";import{u as k}from"./data-table-header-CdCZHch7.js";import{a as E,b as K,c as O,d as q,e as H}from"./select-filter-panel-hjhYEdoY.js";import{u as Q}from"./normalized-model-field-D3Ui05eZ.js";import{n as U,y as _}from"./main-BGmGAxtx.js";import{F as G}from"./formatted-number-CIAFur2S.js";import{S as g}from"./skeleton-D178v0-U.js";import{F as J}from"./filter-operator-names-BbrFb9i0.js";const D=j.forwardRef((t,n)=>{const{isInactive:r,filter:a,...o}=t;return r?e.jsx(W,{filter:a,...o,ref:n}):e.jsx(X,{filter:a,...o,ref:n})}),W=j.forwardRef(({filter:t,...n},r)=>e.jsx(v,{variant:"outline",size:"xs",radius:"rounded-md",border:"border",ref:r,endIcon:e.jsx(y,{}),...n,children:e.jsx(u,{...t.label})})),X=j.forwardRef(({filter:t,children:n,...r},a)=>{const o=t.control.type===m.BooleanToggle;return e.jsxs(v,{variant:"outline",size:"xs",color:"primary",radius:"rounded-r-md",border:"border-y border-r",endIcon:!o&&e.jsx(y,{}),ref:a,...r,children:[e.jsx("span",{className:C(!o&&"mr-8 border-r border-r-primary-light pr-8"),children:e.jsx(u,{...t.label})}),n]})});function f(t){const{onValueChange:n,isInactive:r,filter:a,label:o}=t;return e.jsxs(I,{offset:10,type:"popover",onClose:s=>{s!==void 0&&n(s)},children:[e.jsx(D,{isInactive:r,filter:a,children:o}),e.jsx(Y,{...t})]})}function Y({filter:t,panel:n,value:r,operator:a}){const o=z({defaultValues:{[t.key]:{value:r,operator:a}}}),{close:s,formId:i}=B();return e.jsxs(P,{size:"xs",children:[e.jsx(N,{children:e.jsx(u,{...t.label})}),e.jsx(S,{className:"max-h-288",children:e.jsxs(T,{form:o,id:i,onSubmit:l=>{s(l[t.key])},children:[t.description&&e.jsx("div",{className:"mb-14 text-xs text-muted",children:e.jsx(u,{...t.description})}),n]})}),e.jsx(A,{children:e.jsx(v,{form:i,type:"submit",variant:"flat",color:"primary",size:"xs",children:e.jsx(u,{message:"Apply"})})})]})}function Z(t){switch(t.filter.control.type){case m.DateRangePicker:return e.jsx(ee,{...t});case m.BooleanToggle:return e.jsx(te,{...t});case m.Select:return e.jsx(ne,{...t});case m.ChipField:return e.jsx(re,{...t});case m.Input:return e.jsx(ae,{...t});case m.SelectModel:return e.jsx(le,{...t});case m.Custom:const n=t.filter.control.listItem;return e.jsx(n,{...t});default:return null}}function ee(t){const{value:n,filter:r}=t;let a;return n.preset!==void 0?a=e.jsx(u,{...U[n.preset].label}):a=e.jsx(_,{start:new Date(n.start),end:new Date(n.end),options:{dateStyle:"medium"}}),e.jsx(f,{...t,label:a,panel:e.jsx(H,{filter:r})})}function te({filter:t,isInactive:n,onValueChange:r}){return e.jsx(D,{onClick:()=>{r({value:t.control.defaultValue})},filter:t,isInactive:n})}function ne(t){const{filter:n,value:r}=t,a=n.control.options.find(o=>o.key===r);return e.jsx(f,{...t,label:a?typeof a.label=="string"?a.label:e.jsx(u,{...a.label}):null,panel:e.jsx(q,{filter:n})})}function re(t){const n=t.filter.control.autocompleteEndpoint?t.value.map(r=>r.name).join(", "):e.jsx(oe,{...t});return e.jsx(f,{...t,label:n,panel:e.jsx(O,{filter:t.filter})})}function oe(t){const{trans:n}=R(),{filter:r,value:a}=t,o=a.map(d=>{var c;return(c=r.control.options)==null?void 0:c.find(x=>x.key===d)}),s=3,i=a.length-s,l=e.jsx(j.Fragment,{children:o.filter(Boolean).slice(0,s).map((d,c)=>{let x="";return c!==0&&(x+=", "),x+=typeof d.label=="string"?d.label:n(d.label),x})});return i>0?e.jsx(u,{message:":names + :count more",values:{names:l,count:i}}):l}function ae(t){const{filter:n,value:r,operator:a}=t,o=a?e.jsx(u,{...J[a]}):null,s=n.control.inputType==="number"?e.jsx(G,{value:r}):r;return e.jsx(f,{...t,label:e.jsxs(j.Fragment,{children:[o," ",s]}),panel:e.jsx(K,{filter:n})})}function le(t){const{value:n,filter:r}=t,{isLoading:a,data:o}=Q(r.control.endpoint?`${r.control.endpoint}/${n}`:`normalized-models/${r.control.model}/${n}`,void 0,{enabled:!!n}),s=e.jsxs(j.Fragment,{children:[e.jsx(g,{variant:"avatar",size:"w-18 h-18 mr-6"}),e.jsx(g,{variant:"rect",size:"w-50"})]}),i=e.jsxs(j.Fragment,{children:[e.jsx(L,{size:"xs",src:o==null?void 0:o.model.image,label:o==null?void 0:o.model.name,className:"mr-6"}),o==null?void 0:o.model.name]}),l=a||!o?s:i;return e.jsx(f,{...t,label:l,panel:e.jsx(E,{filter:r})})}function se({filters:t,pinnedFilters:n,className:r,wrap:a}){const{decodedFilters:o,remove:s,replaceAll:i}=k(t,n);return o.length?e.jsx("div",{className:C("flex flex-shrink-0 items-center gap-6",r,a?"flex-wrap":"overflow-x-auto"),children:o.map((l,d)=>{const c=t.find(h=>h.key===l.key);if(!c)return null;const x=h=>{const b=[...o];b.splice(d,1,{key:c.key,value:h.value,isInactive:!1,operator:h.operator||c.defaultOperator}),i(b)};return e.jsxs("div",{className:"flex items-center",children:[!l.isInactive&&e.jsx(V,{variant:"outline",color:"primary",size:"xs",radius:"rounded-l-md",onClick:()=>{s(l.key)},children:e.jsx(M,{})}),e.jsx(Z,{filter:c,isInactive:l.isInactive,value:l.valueKey!=null?l.valueKey:l.value,operator:l.operator,onValueChange:x})]},l.key)})}):null}const p=["w-90","w-76","w-128"];function ie({count:t}){return e.jsx(F.div,{className:"flex h-30 items-center gap-6",...w,children:Array.from({length:t||3}).map((n,r)=>e.jsx(g,{variant:"rect",size:`h-full ${p[r%p.length]}`,radius:"rounded-md"},r))},"filter-list-skeleton")}function ge({pinnedFilters:t,filters:n,isLoading:r}){const{encodedFilters:a,decodedFilters:o}=k(n);return!r&&!t&&!o.length?null:e.jsx("div",{className:"mb-14",children:e.jsx($,{initial:!1,mode:"wait",children:r&&(a||t!=null&&t.length)?e.jsx(ie,{count:o.length+((t==null?void 0:t.length)||0)}):e.jsx(F.div,{...w,children:e.jsx(se,{filters:n,pinnedFilters:t})},"filter-list")})})}export{ge as D};
