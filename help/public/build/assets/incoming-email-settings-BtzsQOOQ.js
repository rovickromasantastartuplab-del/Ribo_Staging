import{d as E,bg as T,al as q,j as e,am as z,an as M,T as s,ap as V,aP as B,F as r,az as A,e as o,aq as G,B as u,aG as L,bf as R,u as g,be as H,r as F,p as U,av as P,a_ as C,aj as I,f as O}from"./client-DtfdVV77.js";import{A as W}from"./admin-config-DXsixO44.js";import{S}from"./settings-error-group-BnQc3270.js";import{A as Y}from"./settings-layout-FQP6W4_q.js";import{D as w}from"./settings-links-CRsxvJIZ.js";import{a as $}from"./settings-panel-gMfbp8IE.js";import{F as J}from"./select-D9niWe2H.js";import{M as K,C as Q}from"./connect-gmail-panel-Bs6ywo_M.js";import{u as X}from"./use-admin-settings-DArjpbC9.js";import{A as Z,a as x}from"./accordion-Dmxnze9z.js";import{A as ee}from"./Add-B1HfWgJf.js";import{D as se}from"./Delete-DWP7kvj0.js";import{b as ae}from"./main-BGmGAxtx.js";import"./dashboard-icons-BJ4c3Z5i.js";import"./library-icon-h4d3s9Ef.js";import"./messages-square-icon-D_3IR-rK.js";import"./Home-iO0iebLw.js";import"./SupervisorAccount-Bkn2ibMi.js";import"./Translate-DPB2wdvD.js";import"./TextFields-CM1xUWDR.js";import"./custom-menu-Dvq-fOnC.js";import"./use-admin-settings-page-nav-config-D58KRD8y.js";import"./datatable-page-with-header-layout-xcCtlWaX.js";import"./use-toggle-dashboard-left-sidebar-DxaOS7gK.js";import"./toggle-left-sidebar-icon-j-5uTef5.js";import"./file-upload-provider-B4w-VsYu.js";import"./uploaded-file-DOXWsty7.js";import"./pretty-bytes-bO14ePu9.js";import"./with-selector-DPNnjGhI.js";import"./useMutationState-Bmyxea6H.js";import"./blocker-dialog-B0Vc-LIE.js";import"./confirmation-dialog-BzXs9ksK.js";import"./external-link-Cxcw6nc_.js";import"./book-open-D91H26Dq.js";import"./combobox-end-adornment-CWQ4Xgal.js";import"./tabs-spjnXvK6.js";import"./use-social-login-BVUj2tXy.js";import"./useSuspenseQuery-Bmt2-NKx.js";import"./accordtion-animation-BGCK95Hj.js";function k({connection:a}){const n=E({defaultValues:a?{...a,authentication:a.authentication||"basic"}:{id:T(6).toLowerCase(),authentication:"basic",createTickets:!0,createReplies:!0}}),{formId:i,close:m}=q();return e.jsxs(z,{size:"lg",children:[e.jsx(M,{children:a?e.jsx(s,{message:"Edit connection"}):e.jsx(s,{message:"New connection"})}),e.jsx(V,{children:e.jsxs(B,{className:"space-y-16",form:n,id:i,disableNativeValidation:!0,onSubmit:l=>{a!=null&&a.folder&&a.folder!==l.folder&&(l.lastUid=null),m(l)},children:[e.jsx(r,{autoFocus:!0,required:!0,name:"name",label:e.jsx(s,{message:"Name"})}),e.jsx(r,{required:!0,name:"host",placeholder:"imap.gmail.com",label:e.jsx(s,{message:"Host"})}),e.jsxs(J,{required:!0,name:"authentication",label:e.jsx(s,{message:"Authentication"}),children:[e.jsx(A,{value:"basic",children:e.jsx(s,{message:"Basic"})}),e.jsx(A,{value:"oauth",children:e.jsx(s,{message:"OAuth"})})]}),e.jsx(r,{required:!0,name:"username",placeholder:"username@gmail.com",type:"email",label:e.jsx(s,{message:"Username"})}),e.jsx(ie,{}),e.jsx(r,{name:"port",type:"number",label:e.jsx(s,{message:"Port"}),placeholder:"993"}),e.jsx(r,{name:"folder",label:e.jsx(s,{message:"Folder"}),className:"mb-14",description:e.jsx(s,{message:"From which folder emails should be imported. Leave empty to import all emails in the inbox."})}),e.jsx(o,{name:"createTickets",className:"mt-28",description:e.jsx(s,{message:"Create new tickets from emails received via this connection."}),children:e.jsx(s,{message:"Create new tickets"})}),e.jsx(o,{name:"createReplies",description:e.jsx(s,{message:"If email is in reply to existing ticket, create a new reply."}),children:e.jsx(s,{message:"Create replies"})})]})}),e.jsxs(G,{children:[e.jsx(u,{onClick:()=>m(),children:e.jsx(s,{message:"Cancel"})}),e.jsx(u,{type:"submit",form:i,variant:"flat",color:"primary",children:e.jsx(s,{message:"Save"})})]})]})}function ie(){const a=L({name:"authentication"});return e.jsx(r,{required:!0,type:a==="oauth"?"text":"password",name:"password",label:a==="oauth"?e.jsx(s,{message:"Access token"}):e.jsx(s,{message:"Password"})})}function $e(){var l,p,t,c,d,j,h,b,f,y,N,v,_;const[a,n]=R("incoming-email-settings-expanded",[0,1,2]),{data:i}=X(),m=E({defaultValues:{client:{incoming_email:{imap:((l=i.client.incoming_email)==null?void 0:l.imap)??{connections:[]},api:{enabled:((t=(p=i.client.incoming_email)==null?void 0:p.api)==null?void 0:t.enabled)??!1},mailgun:{enabled:((d=(c=i.client.incoming_email)==null?void 0:c.mailgun)==null?void 0:d.enabled)??!1,verify:((h=(j=i.client.incoming_email)==null?void 0:j.mailgun)==null?void 0:h.verify)??!1},pipe:{enabled:((f=(b=i.client.incoming_email)==null?void 0:b.pipe)==null?void 0:f.enabled)??!1},gmail:{enabled:((N=(y=i.client.incoming_email)==null?void 0:y.gmail)==null?void 0:N.enabled)??!1,topicName:((_=(v=i.client.incoming_email)==null?void 0:v.gmail)==null?void 0:_.topicName)??""}}},server:{mailgun_secret:i.server.mailgun_secret??""}}});return e.jsxs(Y,{form:m,title:e.jsx(s,{message:"Email"}),tabs:e.jsx(K,{}),children:[e.jsxs($,{margin:"mt-24",size:"lg",children:[e.jsx(s,{message:"Email handlers"}),e.jsx(s,{message:"Configure different handlers for turning incoming emails into tickets and replies. You can enable multiple handlers at the same time."})]}),e.jsx(w,{className:"mb-24 mt-8 text-sm",link:W.settings.incomingEmail}),e.jsxs(Z,{variant:"outline",mode:"multiple",expandedValues:a??[],onExpandedChange:D=>n(D),children:[e.jsx(x,{label:e.jsx(s,{message:"IMAP"}),children:e.jsx(re,{})}),e.jsx(x,{label:e.jsx(s,{message:"Pipe"}),children:e.jsx(le,{})}),e.jsx(x,{label:e.jsx(s,{message:"Rest API"}),children:e.jsx(te,{})}),e.jsx(x,{label:e.jsx(s,{message:"Gmail API"}),children:e.jsx(me,{})}),e.jsx(x,{label:e.jsx(s,{message:"Mailgun"}),children:e.jsx(ne,{})})]})]})}function te(){const{base_url:a,branding:{site_name:n}}=g();return e.jsxs("div",{children:[e.jsx(o,{name:"client.incoming_email.api.enabled",children:e.jsx(s,{message:"Enabled"})}),e.jsx("p",{className:"mt-10 text-xs text-muted",children:e.jsx(s,{message:"Send emails to :siteName from a 3rd party application or a different website using REST API.",values:{siteName:n}})}),e.jsx(w,{className:"mt-12 text-sm",link:`${a}/api-docs#Tickets-incomingEmail`,children:e.jsx(s,{message:"API docs"})})]})}function ne(){const{branding:{site_name:a}}=g();return e.jsxs("div",{children:[e.jsx(o,{name:"client.incoming_email.mailgun.enabled",children:e.jsx(s,{message:"Enabled"})}),e.jsx("p",{className:"mt-10 text-xs text-muted",children:e.jsx(s,{message:"Send emails to :siteName using Mailgun inbound routes functionality.",values:{siteName:a}})}),e.jsx(r,{size:"sm",className:"mt-20",name:"server.mailgun_secret",label:e.jsx(s,{message:"Mailgun API key"})}),e.jsx(o,{className:"mt-14",name:"client.incoming_email.mailgun.verify",description:e.jsx(s,{message:"Verify that incoming request is really from mailgun. It's highly recommended to have this on, unless you are not able to receive emails from mailgun otherwise."}),children:e.jsx(s,{message:"Verify"})})]})}function me(){const{branding:{site_name:a}}=g(),{watch:n}=O(),i=n("client.incoming_email.gmail.enabled");return e.jsx(S,{name:"gmail_group",separatorBottom:!1,separatorTop:!1,children:m=>e.jsxs(F.Fragment,{children:[e.jsx(o,{name:"client.incoming_email.gmail.enabled",invalid:m,children:e.jsx(s,{message:"Enabled"})}),e.jsx("p",{className:"mt-10 text-xs text-muted",children:e.jsx(s,{message:"Connect your existing gmail acocunt using gmail API.",values:{siteName:a}})}),e.jsx(r,{invalid:m,name:"client.incoming_email.gmail.topicName",minLength:10,required:i,label:e.jsx(s,{message:"Gmail topic name"}),description:e.jsx(s,{message:"Google cloud Pub/Sub topic name."}),className:"my-20",size:"sm"}),e.jsx(Q,{})]})})}function le(){const{branding:{site_name:a}}=g();return e.jsxs("div",{children:[e.jsx(o,{name:"client.incoming_email.pipe.enabled",children:e.jsx(s,{message:"Enabled"})}),e.jsx("p",{className:"mt-10 text-xs text-muted",children:e.jsx(s,{message:"Pipe emails to :siteName from cpanel or another control panel used by your hosting provider.",values:{siteName:a}})})]})}function re(){const{branding:{site_name:a}}=g(),{fields:n,append:i,remove:m,update:l}=H({name:"client.incoming_email.imap.connections",keyName:"key"});return e.jsx(S,{name:"imap_group",separatorBottom:!1,separatorTop:!1,children:p=>e.jsxs(F.Fragment,{children:[e.jsx("p",{className:"mb-10 text-xs text-muted",children:e.jsx(s,{message:"Connect your existing email accounts to :siteName using IMAP.",values:{siteName:a}})}),e.jsx("div",{className:"mb-20 space-y-14",children:n.map((t,c)=>e.jsxs("div",{className:U("flex items-center",p&&"text-danger"),children:[e.jsxs("div",{className:"mr-auto",children:[e.jsx("div",{children:t.name}),e.jsx("div",{className:"text-xs text-muted",children:t.username})]}),e.jsxs(P,{type:"modal",onClose:d=>{d&&l(c,d)},children:[e.jsx(C,{label:e.jsx(s,{message:"Edit"}),children:e.jsx(I,{size:"sm",className:"text-muted",children:e.jsx(ae,{})})}),e.jsx(k,{connection:t})]}),e.jsx(C,{label:e.jsx(s,{message:"Delete"}),children:e.jsx(I,{size:"sm",className:"text-muted",onClick:()=>m(c),children:e.jsx(se,{})})})]},t.key))}),e.jsxs(P,{type:"modal",onClose:t=>{t&&i(t)},children:[e.jsx(u,{variant:"outline",color:"primary",startIcon:e.jsx(ee,{}),size:"xs",children:e.jsx(s,{message:"Add connection"})}),e.jsx(k,{})]})]})})}export{$e as Component};
