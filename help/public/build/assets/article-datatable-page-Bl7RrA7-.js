import{j as e,T as s,aQ as x,as as p,D as H,aj as z,L as y,r as u,p as L,m as o,b1 as j,b2 as b,af as O,i as v,s as A,q as w,k as C,u as I,al as P,aZ as Q,t as K,av as k,B as l,aw as _,ae as D,ax as T,az as h,d as U,am as R,an as W,ap as $,aP as G,aq as Z}from"./client-DtfdVV77.js";import{A as J}from"./article-path-CQn_uF_m.js";import{a as X}from"./name-with-avatar-D8NZSkGp.js";import{a as Y,T as ee}from"./table-CynOKbaN.js";import{E as te}from"./Edit-BaEHOLuK.js";import{I as ae,i as se,j as ie}from"./main-BGmGAxtx.js";import{h as S}from"./custom-menu-Dvq-fOnC.js";import{H as re}from"./hc-article-editor-breadcrumb-B9KeImC7.js";import{u as oe,a as ne}from"./use-uningest-articles-Dh8nNRJx.js";import{V as le}from"./visible-to-field-gdyusxCr.js";import{G as ce}from"./global-loading-progress-DVC8NxPo.js";import{D as de}from"./data-table-add-item-button-B_2m2pad.js";import{D as me}from"./data-table-header-CdCZHch7.js";import{D as ue}from"./data-table-pagination-footer-B4yyc06A.js";import{u as he}from"./use-datatable-search-params-dzq5X78n.js";import{D as ge}from"./data-table-emty-state-message-DsPxSC6g.js";import{D as xe}from"./datatable-filters-KJfH8nG0.js";import{a as pe,D as je,b as be,c as fe}from"./datatable-page-with-header-layout-xcCtlWaX.js";import{u as ye}from"./use-datatable-query-v3pOHYke.js";import{C as De}from"./confirmation-dialog-BzXs9ksK.js";import{o as Se}from"./online-articles-CqWeBVNj.js";import"./category-link-DefoIvjU.js";import"./slugify-string-CGmMIJK7.js";import"./skeleton-D178v0-U.js";import"./checkbox-CS7ILu6P.js";import"./CheckBoxOutlineBlank-DU0ZdwTb.js";import"./ArrowDownward-DHtsWMyK.js";import"./useEffectEvent-Offmqu_S.js";import"./is-ctrl-key-pressed-CaS-AM38.js";import"./useGlobalListeners-BGMP113F.js";import"./useSuspenseQuery-Bmt2-NKx.js";import"./breadcrumb-CaNBY_Ut.js";import"./ChevronRight-C5OrfRtB.js";import"./MoreHoriz-Df3_bV9s.js";import"./select-D9niWe2H.js";import"./combobox-end-adornment-CWQ4Xgal.js";import"./Add-B1HfWgJf.js";import"./FilterAlt-CRhKT7zD.js";import"./select-filter-panel-hjhYEdoY.js";import"./form-chip-field-C7l8nGPv.js";import"./chip-list-DHXDGW6X.js";import"./filter-operator-names-BbrFb9i0.js";import"./normalized-model-field-D3Ui05eZ.js";import"./accordion-Dmxnze9z.js";import"./accordtion-animation-BGCK95Hj.js";import"./formatted-number-CIAFur2S.js";import"./use-toggle-dashboard-left-sidebar-DxaOS7gK.js";import"./toggle-left-sidebar-icon-j-5uTef5.js";const ve=[{key:"name",width:"flex-3 min-w-200",visibleInMode:"all",header:()=>e.jsx(s,{message:"Article"}),body:t=>e.jsx(Ae,{article:t})},{key:"author_id",allowsSorting:!0,width:"min-w-200",visibleInMode:"all",header:()=>e.jsx(s,{message:"Owner"}),body:t=>t.author?e.jsx(X,{image:t.author.image,label:t.author.name,description:t.author.email,avatarCircle:!0}):null},{key:"draft",allowsSorting:!0,width:"w-100 flex-shrink-0",header:()=>e.jsx(s,{message:"Published"}),body:t=>t.draft?e.jsx(p,{size:"md",className:"text-muted"}):e.jsx(x,{size:"md",className:"text-positive"})},{key:"used_by_ai_agent",allowsSorting:!0,width:"w-100 flex-shrink-0",header:()=>e.jsx(s,{message:"AI agent"}),body:t=>t.used_by_ai_agent?e.jsx(x,{size:"md",className:"text-positive"}):e.jsx(p,{size:"md",className:"text-muted"})},{key:"updated_at",allowsSorting:!0,width:"w-96",header:()=>e.jsx(s,{message:"Last updated"}),body:t=>e.jsx("time",{children:e.jsx(H,{date:t.updated_at})})},{key:"actions",header:()=>e.jsx(s,{message:"Actions"}),width:"w-42 flex-shrink-0",hideHeader:!0,align:"end",visibleInMode:"all",body:t=>e.jsx("div",{className:"text-muted",children:e.jsx(z,{size:"md",elementType:y,to:`${t.id}/edit`,children:e.jsx(te,{})})})}];function Ae({article:t}){const{isCollapsedMode:a}=u.useContext(Y);return e.jsxs("div",{className:"min-w-0",children:[e.jsx(y,{to:`${t.id}/edit`,className:L("hover:text-primary hover:underline",a?"whitespace-normal":"overflow-hidden overflow-ellipsis whitespace-nowrap font-medium"),children:t.title}),!a&&e.jsx("div",{className:"mt-4 text-xs",children:e.jsx(J,{path:t.path})})]})}const f=[{key:"draft",label:o("Status"),defaultOperator:b.eq,control:{type:j.Select,options:[{key:"01",value:"",label:o("All")},{key:"02",value:!1,label:o("Published")},{key:"03",value:!0,label:o("Draft")}],defaultValue:"01"}},{key:"author_id",label:o("Author"),description:o("User this article was created by"),defaultOperator:b.eq,control:{type:j.SelectModel,model:ae}},se({description:o("Date article was created")}),ie({description:o("Date article was last updated")})];O().settings.modules.ai.installed&&f.splice(2,0,{key:"used_by_ai_agent",label:o("AI Agent status"),defaultOperator:b.eq,control:{type:j.Select,options:[{key:"01",value:!0,label:o("Used by AI agent")},{key:"02",value:!1,label:o("Not used by AI agent")}],defaultValue:"01"}});const B={changeArticleStatus:(t,a)=>({action:"changeArticleStatus",articleIds:t,data:{status:a}}),changeVisibility:(t,a)=>({action:"changeVisibility",articleIds:t,data:{roleId:a}})},F=()=>v({mutationFn:t=>C.post("hc/articles/batch-action",{...t}).then(a=>a.data),onSuccess:()=>{w.invalidateQueries({queryKey:S.manager.invalidateKey})},onError:t=>A(t)});function wt(){const{aiAgent:t}=I(),a=u.useMemo(()=>ve.filter(d=>d.key!=="used_by_ai_agent"||(t==null?void 0:t.enabled)),[t]),[i,r]=u.useState([]),{searchParams:n,sortDescriptor:g,mergeIntoSearchParams:c,setSearchQuery:N,isFiltering:E}=he(Q),m=ye(S.articles.index(n)),M=e.jsx(re,{}),V=e.jsx(we,{selectedIds:i,onActionDone:()=>r([])}),q=e.jsx(u.Fragment,{children:e.jsx(de,{elementType:y,to:"new",children:e.jsx(s,{message:"Add article"})})});return e.jsxs(pe,{children:[e.jsx(ce,{query:m}),e.jsx(je,{title:M,showSidebarToggleButton:!0}),e.jsxs(be,{children:[e.jsx(me,{searchValue:n.query,onSearchChange:N,actions:q,selectedItems:i,selectedActions:V,filters:f}),e.jsx(xe,{filters:f}),e.jsxs(fe,{children:[e.jsx(ee,{cellHeight:"h-60",columns:a,data:m.items,sortDescriptor:g,onSortChange:c,enableSelection:!0,selectedRows:i,onSelectionChange:r}),m.isEmpty&&e.jsx(ge,{isFiltering:E,image:Se,title:e.jsx(s,{message:"No articles have been created yet"}),filteringTitle:e.jsx(s,{message:"No matching articles"})}),e.jsx(ue,{query:m,onPageChange:d=>c({page:d}),onPerPageChange:d=>c({perPage:d})})]})]})]})}function we({selectedIds:t,onActionDone:a}){const{aiAgent:i}=I();return e.jsxs("div",{className:"flex gap-8",children:[e.jsx(Ce,{selectedIds:t,onSuccess:()=>a()}),e.jsx(Ie,{selectedIds:t,onSuccess:()=>a()}),(i==null?void 0:i.enabled)&&e.jsx(ke,{selectedIds:t,onSuccess:()=>a()}),e.jsxs(k,{type:"modal",children:[e.jsx(l,{variant:"flat",color:"danger",children:e.jsx(s,{message:"Delete"})}),e.jsx(_e,{selectedIds:t,onDelete:()=>a()})]})]})}function Ce({selectedIds:t,onSuccess:a}){const i=F();return e.jsxs(_,{onItemSelected:r=>{i.mutate(B.changeArticleStatus(t,r),{onSuccess:()=>a()})},children:[e.jsx(l,{variant:"outline",endIcon:e.jsx(D,{}),disabled:i.isPending,children:e.jsx(s,{message:"Change status"})}),e.jsxs(T,{children:[e.jsx(h,{value:"published",children:e.jsx(s,{message:"Published"})}),e.jsx(h,{value:"draft",children:e.jsx(s,{message:"Draft"})})]})]})}function Ie({selectedIds:t,onSuccess:a}){return e.jsxs(k,{type:"modal",children:[e.jsx(l,{variant:"outline",endIcon:e.jsx(D,{}),children:e.jsx(s,{message:"Change visibility"})}),e.jsx(Pe,{selectedIds:t,onSuccess:()=>a()})]})}function Pe({selectedIds:t,onSuccess:a}){const{close:i,formId:r}=P(),n=F(),g=U({defaultValues:{visible_to_role:""}});return e.jsxs(R,{children:[e.jsx(W,{children:e.jsx(s,{message:"Change visibility"})}),e.jsx($,{children:e.jsx(G,{id:r,form:g,onSubmit:c=>n.mutate(B.changeVisibility(t,c.visible_to_role),{onSuccess:()=>{i(),a()}}),children:e.jsx(le,{className:"mb-24",description:e.jsx(s,{message:"Control who can see this article in help center"})})})}),e.jsxs(Z,{children:[e.jsx(l,{onClick:()=>i(),children:e.jsx(s,{message:"Cancel"})}),e.jsx(l,{form:r,type:"submit",variant:"flat",color:"primary",disabled:n.isPending,children:e.jsx(s,{message:"Change"})})]})]})}function ke({selectedIds:t,onSuccess:a}){const i=oe(),r=ne();return e.jsxs(_,{children:[e.jsx(l,{variant:"outline",endIcon:e.jsx(D,{}),disabled:i.isPending||r.isPending,children:e.jsx(s,{message:"Change AI agent state"})}),e.jsxs(T,{children:[e.jsx(h,{value:"enable",startIcon:e.jsx(x,{size:"sm"}),onSelected:()=>i.mutate({articleIds:t},{onSuccess:()=>a()}),children:e.jsx(s,{message:"Enable for AI agent"})}),e.jsx(h,{value:"disable",startIcon:e.jsx(p,{size:"sm"}),onSelected:()=>r.mutate({articleIds:t},{onSuccess:()=>a()}),children:e.jsx(s,{message:"Disable for AI agent"})})]})]})}function _e({selectedIds:t,onDelete:a}){const{close:i}=P(),r=v({mutationFn:()=>C.delete(`hc/articles/${t.join(",")}`),onSuccess:async()=>{await w.invalidateQueries({queryKey:S.articles.invalidateKey}),K(o("Articles deleted")),a(),i()},onError:n=>A(n)});return e.jsx(De,{isDanger:!0,isLoading:r.isPending,title:e.jsx(s,{message:"Delete articles"}),body:e.jsx(s,{message:"Are you sure you want to delete selected articles?",values:{count:t.length}}),confirm:e.jsx(s,{message:"Delete"}),onConfirm:()=>r.mutate()})}export{wt as Component,_e as DeleteArticlesDialog};
