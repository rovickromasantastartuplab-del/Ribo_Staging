import{r as m}from"./client-DtfdVV77.js";import{U as y}from"./uploaded-file-DOXWsty7.js";async function O(n){const c=[];for await(const r of n)c.push(r);return c}const F=new Map,v=new Map,M=new Map,f={status:"inactive"};async function*P(n){const c=[];for(const r of n.items)if(r.kind==="file"){const o=r.webkitGetAsEntry();o&&c.push(o)}for(const r of c)if(r.isFile){if(r.name===".DS_Store")continue;const o=await T(r);yield new y(o,r.fullPath)}else r.isDirectory&&(yield*E(r))}async function*E(n){const c=n.createReader();let r;do{r=await new Promise((o,s)=>{c.readEntries(o,s)});for(const o of r)if(o.isFile){if(o.name===".DS_Store")continue;const s=await T(o);yield new y(s,o.fullPath)}else o.isDirectory&&(yield*E(o))}while(r.length>0)}function T(n){return new Promise((c,r)=>n.file(c,r))}const A=400;function _({id:n,disabled:c,ref:r,...o}){const s=m.useRef({dragOverElements:new Set,dropActivateTimer:void 0}).current,l=m.useRef(o);l.current=o,m.useLayoutEffect(()=>(v.set(n,{...v.get(n),disabled:c,id:n,ref:r}),()=>{v.delete(n)}),[n,l,c,r]);const g=e=>{var i;const t=l.current,a=t.allowDragEventsFromItself||r.current!==((i=e.ref)==null?void 0:i.current);return!!(e!=null&&e.type&&a&&t.types.includes(e.type)&&(!t.acceptsDrop||t.acceptsDrop(e)))},D=e=>{var a,i;const t=d(e);t&&((i=(a=l.current).onDragLeave)==null||i.call(a,t))};return{droppableProps:c?{}:{onDragOver:e=>{var a,i;e.preventDefault(),e.stopPropagation();const t=d(e);t&&g(t)&&((i=(a=l.current).onDragOver)==null||i.call(a,t,e))},onDragEnter:e=>{var a,i;if(e.stopPropagation(),s.dragOverElements.add(e.target),s.dragOverElements.size>1)return;const t=d(e);t&&g(t)&&((i=(a=l.current).onDragEnter)==null||i.call(a,t),clearTimeout(s.dropActivateTimer),typeof l.current.onDropActivate=="function"&&(s.dropActivateTimer=setTimeout(()=>{var u,p;t&&((p=(u=l.current).onDropActivate)==null||p.call(u,t))},A)))},onDragLeave:e=>{e.stopPropagation(),s.dragOverElements.delete(e.target);for(const a of s.dragOverElements)e.currentTarget.contains(a)||s.dragOverElements.delete(a);if(s.dragOverElements.size>0)return;const t=d(e);t&&g(t)&&(D(e),clearTimeout(s.dropActivateTimer))},onDrop:async e=>{var a,i,u,p;e.preventDefault(),e.stopPropagation(),s.dragOverElements.clear(),D(e),clearTimeout(s.dropActivateTimer);const t=d(e);if(t)if((i=(a=l.current).onDragLeave)==null||i.call(a,t),!g(t))f.status!=="inactive"&&(f.status="dropFail");else{const w=(p=(u=l.current).onDrop)==null?void 0:p.call(u,t);f.status!=="inactive"&&(f.status=w===!1?"dropFail":"dropSuccess")}}}}}function d(n){if(f.dragTargetId!=null)return F.get(f.dragTargetId);if(n.dataTransfer.types.includes("Files"))return{type:"nativeFile",el:null,ref:null,getData:()=>O(P(n.dataTransfer))}}export{F as a,f as b,M as c,v as d,_ as u};
