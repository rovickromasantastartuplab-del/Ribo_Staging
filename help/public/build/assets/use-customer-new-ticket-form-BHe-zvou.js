import{aG as y,j as s,az as v,T as p,X as F,A as k,z as w,p as C,r as h,F as A,d as T,aV as I}from"./client-DtfdVV77.js";import{h as x}from"./custom-menu-Dvq-fOnC.js";import{u as N}from"./useSuspenseQuery-Bmt2-NKx.js";import{F as S}from"./select-D9niWe2H.js";import{A as E}from"./article-link-kVBPNf7I.js";import{A as f}from"./accordtion-animation-BGCK95Hj.js";import{g as V}from"./get-default-values-for-form-with-attributes-htMbgWW2.js";function z({attribute:e}){var m,g;const a=N(x.customerConversations.newTicketPageData()),r=(m=e.config)!=null&&m.options?e.config.options.filter(t=>!t.agentOnly):[],o=y({name:"attributes.category"}),c=r.find(t=>t.value===o),n=(g=c==null?void 0:c.envatoItems)==null?void 0:g.some(t=>{var l,u,d;return(d=(u=(l=a.data)==null?void 0:l.envatoItems)==null?void 0:u.find(i=>i.id===t))==null?void 0:d.support_expired});return s.jsx(S,{required:!0,name:"attributes.category",selectionMode:"single",className:"mb-24",label:s.jsx(p,{message:e.name}),errorMessage:n&&s.jsx(p,{message:"Your support for this item has expired. <a>Click here to renew</a>",values:{a:t=>s.jsx("a",{href:"https://codecanyon.net/downloads",target:"_blank",rel:"noreferrer",className:"font-bold underline",children:t})}}),children:r.map(t=>s.jsx(v,{value:t.value,children:t.label},t.value))})}function q({query:e,hcCategoryIds:a}){const{data:r}=F(x.articles.search({query:e,perPage:"5",categoryIds:a})),o=(r==null?void 0:r.pagination.data)||[],c=!!(o!=null&&o.length);return s.jsx(k,{children:s.jsxs(w.div,{variants:f.variants,transition:f.transition,initial:!1,animate:c?"open":"closed",className:"mt-24",children:[s.jsxs("div",{className:"mb-4 text-xl font-semibold",children:[s.jsx(p,{message:"Were you looking for"}),":"]}),o.map((n,m)=>s.jsx(E,{article:n,className:C("block py-4 text-sm text-primary",m===o.length-1&&"mb-16"),target:"_blank"},n.id))]},"drawer")})}function G({attribute:e,searchQuery:a,hcCategoryIds:r}){return s.jsxs(h.Fragment,{children:[s.jsx(A,{name:"subject",label:s.jsx(p,{message:e.name}),required:!0}),s.jsx(q,{query:a,hcCategoryIds:r})]})}function H(e){var l,u,d;const a=T({defaultValues:{email:e.customerHasVerifiedEmail?void 0:e.customerEmail,attributes:V(e.attributes),message:{body:"",attachments:[]}}}),r=a.watch("message.attachments"),o=a.watch("subject"),c=I(),n=e.attributes.find(i=>i.key==="category"),m=a.watch("attributes.category"),g=(d=(u=(l=n==null?void 0:n.config)==null?void 0:l.options)==null?void 0:u.find(i=>i.value===m))==null?void 0:d.hcCategories,t=h.useMemo(()=>{var i;return((i=e.config.attributeIds)==null?void 0:i.map(b=>e.attributes.find(j=>j.id===b)))??[]},[e]);return{form:a,attachments:r,searchQuery:o,searchTermLogger:c,hcCategoryIds:g,attributes:t}}export{z as C,G as S,H as u};
