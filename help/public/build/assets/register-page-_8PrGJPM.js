import{h as C,b4 as w,a as F,i as P,bw as k,k as S,u as j,c as R,aL as _,d as E,j as e,N as L,T as s,aP as A,F as u,B as I,t as T,m as q,L as B}from"./client-DtfdVV77.js";import{G as M,A as U}from"./auth-layout-Pf6PSjuN.js";import{u as D,C as G}from"./use-captcha-BCeBTZMW.js";import{L as f}from"./external-link-Cxcw6nc_.js";import{F as O}from"./checkbox-CS7ILu6P.js";import{o as z,a as Q}from"./custom-menu-Dvq-fOnC.js";import{h as V}from"./main-BGmGAxtx.js";import{S as H}from"./social-auth-section-DzmgHjYc.js";import"./CheckBoxOutlineBlank-DU0ZdwTb.js";import"./use-social-login-BVUj2tXy.js";import"./use-all-social-logins-disabled-aPb5okc5.js";import"./envato-DSHUfLey.js";import"./google-4IXOtUqo.js";function J(a){const t=C(),{getRedirectUri:i}=w(),{inviteId:o}=F();return P({mutationFn:r=>K({invite_id:o,...r}),onSuccess:r=>{k(r.bootstrapData),r.status==="needs_email_verification"?t("/"):t(i(),{replace:!0})},onError:r=>z(r,a)})}function K(a){return S.post("auth/register",a).then(t=>t.data)}function ce({inviteType:a,fields:t}){const{branding:i,registration:o,social:r}=j(),{captchaToken:l,captchaEnabled:d,resetCaptcha:b}=D("register"),{pathname:v}=R(),[g]=_(),n=v.includes("workspace")||!!a,N=g.get("redirectFrom")==="pricing",p=g.get("email")||void 0,h=E({defaultValues:{email:p}}),x=J(h);if(o!=null&&o.disable&&!n)return e.jsx(L,{to:"/login",replace:!0});let m=e.jsx(s,{message:"Create a new account"});n?m=e.jsx(s,{values:{siteName:i==null?void 0:i.site_name},message:"To join your team on :siteName, create an account"}):N&&(m=e.jsx(s,{message:"First, let's create your account"}));const y=e.jsx(s,{values:{a:c=>e.jsx(B,{className:f,to:"/login",children:c})},message:"Already have an account? <a>Sign in.</a>"});return e.jsx(M,{children:e.jsxs(U,{heading:m,message:y,children:[e.jsx(V,{children:e.jsx(s,{message:"Register"})}),e.jsxs(A,{form:h,onSubmit:async c=>{if(d&&!l){T.danger(q("Please solve the captcha challenge."));return}x.mutate({...c,captcha_token:l,invite_type:a},{onError:()=>b()})},children:[e.jsx(u,{className:"mb-32",name:"email",type:"email",disabled:!!p,label:e.jsx(s,{message:"Email"}),required:!0}),e.jsx(u,{className:"mb-32",name:"password",type:"password",label:e.jsx(s,{message:"Password"}),required:!0}),e.jsx(u,{className:"mb-32",name:"password_confirmation",type:"password",label:e.jsx(s,{message:"Confirm password"}),required:!0}),t,d&&e.jsx(G,{className:"mb-32"}),e.jsx(W,{}),e.jsx(I,{className:"block w-full",type:"submit",variant:"flat",color:"primary",size:"md",disabled:x.isPending,children:e.jsx(s,{message:"Create account"})}),e.jsx(H,{isUsingInvite:n,dividerMessage:r!=null&&r.compact_buttons?e.jsx(s,{message:"Or sign up with"}):e.jsx(s,{message:"OR"})})]})]})})}function W(){const{registration:a}=j();return a!=null&&a.policies?e.jsx("div",{className:"mb-32",children:a.policies.map(t=>e.jsx(O,{name:t.id,className:"mb-4 block",required:!0,children:e.jsx(s,{message:"I accept the :name",values:{name:e.jsx(Q,{unstyled:!0,className:()=>f,item:t})}})},t.id))}):null}export{ce as RegisterPage};
