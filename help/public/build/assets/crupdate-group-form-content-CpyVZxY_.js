import{J as S,ac as T,f as j,r as u,j as e,aa as I,ab as z,m as F,T as o,aX as M,az as y,X as V,l as k,aw as B,B as R,ax as D,aj as E,as as $,p,Z as Q,$ as G,aA as P,Q as _,F as q}from"./client-DtfdVV77.js";import{t as H}from"./team-DYmDDGxN.js";import{U}from"./main-BGmGAxtx.js";import{a as W}from"./name-with-avatar-D8NZSkGp.js";import{D as K}from"./data-table-emty-state-message-DsPxSC6g.js";import{T as O}from"./table-CynOKbaN.js";import{F as X}from"./select-D9niWe2H.js";import{u as L}from"./use-filter-XfxMyUPQ.js";import{A as J}from"./Add-B1HfWgJf.js";import{d as Z}from"./custom-menu-Dvq-fOnC.js";import{u as Y}from"./use-is-module-installed-CDjratdW.js";import{R as ee,a as se}from"./RadioButtonUnchecked-FxC3TMef.js";function te(s,t){const a=S(t);a.getQueryState(s.queryKey)||a.prefetchQuery(s)}const ae=9007199254740991;function re(s,t,a="desc"){return s.sort((n,l)=>{let i=w(n,t),r=w(l,t);const c=typeof i,m=typeof r;c!==m&&(c==="number"&&(i+=""),m==="number"&&(r+=""));let d=0;return i!=null&&r!=null?i>r?d=1:i<r&&(d=-1):i!=null?d=1:r!=null&&(d=-1),d*(a==="asc"?1:-1)})}function w(s,t){const a=Z.pick(t,s);if(ne(a)){const n=Number(a);return n<ae?`${n}`:a}return a}function ne(s){return!isNaN(parseFloat(s))&&!isNaN(Number(s))}const oe=[{key:"name",allowsSorting:!0,visibleInMode:"all",sortingKey:"description",header:()=>e.jsx(o,{message:"Agent"}),body:s=>e.jsx(W,{image:s.image,label:s.name,description:s.description,alwaysShowAvatar:!0})},{key:"role",allowsSorting:!0,sortingKey:"role.name",header:()=>e.jsx(o,{message:"Role"}),body:s=>s.role?e.jsx(M,{className:"w-max capitalize",radius:"rounded-button",size:"sm",children:s.role.name}):null},{key:"conversation_priority",allowsSorting:!0,header:()=>e.jsx(o,{message:"Conversation priority"}),body:(s,t)=>e.jsxs(X,{name:`users[${t.index}].conversation_priority`,selectionMode:"single",size:"sm",className:"h-46 max-w-180 p-4",floatingWidth:"auto",placement:"top-start",children:[e.jsx(y,{value:"primary",description:e.jsx(o,{message:"Conversations will be assigned to this agent first."}),children:e.jsx(o,{message:"Primary agent"})}),e.jsx(y,{value:"backup",description:e.jsx(o,{message:"Conversations will be assigned to this agent only if primary agent is not available or over their conversation limit."}),children:e.jsx(o,{message:"Backup agent"})})]})},{key:"actions",header:()=>e.jsx(o,{message:"Actions"}),hideHeader:!0,visibleInMode:"all",align:"end",width:"w-42 flex-shrink-0",body:(s,t)=>e.jsx(ie,{index:t.index})}];function ie({index:s}){const{setValue:t,getValues:a}=j();return e.jsx(E,{size:"md",className:"text-muted",onClick:()=>{t("users",a("users").filter((n,l)=>l!==s),{shouldDirty:!0})},children:e.jsx($,{})})}function le({group:s}){var N,C;te(k.agents.normalizedList);const{trans:t}=T(),{contains:a}=L(),{setValue:n,formState:l,clearErrors:i}=j(),[r,c]=u.useState({orderBy:"name",orderDir:"asc"}),[m,d]=u.useState(""),{watch:g}=j(),x=g("users"),b=u.useMemo(()=>(r.orderBy?re(x,r.orderBy,r.orderDir):x).filter(v=>a(v.name,m)),[r,x,a,m]),h=u.useMemo(()=>oe.filter(f=>!(f.key==="actions"&&(s!=null&&s.default))),[s]);return e.jsxs(u.Fragment,{children:[e.jsxs("div",{className:"mb-24 flex items-center justify-between gap-14",children:[e.jsx(I,{size:"sm",className:"mr-auto min-w-180 max-w-350 flex-auto",inputWrapperClassName:"mr-24 md:mr-0",placeholder:t(F("Type to search...")),startAdornment:e.jsx(z,{size:"sm"}),value:m,onChange:f=>d(f.target.value)}),!(s!=null&&s.default)&&e.jsx(ce,{onSelected:f=>{i("users"),x.find(v=>v.id===f.id)||n("users",[...x,{...f,conversation_priority:"backup"}],{shouldDirty:!0})}})]}),e.jsx(O,{columns:h,data:b,enableSelection:!1,collapseOnMobile:!0,sortDescriptor:r,onSortChange:c,cellHeight:"h-70"}),!b.length&&e.jsx(K,{className:"mt-40",image:H,isFiltering:!!m,title:e.jsx(o,{message:"This group has no members yet"}),filteringTitle:e.jsx(o,{message:"No matching members"})}),((N=l.errors.users)==null?void 0:N.message)&&e.jsx("div",{className:"text-center text-danger",children:(C=l.errors.users)==null?void 0:C.message})]})}function ce({onSelected:s}){var a;const t=V(k.agents.normalizedList);return e.jsxs(B,{children:[e.jsx(R,{variant:"outline",color:"primary",startIcon:e.jsx(J,{}),children:e.jsx(o,{message:"Add member"})}),e.jsx(D,{children:(a=t.data)==null?void 0:a.agents.map(n=>e.jsx(y,{value:n.id,startIcon:e.jsx(U,{user:n,size:"sm"}),onSelected:()=>s(n),children:n.name},n.id))})]})}function me({children:s,margin:t="mb-16"}){return e.jsx("div",{className:p(t,"text-base font-semibold"),children:s})}const de=u.forwardRef((s,t)=>{const{value:a,defaultValue:n,onChange:l,children:i,className:r,iconHorizPlacement:c="start",iconVertPlacement:m="top",invalid:d,layout:g="vertical"}=s,[x,b]=P(a,n,l);return e.jsx("div",{role:"radiogroup",className:p("flex gap-16",g==="horizontalDesktop"?"flex-col md:flex-row":g==="vertical"?"flex-col":"flex-row",r),ref:t,children:u.Children.map(i,h=>u.cloneElement(h,{value:h.props.value,onToggle:()=>b(h.props.value),checked:x===h.props.value,iconHorizPlacement:c,iconVertPlacement:m,invalid:d}))})});function A(s){const{label:t,description:a,iconHorizPlacement:n,iconVertPlacement:l,onToggle:i,checked:r,invalid:c}=s;return e.jsxs("div",{className:p("flex cursor-pointer gap-12 rounded-panel border p-16 transition-button hover:bg-hover",c?"border-danger":r?"border-primary":"border-divider",n==="end"&&"flex-row-reverse",l==="center"&&"items-center",l==="bottom"&&"items-end"),role:"radio",tabIndex:0,"aria-checked":r,onClick:()=>i(),children:[r?e.jsx(ee,{className:p(c?"text-danger":"text-primary")}):e.jsx(se,{className:p(c?"text-danger":"text-divider")}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-4 text-sm font-semibold",children:t}),e.jsx("div",{className:"text-sm text-muted",children:a})]})]})}function ue({children:s,...t}){const{field:{onChange:a,value:n,ref:l},fieldState:{invalid:i}}=Q({name:t.name}),r={onChange:a,value:n,invalid:t.invalid||i};return e.jsx(de,{ref:l,...G(r,t),children:s})}function ke({group:s}){const t=Y("livechat");return e.jsxs(u.Fragment,{children:[e.jsxs("div",{className:"mb-44 flex items-center gap-16",children:[e.jsx(_,{label:(s==null?void 0:s.name)??"Group",fallback:"initials",size:"w-66 h-66 text-2xl"}),e.jsx(q,{name:"name",label:e.jsx(o,{message:"Name"}),className:"flex-auto",required:!0})]}),t&&e.jsx(xe,{}),e.jsx(le,{group:s})]})}function xe(){return e.jsxs("div",{className:"mb-44",children:[e.jsx(me,{children:e.jsx(o,{message:"Choose new conversation assignment method"})}),e.jsxs(ue,{name:"assignment_mode",layout:"horizontalDesktop",children:[e.jsx(A,{value:"auto",label:e.jsx(o,{message:"Auto assignment"}),description:e.jsx(o,{message:"Conversations are evenly distributed among agents with 'accepting conversations' status. When all agents hit their limit, new visitors are queued."})}),e.jsx(A,{value:"manual",label:e.jsx(o,{message:"Manual assignment"}),description:e.jsx(o,{message:"All agents get notified about a customer waiting in the queue. Conversation will be assigned to the first agent who picks it up."})})]})]})}export{ke as C,me as a};
