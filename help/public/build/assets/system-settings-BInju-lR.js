import{d as C,j as e,T as t,B as j,f as I,r as l,az as p,i as ae,s as te,k as Q,t as A,m as g,F as u,p as ne,cg as ie,P as oe,bH as T,cu as G,ac as $,aP as X,aX as B,u as O,X as ce,E as le,L as de,aG as ue,aL as me}from"./client-DtfdVV77.js";import{A as _}from"./admin-config-DXsixO44.js";import{S as M}from"./settings-error-group-BnQc3270.js";import{A as D}from"./settings-layout-FQP6W4_q.js";import{D as E}from"./settings-links-CRsxvJIZ.js";import{S as w}from"./settings-panel-gMfbp8IE.js";import{u as v}from"./use-admin-settings-DArjpbC9.js";import{S as J}from"./section-helper-BcMoHesA.js";import{F as U}from"./select-D9niWe2H.js";import{C as pe}from"./check-circle-filled-B4oRGH_i.js";import{m as xe,E as he}from"./stream-BOYAfkJs.js";import{D as K}from"./datatable-page-with-header-layout-xcCtlWaX.js";import{o as ge}from"./custom-menu-Dvq-fOnC.js";import{O as R}from"./OpenInNew-C06CZDpe.js";import{B as Y}from"./blocker-dialog-B0Vc-LIE.js";import{E as je}from"./external-link-Cxcw6nc_.js";import{B as ve}from"./BrowserUpdated-B8idVEmY.js";import{u as fe}from"./uc-first-pSl3nM3z.js";import{T as be,a as _e,b as ye}from"./tabs-spjnXvK6.js";import"./dashboard-icons-BJ4c3Z5i.js";import"./library-icon-h4d3s9Ef.js";import"./messages-square-icon-D_3IR-rK.js";import"./main-BGmGAxtx.js";import"./Delete-DWP7kvj0.js";import"./Home-iO0iebLw.js";import"./SupervisorAccount-Bkn2ibMi.js";import"./Translate-DPB2wdvD.js";import"./TextFields-CM1xUWDR.js";import"./use-admin-settings-page-nav-config-D58KRD8y.js";import"./file-upload-provider-B4w-VsYu.js";import"./uploaded-file-DOXWsty7.js";import"./pretty-bytes-bO14ePu9.js";import"./with-selector-DPNnjGhI.js";import"./useMutationState-Bmyxea6H.js";import"./book-open-D91H26Dq.js";import"./useSuspenseQuery-Bmt2-NKx.js";import"./combobox-end-adornment-CWQ4Xgal.js";import"./use-toggle-dashboard-left-sidebar-DxaOS7gK.js";import"./toggle-left-sidebar-icon-j-5uTef5.js";import"./confirmation-dialog-BzXs9ksK.js";function Se({tabs:s,title:r}){const{data:a}=v(),n=C({defaultValues:{server:{cache_store:a.server.cache_store??"file",memcached_host:a.server.memcached_host??"",memcached_port:a.server.memcached_port??""}}});return e.jsxs(D,{form:n,title:r,tabs:s,children:[e.jsx(we,{}),e.jsx(ke,{})]})}function we(){return e.jsxs(w,{className:"mb-24",title:e.jsx(t,{message:"Cache Provider"}),description:e.jsx(t,{message:"Configure which method should be used for storing and retrieving cached items."}),link:_.settings.cache?e.jsx(E,{link:_.settings.cache}):void 0,children:[e.jsx(Ne,{}),e.jsx(J,{size:"sm",color:"warning",className:"mt-12",description:e.jsx(t,{message:'"File" is a good default, but other providers can provide better peformance, however they require extra setup on the server.'})})]})}function ke(){const s=Ce();return e.jsx(w,{title:e.jsx(t,{message:"Clear Cache"}),description:e.jsx(t,{message:"Clear application cache if you're experiencing issues with stale data."}),children:e.jsx(j,{type:"button",variant:"outline",size:"xs",color:"primary",disabled:s.isPending,onClick:()=>s.mutate(),children:e.jsx(t,{message:"Clear cache"})})})}function Ne(){const{watch:s,clearErrors:r}=I(),a=s("server.cache_store");let n=null;return a==="memcached"&&(n=Pe),e.jsx(M,{separatorTop:!1,separatorBottom:!1,name:"cache_group",children:i=>e.jsxs(l.Fragment,{children:[e.jsxs(U,{size:"sm",invalid:i,onSelectionChange:()=>r(),selectionMode:"single",name:"server.cache_store",children:[e.jsx(p,{value:"file",children:e.jsx(t,{message:"File (Default)"})}),e.jsx(p,{value:"array",children:e.jsx(t,{message:"None"})}),e.jsx(p,{value:"apc",children:"APC"}),e.jsx(p,{value:"memcached",children:"Memcached"}),e.jsx(p,{value:"redis",children:"Redis"})]}),n&&e.jsx("div",{className:"mt-20",children:e.jsx(n,{isInvalid:i})})]})})}function Pe({isInvalid:s}){return e.jsxs(l.Fragment,{children:[e.jsx(u,{size:"sm",invalid:s,className:"mb-20",name:"server.memcached_host",label:e.jsx(t,{message:"Memcached host"}),required:!0}),e.jsx(u,{size:"sm",invalid:s,type:"number",name:"server.memcached_port",label:e.jsx(t,{message:"Memcached port"}),required:!0})]})}function Ce(){return ae({mutationFn:()=>Q.post("cache/flush").then(s=>s.data),onSuccess:()=>{A(g("Cache cleared"))},onError:s=>te(s)})}const h={Preparing:"preparing",Downloading:"downloading",Extracting:"extracting",MovingNewFiles:"moving_new_files",Finalizing:"finalizing"},qe={[h.Preparing]:"Preparing to update",[h.Downloading]:"Downloading update",[h.Extracting]:"Extracting update",[h.MovingNewFiles]:"Copying new files",[h.Finalizing]:"Finalizing update"},b={Active:"active",Completed:"completed",Failed:"failed"};function Z({event:s}){var r;return e.jsxs("div",{className:ne(s.status===b.Completed&&"opacity-50"),children:[e.jsxs("div",{className:"flex items-center gap-8",children:[e.jsx(Fe,{event:s}),e.jsx("div",{children:s.message})]}),(r=s.context)!=null&&r.error?e.jsxs("div",{className:"mt-2 break-words text-sm text-danger",children:[e.jsx(t,{message:"Update failed:"})," ",s.context.error]}):null]})}function Fe({event:s}){var r,a;switch(s.status){case b.Active:return e.jsx(oe,{isIndeterminate:!((r=s.context)!=null&&r.progressPercentage),size:"w-24 h-24",value:(a=s.context)==null?void 0:a.progressPercentage});case b.Completed:return e.jsx(pe,{className:"text-positive"});case b.Failed:return e.jsx(ie,{className:"text-danger"})}}const ze="An unknown error occurred during update",Te=[[h.Preparing],[h.Downloading],[h.Extracting],[h.MovingNewFiles],[h.Finalizing]];let d=[];const W=()=>d.some(s=>s.status===b.Failed),q=l.createContext(null);function ee({children:s}){const{data:r}=v(),a=Object.entries((r==null?void 0:r.modules)??{}).filter(([,x])=>!x.built_in&&x.installed&&x.envato_purchase_code).map(([x])=>x),[n,i]=l.useState(!1),[c,o]=l.useState(!1),[m,f]=l.useState([]),[k,S]=l.useState(null),N=async x=>{i(!0),o(!0),S(x);const y=await P(x);return T.flushSync(()=>o(!1)),y},F=async()=>{i(!0),o(!0);const x=["app",...a];for(const y of x)if(S(y),!await P(y))return T.flushSync(()=>o(!1)),!1;return T.flushSync(()=>o(!1)),!0},P=async x=>{d=[],f([]);for(const y of Te){if(W())break;await Ae({steps:y,moduleName:x,onEvent:()=>f(d)})}return!W()};return e.jsx(q.Provider,{value:{updateInProgress:c,updateStarted:n,setUpdateStarted:i,events:m,updateOrInstallModule:N,updateAppAndModules:F,moduleNames:a,activeModuleName:k},children:s})}async function Ae({steps:s,moduleName:r,onEvent:a}){var i,c;const n=new AbortController;d.push({type:"event",step:s[0],status:b.Active,message:qe[s[0]]}),a();try{const o=await xe("update",{steps:s,moduleName:r},n==null?void 0:n.signal);(!o.ok||!(o!=null&&o.body))&&G();for await(const m of Ie(o,n))if(d=((i=d.at(-1))==null?void 0:i.step)===m.step?[...d.slice(0,-1),m]:[...d,m],a(),(c=m.context)!=null&&c.error)break}catch{H(!0)}H()}async function*Ie(s,r){if(!s.ok||!s.body)return G();const a=s.body.pipeThrough(new TextDecoderStream).pipeThrough(new he).getReader();for(a.closed.then(()=>r.abort()),r.signal.addEventListener("abort",()=>a.cancel());!r.signal.aborted;){const{done:n,value:i}=await a.read();if(n){r.abort();break}if(!i||!i.event)continue;const c=JSON.parse(i.data);if(c.type==="endStream"){r.abort();break}yield c}}function H(s=!1){var a;if(!s&&d.length&&((a=d.at(-1))==null?void 0:a.status)===b.Completed)return d;d!=null&&d.length||(d=[{type:"event",step:h.Preparing,status:b.Failed,message:"Preparing to update"}]);const r=d.length-1;return d[r].status=b.Failed,d[r].context||(d[r].context={}),d[r].context.error=d[r].context.error||ze,d}function Me({tabs:s,title:r,rightContent:a}){return e.jsxs("div",{className:"dashboard-grid-content dashboard-rounded-panel flex h-full flex-col",children:[e.jsx(K,{title:r,border:"border-none",showSidebarToggleButton:!0,rightContent:a}),s,e.jsx("div",{className:"overflow-y-auto",children:e.jsxs("div",{className:"mx-auto p-12 @container/settings-form md:p-24 lg:max-w-[1440px]",children:[e.jsx(De,{}),e.jsx(Ee,{})]})})]})}function De(){var f;const{trans:s}=$(),{data:r}=v(),[a,n]=l.useState(((f=r.license)==null?void 0:f.purchase_code)??""),i=C({defaultValues:{purchase_code:a??""}}),[c,o]=l.useState(!1),m=async k=>{var N;o(!0);const S=await se({code:k.purchase_code,form:i,itemId:((N=r.license)==null?void 0:N.item_id)??0});o(!1),S&&(A(g("Purchase code activated")),n(S))};return e.jsx(w,{title:e.jsx(t,{message:"Envato purchase code"}),description:e.jsx(t,{message:"Activate your license to enable automatic updates and other functionality."}),link:e.jsx(j,{variant:"link",color:"primary",size:"sm",href:_.settings.purchaseCode,target:"_blank",children:e.jsx(t,{message:"Where is my purchase code?"})}),children:e.jsxs(X,{form:i,disableNativeValidation:!0,onSubmit:k=>m(k),children:[e.jsx(u,{name:"purchase_code",label:e.jsx(t,{message:"Envato purchase code"}),labelDisplay:"hidden",placeholder:s(g("Example: :code",{values:{code:"91939276-b234-49d1-ac42-6c7xe5t7a128"}})),endAdornment:e.jsx(B,{size:"xs",color:a?"positive":"danger",className:"mr-12",children:a?e.jsx(t,{message:"ACTIVATED"}):e.jsx(t,{message:"NOT ACTIVATED"})}),required:!0}),e.jsx(j,{variant:"flat",color:"primary",type:"submit",disabled:c,className:"mt-24",children:e.jsx(t,{message:"Activate purchase code"})})]})})}function Ee(){const{data:s}=v();return!s.modules||!Object.keys(s.modules).length?null:e.jsxs("div",{children:[e.jsx("h2",{className:"mb-12 mt-44 text-lg font-semibold",children:e.jsx(t,{message:"Addon purchase codes"})}),e.jsx("div",{className:"space-y-12",children:Object.entries(s.modules).filter(([,r])=>!r.built_in).map(([r,a])=>e.jsx(ee,{children:e.jsx(Ue,{name:r,config:a})},r))})]})}function Ue({config:s,name:r}){var y,L;const{trans:a}=$(),{data:n}=v(),i=(L=(y=n.modules)==null?void 0:y[r])==null?void 0:L.envato_item_id,{updateOrInstallModule:c}=l.use(q),[o,m]=l.useState(s.installed),[f,k]=l.useState(s.envato_purchase_code),S=C({defaultValues:{purchase_code:f??""}}),N=async()=>{await c(r)?(T.flushSync(()=>{P(!1),m(!0)}),setTimeout(()=>{window.location.reload()},1e3)):A.danger(g("Failed to install module"))},[F,P]=l.useState(!1),x=async z=>{P(!0);const V=await se({code:z.purchase_code,form:S,itemId:s.envato_item_id??0,moduleName:r});V&&(k(V),o?A(g("Purchase code activated")):N()),P(!1)};return e.jsxs(w,{id:`module-${r}`,title:s.label,description:e.jsx(t,{message:"Enter purchase code to install this addon."}),link:e.jsx(j,{variant:"link",color:"primary",size:"sm",href:`https://codecanyon.net/item/i/${i}`,target:"_blank",endIcon:e.jsx(R,{}),children:e.jsx(t,{message:"Get this addon"})}),children:[F?e.jsx(Y,{shouldBlock:!0}):null,e.jsxs(X,{form:S,onSubmit:z=>x(z),children:[e.jsx(u,{required:!0,size:"sm",name:"purchase_code",label:e.jsx(t,{message:"Envato purchase code"}),labelDisplay:"hidden",placeholder:a(g("Example: :code",{values:{code:"91939276-b234-49d1-ac42-6c7xe5t7a128"}})),endAdornment:e.jsx(B,{size:"xs",color:f?"positive":"danger",className:"mr-12",children:f?e.jsx(t,{message:"ACTIVATED"}):e.jsx(t,{message:"NOT ACTIVATED"})})}),e.jsx(j,{variant:"flat",color:"primary",type:"submit",className:"mt-16",size:"xs",disabled:F,children:o?e.jsx(t,{message:"Activate"}):e.jsx(t,{message:"Activate and install"})})]}),e.jsx(Re,{onRetry:()=>N(),className:"mt-24 rounded-panel border p-16"})]})}function Re({onRetry:s,className:r}){var c;const{events:a,updateInProgress:n}=l.use(q),i=a.at(-1);return!a.length&&!n?null:e.jsxs("div",{className:r,children:[e.jsx("div",{className:"space-y-18",children:a.map((o,m)=>e.jsx(Z,{event:o},m))}),(c=i==null?void 0:i.context)!=null&&c.error?e.jsxs("div",{className:"mt-24 flex items-center gap-12",children:[e.jsx(j,{variant:"flat",color:"primary",onClick:()=>s(),children:e.jsx(t,{message:"Retry"})}),e.jsx(j,{variant:"outline",color:"primary",endIcon:e.jsx(R,{}),children:e.jsx(t,{message:"Update manually"})})]}):null,(i==null?void 0:i.step)===h.Finalizing&&(i==null?void 0:i.status)===b.Completed?e.jsx("div",{className:"mt-24 text-muted",children:e.jsx(t,{message:"Module installed successfully! Reloading the page..."})}):null]})}async function se({code:s,form:r,itemId:a,moduleName:n}){try{return(await Q.post("license/register-purchase-code",{purchase_code:s,item_id:a,module:n})).data.purchase_code}catch(i){ge(i,r)}}function Le({tabs:s,title:r}){const{data:a}=v(),n=C({defaultValues:{server:{sentry_dsn:a.server.sentry_dsn??""}}});return e.jsx(D,{form:n,title:r,tabs:s,children:e.jsx(Qe,{})})}function Qe(){const{clearErrors:s}=I();return e.jsx(w,{title:e.jsx(t,{message:"Sentry Integration"}),description:e.jsx(t,{values:{a:r=>e.jsx(je,{href:"https://sentry.io",children:r})},message:"<a>Sentry</a> integration provides real-time error tracking and helps identify and fix issues when site is in production."}),link:_.settings.logging?e.jsx(E,{link:_.settings.logging}):null,children:e.jsx(M,{separatorTop:!1,separatorBottom:!1,name:"logging_group",children:r=>e.jsx(u,{size:"sm",onChange:()=>s(),invalid:r,name:"server.sentry_dsn",type:"url",minLength:30,label:e.jsx(t,{message:"Sentry DSN"})})})})}function Be(){const{site:s}=O();return ce({queryKey:["queue-stats"],queryFn:()=>s.demo?Promise.resolve({status:"running"}):Oe(),refetchInterval:5e3})}function Oe(){return Q.get("horizon/api/stats").then(s=>s.data)}function Ve({tabs:s,title:r}){const{data:a}=v(),n=C({defaultValues:{server:{queue_connection:a.server.queue_connection??"sync",aws_access_key_id:a.server.aws_access_key_id??"",aws_secret_access_key:a.server.aws_secret_access_key??"",sqs_prefix:a.server.sqs_prefix??"",sqs_queue:a.server.sqs_queue??"",aws_default_region:a.server.aws_default_region??""}}}),i=n.watch("server.queue_connection");return e.jsxs(D,{form:n,title:r,tabs:s,children:[e.jsx(We,{}),i!=="sync"&&e.jsx(He,{})]})}function We(){const{watch:s,clearErrors:r}=I(),a=s("server.queue_connection");let n=null;return a==="sqs"&&(n=$e),e.jsx(w,{className:"mb-24",title:e.jsx(t,{message:"Queue Method"}),description:e.jsx(t,{message:"Queues allow deferring time-consuming tasks, such as sending emails, until a later time."}),link:_.settings.queue?e.jsx(E,{link:_.settings.queue}):void 0,children:e.jsx(M,{separatorTop:!1,separatorBottom:!1,name:"queue_group",children:i=>e.jsxs(l.Fragment,{children:[e.jsxs(U,{size:"sm",invalid:i,onSelectionChange:()=>{r()},selectionMode:"single",name:"server.queue_connection",required:!0,children:[e.jsx(p,{value:"sync",children:e.jsx(t,{message:"None (Default)"})}),e.jsx(p,{value:"beanstalkd",children:"Beanstalkd"}),e.jsx(p,{value:"database",children:e.jsx(t,{message:"Database"})}),e.jsx(p,{value:"sqs",children:e.jsx(t,{message:"SQS (Amazon simple queue service)"})}),e.jsx(p,{value:"redis",children:"Redis"})]}),n&&e.jsx("div",{className:"mt-20",children:e.jsx(n,{isInvalid:i})})]})})})}function He(){const{base_url:s}=O(),{data:r,status:a}=Be(),n=a!=="pending"&&(r==null?void 0:r.status)==="running";return e.jsx(w,{title:e.jsx(t,{message:"Queue Status"}),description:e.jsx(t,{message:"Monitor the current status of your queue and access the queue dashboard."}),children:e.jsx("div",{className:"flex items-center gap-14",children:n?e.jsxs(l.Fragment,{children:[e.jsxs("div",{className:"min-w-108 flex w-max items-center gap-8 rounded-button bg-positive-lighter px-10 py-4 text-sm capitalize",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-positive"}),e.jsx(t,{message:"Worker is running"})]}),e.jsx(j,{variant:"outline",size:"xs",elementType:"a",href:`${s}/horizon`,target:"_blank",endIcon:e.jsx(R,{}),children:e.jsx(t,{message:"Monitor"})})]}):e.jsx(Ge,{})})})}function Ge(){return e.jsx(J,{leadingIcon:e.jsx(le,{size:"xs",className:"text-danger"}),title:e.jsx(t,{message:"Queue worker is inactive"}),description:e.jsx(t,{message:"The queue worker is not running. Please start the worker or set queue driver to 'none', otherwise some features will not work properly."}),color:"danger"})}function $e({isInvalid:s}){return e.jsxs(l.Fragment,{children:[e.jsx(u,{size:"sm",invalid:s,className:"mb-20",name:"server.aws_access_key_id",label:e.jsx(t,{message:"SQS queue key"}),required:!0}),e.jsx(u,{size:"sm",invalid:s,className:"mb-20",name:"server.aws_secret_access_key",label:e.jsx(t,{message:"SQS queue secret"}),required:!0}),e.jsx(u,{size:"sm",invalid:s,className:"mb-20",name:"server.sqs_prefix",label:e.jsx(t,{message:"SQS queue prefix"}),required:!0}),e.jsx(u,{size:"sm",invalid:s,className:"mb-20",name:"server.sqs_queue",label:e.jsx(t,{message:"SQS queue name"}),required:!0}),e.jsx(u,{size:"sm",invalid:s,name:"server.aws_default_region",label:e.jsx(t,{message:"SQS queue region"}),required:!0})]})}function Xe(s){return e.jsx(ee,{children:e.jsx(Je,{...s})})}function Je({tabs:s,title:r,rightContent:a}){const{updateStarted:n}=l.use(q),i=n?e.jsx(Ye,{}):e.jsx(Ke,{});return e.jsxs("div",{className:"dashboard-grid-content dashboard-rounded-panel flex h-full flex-col",children:[e.jsx(K,{title:r,showSidebarToggleButton:!0,border:"border-none",rightContent:a}),s,e.jsx("div",{className:"overflow-y-auto",children:e.jsx("div",{className:"mx-auto p-12 @container/settings-form md:p-24 lg:max-w-[1440px]",children:i})})]})}function re({children:s}){const{data:r}=v(),a=!(r!=null&&r.update_available);return e.jsxs("div",{className:"rounded-panel border p-24 shadow-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(ve,{size:"lg"}),e.jsx("h1",{className:"mb-4 mt-12 text-xl font-semibold",children:a?e.jsx(t,{message:"You already have the latest version installed"}):e.jsx(t,{message:"System update"})}),e.jsx("p",{className:"text-muted",children:e.jsx(t,{message:"Update your system to the latest version. This will download and install updates automatically, please do not close this page while update is in progress."})})]}),e.jsx("div",{className:"mt-24",children:s})]})}function Ke(){var n;const{updateAppAndModules:s}=l.use(q),{data:r}=v(),a=!(r!=null&&r.update_available);return e.jsx(re,{children:e.jsx("div",{className:"w-full text-center",children:e.jsx(j,{variant:"flat",color:"primary",onClick:async()=>{await s()&&setTimeout(()=>{window.location.href="/admin/settings"},1e3)},children:a?e.jsx(t,{message:"Re-install version :version",values:{version:(n=r==null?void 0:r.server)==null?void 0:n.app_version}}):e.jsx(t,{message:"Start Update"})})})})}function Ye(){var o;const{events:s,updateInProgress:r,updateAppAndModules:a,moduleNames:n,activeModuleName:i}=l.use(q),c=s.at(-1);return e.jsxs("div",{children:[e.jsx(Y,{shouldBlock:r}),e.jsx(re,{children:e.jsxs("div",{className:"border-t border-t-divider-lighter pt-24",children:[n!=null&&n.length&&i?e.jsxs("div",{className:"mb-20 font-semibold",children:[e.jsx(t,{message:"Updating"}),":"," ",e.jsx(Ze,{name:i})]}):null,e.jsx("div",{className:"space-y-18",children:s.map((m,f)=>e.jsx(Z,{event:m},f))}),(o=c==null?void 0:c.context)!=null&&o.error?e.jsxs("div",{className:"mt-24 flex items-center gap-12",children:[e.jsx(j,{variant:"flat",color:"primary",onClick:()=>a(),children:e.jsx(t,{message:"Retry"})}),e.jsx(j,{variant:"outline",color:"primary",href:_.manualUpdate,target:"_blank",endIcon:e.jsx(R,{}),children:e.jsx(t,{message:"Update manually"})})]}):null,(c==null?void 0:c.step)===h.Finalizing&&(c==null?void 0:c.status)===b.Completed?e.jsxs("div",{className:"mt-24",children:[e.jsx("div",{className:"mb-12 text-muted",children:e.jsx(t,{message:"Update completed successfully! Reloading the page..."})}),e.jsx(j,{variant:"flat",color:"primary",elementType:de,to:"/admin",children:e.jsx(t,{message:"Return to admin area"})})]}):null]})})]})}function Ze({name:s}){var a,n;const{data:r}=v();return s==="app"?e.jsx(t,{message:"Application"}):e.jsx("span",{children:((n=(a=r.modules)==null?void 0:a[s])==null?void 0:n.label)??fe(s)})}function es({tabs:s,title:r}){const{data:a}=v(),n=C({defaultValues:{server:{broadcast_connection:a.server.broadcast_connection??"null",pusher_app_id:a.server.pusher_app_id??"",pusher_app_key:a.server.pusher_app_key??"",pusher_app_secret:a.server.pusher_app_secret??"",pusher_app_cluster:a.server.pusher_app_cluster??"",reverb_app_id:a.server.reverb_app_id??"",reverb_app_key:a.server.reverb_app_key??"",reverb_app_secret:a.server.reverb_app_secret??"",reverb_host:a.server.reverb_host??"",reverb_port:a.server.reverb_port??"",reverb_scheme:a.server.reverb_scheme??"https",ably_key:a.server.ably_key??""}}});return e.jsx(D,{form:n,title:r,tabs:s,children:e.jsx(ss,{})})}function ss(){const{clearErrors:s,control:r}=I(),a=ue({control:r,name:"server.broadcast_connection"});let n=null;return a==="pusher"?n=rs:a==="ably"?n=as:a==="reverb"&&(n=ts),e.jsx(w,{className:"mb-24",title:e.jsx(t,{message:"Websockets Provider"}),description:e.jsx(t,{message:"Configure websockets provider responsible for all realtime functionality on the site."}),link:_.settings.websockets?e.jsx(E,{link:_.settings.websockets,children:e.jsx(t,{message:"What are websockets?"})}):null,children:e.jsx(M,{separatorTop:!1,separatorBottom:!1,name:"websockets_group",children:i=>e.jsxs(l.Fragment,{children:[e.jsxs(U,{size:"sm",invalid:i,onSelectionChange:()=>s(),selectionMode:"single",name:"server.broadcast_connection",required:!0,children:[e.jsx(p,{value:"null",children:e.jsx(t,{message:"None (Disabled)"})}),e.jsx(p,{value:"reverb",children:"Local (Laravel Reverb)"}),e.jsx(p,{value:"pusher",children:"Pusher"}),e.jsx(p,{value:"ably",children:e.jsx(t,{message:"Ably"})})]}),n&&e.jsx("div",{className:"mt-30",children:e.jsx(n,{isInvalid:i})})]})})})}function rs({isInvalid:s}){return e.jsxs(l.Fragment,{children:[e.jsx(u,{size:"sm",name:"server.pusher_app_id",label:e.jsx(t,{message:"Pusher app ID"}),className:"mb-20",required:!0}),e.jsx(u,{size:"sm",name:"server.pusher_app_key",label:e.jsx(t,{message:"Pusher app key"}),className:"mb-20",required:!0}),e.jsx(u,{size:"sm",name:"server.pusher_app_secret",label:e.jsx(t,{message:"Pusher app secret"}),className:"mb-20",required:!0}),e.jsx(u,{size:"sm",name:"server.pusher_app_cluster",label:e.jsx(t,{message:"Pusher app cluster"}),className:"mb-20",placeholder:"mt1",required:!0})]})}function as({isInvalid:s}){return e.jsx(l.Fragment,{children:e.jsx(u,{size:"sm",name:"server.ably_key",label:e.jsx(t,{message:"Ably API key"}),className:"mb-20",required:!0})})}function ts({isInvalid:s}){return e.jsxs(l.Fragment,{children:[e.jsx(u,{size:"sm",name:"server.reverb_host",label:e.jsx(t,{message:"Reverb host"}),className:"mb-20",required:!0}),e.jsx(u,{size:"sm",name:"server.reverb_port",label:e.jsx(t,{message:"Reverb port"}),className:"mb-20",required:!0}),e.jsxs(U,{size:"sm",name:"server.reverb_scheme",label:e.jsx(t,{message:"Reverb scheme"}),className:"mb-20",required:!0,children:[e.jsx(p,{value:"http",children:"HTTP"}),e.jsx(p,{value:"https",children:"HTTPS"})]})]})}const ns=[{name:"license",label:g("License")},{name:"updates",label:g("Updates")},{name:"cache",label:g("Cache")},{name:"queue",label:g("Queue")},{name:"logging",label:g("Logging")},{name:"websockets",label:g("Websockets")}];function Gs(){const{websockets:s}=O(),[r,a]=me(),n=l.useMemo(()=>ns.filter(o=>o.name!=="websockets"||(s==null?void 0:s.integrated)),[s]),i=r.get("tab")??"license",c=n.findIndex(o=>o.name===i)??0;return e.jsx(l.Fragment,{children:e.jsx(is,{tabName:i,tabs:e.jsx(be,{selectedTab:c,onTabChange:o=>{const m=n[o];a({tab:m.name},{replace:!0})},children:e.jsx(_e,{className:"mx-24",children:n.map(o=>e.jsx(ye,{children:e.jsx(t,{...o.label})},o.name))})})})})}function is({tabName:s,tabs:r}){const{data:a}=v(),n=e.jsx(t,{message:"System"}),i=e.jsx(B,{size:"sm",fontWeight:"font-semibold",children:a.server.app_version});switch(s){case"cache":return e.jsx(Se,{tabs:r,title:n});case"queue":return e.jsx(Ve,{tabs:r,title:n});case"logging":return e.jsx(Le,{tabs:r,title:n});case"websockets":return e.jsx(es,{tabs:r,title:n});case"license":return e.jsx(Me,{tabs:r,title:n,rightContent:i});case"updates":return e.jsx(Xe,{tabs:r,title:n,rightContent:i})}}export{Gs as Component};
