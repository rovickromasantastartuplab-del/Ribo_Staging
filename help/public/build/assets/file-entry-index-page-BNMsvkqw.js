import{m as a,b1 as d,b2 as p,r as u,aZ as b,j as e,T as s,av as h,B as j,aQ as w,as as D,D as v,aj as k,al as S,i as F,s as T,k as E,q as P,t as C}from"./client-DtfdVV77.js";import{A as I}from"./admin-config-DXsixO44.js";import{i as N,j as _,I as A,c as f}from"./main-BGmGAxtx.js";import{D as L}from"./settings-links-CRsxvJIZ.js";import{G as q}from"./global-loading-progress-DVC8NxPo.js";import{D as R}from"./data-table-header-CdCZHch7.js";import{D as V}from"./data-table-pagination-footer-B4yyc06A.js";import{u as B}from"./use-datatable-search-params-dzq5X78n.js";import{D as U}from"./datatable-filters-KJfH8nG0.js";import{a as z,D as H,b as M,c as W}from"./datatable-page-with-header-layout-xcCtlWaX.js";import{u as O}from"./use-datatable-query-v3pOHYke.js";import{T as Q}from"./table-CynOKbaN.js";import{F as G}from"./file-preview-dialog-BrkfZ0k6.js";import{F as K}from"./file-type-icon-CNIGAaMG.js";import{F as Y}from"./formatted-bytes-CFeeP1Iy.js";import{V as X}from"./Visibility-BlnkCOzB.js";import{C as Z}from"./confirmation-dialog-BzXs9ksK.js";import{a as $}from"./name-with-avatar-D8NZSkGp.js";import{D as J}from"./data-table-emty-state-message-DsPxSC6g.js";import"./dashboard-icons-BJ4c3Z5i.js";import"./library-icon-h4d3s9Ef.js";import"./messages-square-icon-D_3IR-rK.js";import"./Delete-DWP7kvj0.js";import"./Home-iO0iebLw.js";import"./SupervisorAccount-Bkn2ibMi.js";import"./Translate-DPB2wdvD.js";import"./TextFields-CM1xUWDR.js";import"./custom-menu-Dvq-fOnC.js";import"./external-link-Cxcw6nc_.js";import"./book-open-D91H26Dq.js";import"./FilterAlt-CRhKT7zD.js";import"./select-filter-panel-hjhYEdoY.js";import"./form-chip-field-C7l8nGPv.js";import"./chip-list-DHXDGW6X.js";import"./filter-operator-names-BbrFb9i0.js";import"./select-D9niWe2H.js";import"./combobox-end-adornment-CWQ4Xgal.js";import"./normalized-model-field-D3Ui05eZ.js";import"./Edit-BaEHOLuK.js";import"./skeleton-D178v0-U.js";import"./accordion-Dmxnze9z.js";import"./accordtion-animation-BGCK95Hj.js";import"./checkbox-CS7ILu6P.js";import"./CheckBoxOutlineBlank-DU0ZdwTb.js";import"./formatted-number-CIAFur2S.js";import"./use-toggle-dashboard-left-sidebar-DxaOS7gK.js";import"./toggle-left-sidebar-icon-j-5uTef5.js";import"./ArrowDownward-DHtsWMyK.js";import"./useEffectEvent-Offmqu_S.js";import"./is-ctrl-key-pressed-CaS-AM38.js";import"./useGlobalListeners-BGMP113F.js";import"./file-thumbnail-DlIWt16b.js";import"./ChevronLeft-IHWIEiah.js";import"./ChevronRight-C5OrfRtB.js";import"./FileDownload-DjsfzW8M.js";import"./download-file-from-url-hJ3EUwXO.js";import"./pretty-bytes-bO14ePu9.js";const ee={key:"type",label:a("Type"),description:a("Type of the file"),defaultOperator:p.eq,control:{type:d.Select,defaultValue:"05",options:[{key:"02",label:a("Text"),value:"text"},{key:"03",label:a("Audio"),value:"audio"},{key:"04",label:a("Video"),value:"video"},{key:"05",label:a("Image"),value:"image"},{key:"06",label:a("PDF"),value:"pdf"},{key:"07",label:a("Spreadsheet"),value:"spreadsheet"},{key:"08",label:a("Word Document"),value:"word"},{key:"09",label:a("Photoshop"),value:"photoshop"},{key:"10",label:a("Archive"),value:"archive"},{key:"11",label:a("Folder"),value:"folder"}]}},c=[ee,{key:"public",label:a("Visibility"),description:a("Whether file is publicly accessible"),defaultOperator:p.eq,control:{type:d.Select,defaultValue:"01",options:[{key:"01",label:a("Private"),value:!1},{key:"02",label:a("Public"),value:!0}]}},N({description:a("Date file was uploaded")}),_({description:a("Date file was last changed")}),{key:"owner_id",label:a("Uploader"),description:a("User that this file was uploaded by"),defaultOperator:p.eq,control:{type:d.SelectModel,model:A}}],te=""+new URL("upload-DtVE1GoK.svg",import.meta.url).href,ae=[{key:"name",allowsSorting:!0,visibleInMode:"all",width:"flex-3 min-w-200",header:()=>e.jsx(s,{message:"Name"}),body:t=>e.jsxs(u.Fragment,{children:[e.jsx("div",{className:"overflow-x-hidden overflow-ellipsis",children:t.name}),e.jsx("div",{className:"overflow-x-hidden overflow-ellipsis text-xs text-muted",children:t.file_name})]})},{key:"owner_id",allowsSorting:!0,width:"flex-3 min-w-200",header:()=>e.jsx(s,{message:"Uploader"}),body:t=>{var o,r;const i=((o=t.users)==null?void 0:o.find(l=>l.owns_entry))??((r=t.users)==null?void 0:r[0]);return i?e.jsx($,{image:i.image,label:i.name,description:i.email}):null}},{key:"type",width:"w-100 flex-shrink-0",allowsSorting:!0,header:()=>e.jsx(s,{message:"Type"}),body:t=>e.jsxs("div",{className:"flex items-center gap-12",children:[e.jsx(K,{type:t.type,className:"h-24 w-24 overflow-hidden"}),e.jsx("div",{className:"capitalize",children:t.type})]})},{key:"public",allowsSorting:!0,width:"w-60 flex-shrink-0",header:()=>e.jsx(s,{message:"Public"}),body:t=>t.public?e.jsx(w,{className:"text-positive icon-md"}):e.jsx(D,{className:"text-danger icon-md"})},{key:"file_size",allowsSorting:!0,maxWidth:"max-w-100",header:()=>e.jsx(s,{message:"File size"}),body:t=>e.jsx(Y,{bytes:t.file_size})},{key:"updated_at",allowsSorting:!0,width:"w-100",header:()=>e.jsx(s,{message:"Last updated"}),body:t=>e.jsx(v,{date:t.updated_at})},{key:"actions",header:()=>e.jsx(s,{message:"Actions"}),hideHeader:!0,align:"end",width:"w-42 flex-shrink-0",visibleInMode:"all",body:t=>e.jsxs(h,{type:"modal",children:[e.jsx(k,{size:"md",className:"text-muted",children:e.jsx(X,{})}),e.jsx(G,{entries:[t]})]})}];function lt(){const[t,i]=u.useState([]),{searchParams:o,sortDescriptor:r,mergeIntoSearchParams:l,setSearchQuery:g,isFiltering:x}=B(b),n=O(f.fileEntries.index(o)),y=e.jsxs(h,{type:"modal",children:[e.jsx(j,{variant:"flat",color:"danger",children:e.jsx(s,{message:"Delete"})}),e.jsx(se,{selectedIds:t,onDelete:()=>i([])})]});return e.jsxs(z,{children:[e.jsx(q,{query:n}),e.jsx(H,{title:e.jsx(s,{message:"Uploaded files and folders"}),showSidebarToggleButton:!0,rightContent:e.jsx(L,{variant:"button",link:I.pages.files,size:"xs"})}),e.jsxs(M,{children:[e.jsx(R,{searchValue:o.query,onSearchChange:g,selectedItems:t,selectedActions:y,filters:c}),e.jsx(U,{filters:c}),e.jsxs(W,{children:[e.jsx(Q,{columns:ae,data:n.items,sortDescriptor:r,onSortChange:l,enableSelection:!0,selectedRows:t,onSelectionChange:i}),n.isEmpty&&e.jsx(J,{isFiltering:x,image:te,title:e.jsx(s,{message:"Nothing has been uploaded yet"}),filteringTitle:e.jsx(s,{message:"No matching files or folders"})}),e.jsx(V,{query:n,onPageChange:m=>l({page:m}),onPerPageChange:m=>l({perPage:m})})]})]})]})}function se({selectedIds:t,onDelete:i}){const{close:o}=S(),r=F({mutationFn:()=>E.delete(`file-entries/${t.join(",")}`),onSuccess:async()=>{await P.invalidateQueries({queryKey:f.fileEntries.invalidateKey}),C(a("File entries deleted")),i(),o()},onError:l=>T(l)});return e.jsx(Z,{isDanger:!0,isLoading:r.isPending,title:e.jsx(s,{message:"Delete file entries"}),body:e.jsx(s,{message:"Are you sure you want to delete selected file entries?",values:{count:t.length}}),confirm:e.jsx(s,{message:"Delete"}),onConfirm:()=>r.mutate()})}export{lt as Component};
