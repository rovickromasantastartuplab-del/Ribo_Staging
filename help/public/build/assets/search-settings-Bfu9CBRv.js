import{ac as g,i as j,s as f,t as v,m as S,k as h,X as _,d as b,j as e,T as s,f as l,r as n,az as a,B as M,F as c}from"./client-DtfdVV77.js";import{A as d}from"./admin-config-DXsixO44.js";import{S as y}from"./settings-error-group-BnQc3270.js";import{A as F}from"./settings-layout-FQP6W4_q.js";import{D as w}from"./settings-links-CRsxvJIZ.js";import{S as u}from"./settings-panel-gMfbp8IE.js";import{u as q}from"./use-admin-settings-DArjpbC9.js";import{S as A}from"./section-helper-BcMoHesA.js";import{F as p,S as D}from"./select-D9niWe2H.js";import"./dashboard-icons-BJ4c3Z5i.js";import"./library-icon-h4d3s9Ef.js";import"./messages-square-icon-D_3IR-rK.js";import"./main-BGmGAxtx.js";import"./custom-menu-Dvq-fOnC.js";import"./Delete-DWP7kvj0.js";import"./Home-iO0iebLw.js";import"./SupervisorAccount-Bkn2ibMi.js";import"./Translate-DPB2wdvD.js";import"./TextFields-CM1xUWDR.js";import"./use-admin-settings-page-nav-config-D58KRD8y.js";import"./datatable-page-with-header-layout-xcCtlWaX.js";import"./use-toggle-dashboard-left-sidebar-DxaOS7gK.js";import"./toggle-left-sidebar-icon-j-5uTef5.js";import"./file-upload-provider-B4w-VsYu.js";import"./uploaded-file-DOXWsty7.js";import"./pretty-bytes-bO14ePu9.js";import"./with-selector-DPNnjGhI.js";import"./useMutationState-Bmyxea6H.js";import"./blocker-dialog-B0Vc-LIE.js";import"./confirmation-dialog-BzXs9ksK.js";import"./external-link-Cxcw6nc_.js";import"./book-open-D91H26Dq.js";import"./useSuspenseQuery-Bmt2-NKx.js";import"./combobox-end-adornment-CWQ4Xgal.js";function N(){const{trans:r}=g();return j({mutationFn:t=>k(t),onSuccess:()=>{v(r(S("Imported search models")))},onError:t=>f(t)})}function k(r){return h.post("admin/search/import",r).then(t=>t.data)}function E(){return _({queryKey:["search-models"],queryFn:()=>T()})}function T(){return h.get("admin/search/models").then(r=>r.data)}function ve(){const{data:r}=q(),t=b({defaultValues:{server:{scout_driver:r.server.scout_driver??"mysql",scout_mysql_mode:r.server.scout_mysql_mode??"basic",algolia_app_id:r.server.algolia_app_id??"",algolia_secret:r.server.algolia_secret??""}}});return e.jsxs(F,{form:t,title:e.jsx(s,{message:"Search"}),children:[e.jsx(z,{}),e.jsx(R,{})]})}function z(){const{watch:r}=l(),t=r("server.scout_driver");return e.jsx(u,{className:"mb-24",title:e.jsx(s,{message:"Search Method"}),description:e.jsx("div",{children:e.jsx(s,{message:"Configure which search method should be used for search functionality across your site."})}),link:d.settings.search?e.jsx(w,{link:d.settings.search,children:e.jsx(s,{message:"What's the difference between the search methods?"})}):null,children:e.jsx(y,{name:"search_group",separatorBottom:!1,separatorTop:!1,children:i=>e.jsxs(n.Fragment,{children:[e.jsxs(p,{size:"sm",invalid:i,name:"server.scout_driver",selectionMode:"single",label:e.jsx(s,{message:"Search method"}),children:[e.jsx(a,{value:"mysql",children:"Database (Default)"}),e.jsx(a,{value:"meilisearch",children:"Meilisearch (Recommended)"}),e.jsx(a,{value:"tntsearch",children:"TNTSearch"}),e.jsx(a,{value:"algolia",children:"Algolia"})]}),t==="mysql"&&e.jsx(C,{}),t==="meilisearch"&&e.jsx(I,{}),t==="algolia"&&e.jsx(B,{})]})})})}function C(){const{clearErrors:r}=l();return e.jsxs(p,{size:"sm",className:"mt-24",name:"server.scout_mysql_mode",selectionMode:"single",label:e.jsx(s,{message:"Database search mode"}),onSelectionChange:()=>{r()},children:[e.jsx(a,{value:"basic",children:e.jsx(s,{message:"Basic"})}),e.jsx(a,{value:"extended",children:e.jsx(s,{message:"Extended"})}),e.jsx(a,{value:"fulltext",children:e.jsx(s,{message:"Fulltext"})})]})}function I(){return e.jsx(A,{className:"mt-24",color:"warning",description:e.jsx(s,{message:"<a>Meilisearch</a> needs to be installed and running for this method to work.",values:{a:r=>e.jsx("a",{href:"https://www.meilisearch.com",target:"_blank",rel:"noreferrer",children:r})}})})}function B(){return e.jsxs(n.Fragment,{children:[e.jsx(c,{size:"sm",className:"mt-24",name:"server.algolia_app_id",label:e.jsx(s,{message:"Algolia app ID"}),required:!0}),e.jsx(c,{size:"sm",className:"mt-24",name:"server.algolia_secret",label:e.jsx(s,{message:"Algolia app secret"}),required:!0})]})}function R(){const{getValues:r}=l(),{data:t}=E(),i=N(),[m,x]=n.useState("*");return e.jsxs(u,{className:"mb-24",title:e.jsx(s,{message:"Import Records"}),description:e.jsxs(n.Fragment,{children:[e.jsx("p",{children:e.jsx(s,{message:"After changing search method, database records need to be imported into the search index."})}),e.jsx("p",{className:"mt-6",children:e.jsx(s,{message:"Depending on number of records in database, importing could take some time. Don't close this window while it is in progress."})})]}),children:[e.jsxs(D,{size:"sm",selectionMode:"single",label:e.jsx(s,{message:"What to import?"}),selectedValue:m,onSelectionChange:o=>{x(o)},children:[e.jsx(a,{value:"*",children:e.jsx(s,{message:"Everything"})}),t==null?void 0:t.models.map(o=>e.jsx(a,{value:o.model,children:e.jsx(s,{message:o.name})},o.model))]}),e.jsx(M,{size:"sm",variant:"flat",color:"primary",className:"mt-12",disabled:i.isPending,onClick:()=>{i.mutate({model:m,driver:r("server.scout_driver")})},children:e.jsx(s,{message:"Import now"})})]})}export{ve as Component};
