import{i as l,q as u,l as m,t as p,m as x,k as h,d as g,al as j,j as e,am as v,an as f,T as t,ap as P,aP as y,F as b,aq as C,B as i,X as S,r as F,av as I,p as w,D as A,P as N,u as D}from"./client-DtfdVV77.js";import{o as E,I as k}from"./custom-menu-Dvq-fOnC.js";import{u as T}from"./use-sync-envato-purchases-Xqd4DBys.js";import{A as _,b as B}from"./account-settings-sidenav-DNNZzcwO.js";import{J as M}from"./main-BGmGAxtx.js";import{E as d}from"./envato-DSHUfLey.js";import{AccountSettingsPage as Q}from"./account-settings-page-8Iecw1V2.js";import"./use-all-social-logins-disabled-aPb5okc5.js";import"./PhonelinkLock-6ejR1HhJ.js";import"./Lock-Dv_tThfr.js";import"./Login-DTH0heiT.js";import"./two-factor-panel-L-TLfnGY.js";import"./Tablet-DFnu-M6b.js";import"./google-4IXOtUqo.js";import"./use-social-login-BVUj2tXy.js";import"./skeleton-D178v0-U.js";import"./access-token-panel-Dpv4BFFl.js";import"./external-link-Cxcw6nc_.js";import"./confirmation-dialog-BzXs9ksK.js";import"./use-clipboard-Jb2pyXiK.js";import"./image-selector-fVyS7PG4.js";import"./file-upload-provider-B4w-VsYu.js";import"./uploaded-file-DOXWsty7.js";import"./pretty-bytes-bO14ePu9.js";import"./with-selector-DPNnjGhI.js";import"./use-active-upload-CGOT7g6R.js";import"./open-upload-window-DE9Q8gNs.js";import"./shallow-BH2jDtXM.js";import"./AddAPhoto-Bl3FQpaJ.js";import"./progress-bar-BMzArYUQ.js";import"./file-input-config-DrcTpI3-.js";import"./AlternateEmail-JgjChVK8.js";import"./update-account-details-D_xesbEZ.js";import"./localization-panel-CgLWzJt1.js";import"./combobox-CFh39yI7.js";import"./combobox-end-adornment-CWQ4Xgal.js";import"./select-D9niWe2H.js";function q(r){return l({mutationFn:s=>H(s),onSuccess:async()=>{await u.invalidateQueries({queryKey:m.envato.invalidateKey}),p(x("Purchase added"))},onError:s=>E(s,r)})}function H(r){return h.post(`users/${r.userId}/envato/add-purchase-using-code`,r).then(s=>s.data)}function K({userId:r}){const s=g(),a=q(s),{close:o,formId:n}=j();return e.jsxs(v,{children:[e.jsx(f,{children:e.jsx(t,{message:"Add purchase code"})}),e.jsx(P,{children:e.jsx(y,{id:n,form:s,onSubmit:c=>a.mutate({userId:r,purchaseCode:c.purchaseCode},{onSuccess:()=>o()}),children:e.jsx(b,{name:"purchaseCode",label:e.jsx(t,{message:"Purchase code"}),autoFocus:!0})})}),e.jsxs(C,{children:[e.jsx(i,{variant:"outline",onClick:()=>o(),children:e.jsx(t,{message:"Close"})}),e.jsx(i,{variant:"flat",color:"primary",type:"submit",form:n,disabled:a.isPending,children:e.jsx(t,{message:"Add"})})]})]})}function Y({user:r}){const s=S(m.envato.userPurchases(r.id)),a=T();return e.jsx(_,{id:"purchases",title:e.jsx(t,{message:"Your purchases"}),actions:e.jsxs(F.Fragment,{children:[e.jsxs(I,{type:"modal",children:[e.jsx(i,{variant:"outline",className:"mr-12",children:e.jsx(t,{message:"Add purchase code"})}),e.jsx(K,{userId:"me"})]}),e.jsx(i,{variant:"flat",color:"primary",onClick:()=>a.mutate({userId:"me"}),disabled:a.isPending,children:e.jsx(t,{message:"Import purchases from envato"})})]}),children:e.jsx(z,{query:s})})}function z({query:r}){return r.data?r.data.purchases.length?e.jsx("div",{children:r.data.purchases.map(s=>e.jsxs("div",{className:"relative flex items-center gap-12 rounded py-10 hover:bg-hover",children:[e.jsx("img",{src:s.image,alt:"",className:"h-64 w-64 rounded"}),e.jsxs("div",{className:"min-w-0 text-sm",children:[e.jsxs("a",{href:s.url,target:"_blank",rel:"noreferrer",className:"overflow-hidden overflow-ellipsis whitespace-nowrap font-semibold",children:[e.jsx("span",{className:"absolute inset-0 rounded"}),s.item_name]}),e.jsx("div",{className:"my-4 text-xs",children:e.jsx(t,{message:"Purchase code: :code",values:{code:s.code}})}),e.jsx("div",{className:w("text-xs text-muted",s.support_expired&&"line-through"),children:s.supported_until?e.jsxs("span",{children:[e.jsx(t,{message:"Supported until:"})," ",e.jsx(A,{date:s.supported_until})]}):e.jsx(t,{message:"Support expired"})})]})]},s.id))}):e.jsx("div",{children:e.jsx(k,{size:"sm",imageHeight:"h-auto",title:e.jsx(t,{message:"Could not find any purchases"}),description:e.jsx(t,{message:"Try importing purchases from envato with the button below."}),imageMargin:"mb-10",image:e.jsx("div",{children:e.jsx(d,{viewBox:"0 0 50 50",className:"text-envato"})})})}):r.isLoading?e.jsx("div",{className:"flex min-h-82 items-center justify-center",children:e.jsx(N,{isIndeterminate:!0})}):e.jsx(M,{})}function Ie(){const{envato:r}=D(),s=r==null?void 0:r.enable;return e.jsx(Q,{panels:s?a=>e.jsx(Y,{user:a}):void 0,sidenavItems:s?e.jsx(B,{icon:e.jsx(d,{}),panel:"purchases",children:e.jsx(t,{message:"Your purchases"})}):null})}export{Ie as Component};
