import{Z as W,j as e,$ as X,r as n,a0 as Y,a1 as _,p as u,a9 as U,B as v,T as x,t as B,ar as D,aj as ee}from"./client-DtfdVV77.js";import{r as se}from"./file-upload-provider-B4w-VsYu.js";import{u as le}from"./use-active-upload-CGOT7g6R.js";import{A as re}from"./AddAPhoto-Bl3FQpaJ.js";import{P as ae}from"./progress-bar-BMzArYUQ.js";import{F as ie}from"./file-input-config-DrcTpI3-.js";function te({className:o,label:r,description:i,descriptionPosition:l="top",value:c,onChange:s,defaultValue:a,uploadMetadata:d,showRemoveButton:m,showEditButtonOnHover:f=!1,invalid:p,errorMessage:R,required:S,autoFocus:q,variant:z="input",previewSize:T="h-80",placeholderIcon:O,stretchPreview:V=!1,previewRadius:L,disabled:g,uploadType:F,onFileSelected:h}){const{uploadFile:M,entry:N,uploadStatus:y,deleteEntry:Z,isDeletingEntry:C,percentage:G}=le(),E=n.useRef(null);Y({autoFocus:q},E);const $=n.useId(),k=r?`${$}-label`:void 0,A=i?`${$}-description`:void 0,I=c||(N==null?void 0:N.url),H={uploadType:F,showToastOnRestrictionFail:!0,restrictions:se({uploadType:F}),metadata:{...d},onSuccess:t=>{s==null||s(t.url,t)},onError:t=>{t&&B.danger(t)}},b=_({description:i,descriptionPosition:l,invalid:p});let j;z==="avatar"?j=ce:z==="square"?j=oe:j=ne;const J=m?e.jsx(v,{variant:"link",color:"danger",size:"xs",disabled:C||!I||g,onClick:()=>{Z({onSuccess:()=>s==null?void 0:s("")})},children:e.jsx(x,{message:"Remove image"})}):null,K=a!=null&&c!==a?e.jsx(v,{variant:"outline",color:"primary",size:"xs",disabled:g,onClick:()=>{s==null||s(a)},children:e.jsx(x,{message:"Use default"})}):null,Q=n.useCallback(()=>{var t;(t=E.current)==null||t.click()},[]),P=i?e.jsx("div",{className:b.description,children:i}):null;return e.jsxs("div",{className:u("text-sm",o),children:[r&&e.jsx("div",{id:k,className:b.label,children:r}),l==="top"&&P,e.jsx("div",{"aria-labelledby":k,"aria-describedby":A,children:e.jsxs(U,{fieldClassNames:b,errorMessage:R,invalid:p,children:[e.jsx(j,{inputFieldClassNames:b,placeholderIcon:O,previewSize:T,isLoading:y==="inProgress",imageUrl:I,removeButton:J,useDefaultButton:K,showEditButtonOnHover:f,stretchPreview:V,previewRadius:L,handleUpload:Q,disabled:g,children:e.jsx("input",{ref:E,"aria-labelledby":k,"aria-describedby":A,required:I?!1:S,accept:ie.image,type:"file",disabled:y==="inProgress",className:"sr-only",onChange:t=>{var w;(w=t.target.files)!=null&&w.length&&(M(t.target.files[0],H),h==null||h(t.target.files[0]))}})}),y==="inProgress"&&e.jsx(ae,{className:"absolute left-0 right-0 top-0",size:"xs",value:G})]})}),l==="bottom"&&P]})}function ne({children:o,inputFieldClassNames:r,imageUrl:i,previewSize:l,stretchPreview:c,isLoading:s,handleUpload:a,removeButton:d,useDefaultButton:m,disabled:f}){return i?e.jsxs(n.Fragment,{children:[e.jsxs("div",{className:`${l} relative mb-10 overflow-hidden rounded border bg-fg-base/8 p-6`,children:[e.jsx("img",{className:u("mx-auto h-full rounded",c?"object-cover":"object-contain"),onClick:()=>a(),src:i,alt:""}),o]}),e.jsx(v,{onClick:()=>a(),disabled:s||f,className:"mr-10",variant:"outline",color:"primary",size:"xs",children:e.jsx(x,{message:"Replace"})}),d&&n.cloneElement(d,{variant:"outline"}),m&&n.cloneElement(m,{variant:"outline"})]}):n.cloneElement(o,{className:u(r.input,"py-8","file:bg-primary file:text-on-primary file:border-none file:rounded file:text-sm file:font-semibold file:px-10 file:h-24 file:mr-10")})}function oe({children:o,placeholderIcon:r,previewSize:i,imageUrl:l,stretchPreview:c,handleUpload:s,removeButton:a,useDefaultButton:d,previewRadius:m="rounded",showEditButtonOnHover:f=!1,disabled:p}){return e.jsxs("div",{children:[e.jsxs("div",{className:u(i,m,!l&&"border","group z-20 flex flex-col items-center justify-center gap-14 bg-fg-base/8 bg-center bg-no-repeat",c?"bg-cover":"bg-contain p-6"),style:l?{backgroundImage:`url(${l})`}:void 0,onClick:()=>s(),children:[r&&!l&&n.cloneElement(r,{size:"lg"}),e.jsx(v,{variant:"raised",color:"white",size:"xs",className:u(f&&"invisible group-hover:visible"),disabled:p,children:l?e.jsx(x,{message:"Replace image"}):e.jsx(x,{message:"Upload image"})})]}),o,(a||d)&&e.jsxs("div",{className:"mt-8",children:[a&&n.cloneElement(a,{variant:"link"}),d&&n.cloneElement(d,{variant:"link"})]})]})}function ce({children:o,placeholderIcon:r,previewSize:i,isLoading:l,imageUrl:c,removeButton:s,useDefaultButton:a,handleUpload:d,previewRadius:m="rounded-full",disabled:f}){return r||(r=e.jsx(D,{viewBox:"0 0 48 48",className:u("h-full w-full bg-primary-light/40 text-primary/40",m)})),e.jsxs("div",{children:[e.jsxs("div",{className:u("relative",i),onClick:()=>d(),children:[c?e.jsx("img",{src:c,className:u("h-full w-full object-cover",m),alt:""}):r,e.jsx("div",{className:"absolute -bottom-6 -right-6 rounded-full bg-elevated shadow-xl",children:e.jsx(ee,{disabled:l||f,type:"button",variant:"outline",size:"sm",iconSize:"xs",color:"primary",radius:"rounded-full",children:e.jsx(re,{})})})]}),o,(s||a)&&e.jsxs("div",{className:"mt-14",children:[s&&n.cloneElement(s,{variant:"link"}),a&&n.cloneElement(a,{variant:"link"})]})]})}function be(o){const{field:{onChange:r,value:i=null},fieldState:{error:l}}=W({name:o.name}),c={onChange:r,value:i,invalid:l!=null,errorMessage:l?e.jsx(x,{message:"Please select an image."}):null};return e.jsx(te,{...X(c,o)})}export{be as F,te as I};
