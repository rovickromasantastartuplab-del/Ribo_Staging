import{ac as g,i as h,s as x,q as v,l,t as d,m as j,k as f,aZ as b,j as e,T as s,av as y,aX as I,B as D,r as c,b4 as k,u as S,aw as P,aj as C,ax as T,az as u}from"./client-DtfdVV77.js";import{A as w}from"./admin-config-DXsixO44.js";import{T as A}from"./team-index-page-tabs-DGkSG6mK.js";import{I as N}from"./invite-agents-dialog-DWgrpC1c.js";import{t as R}from"./team-DYmDDGxN.js";import{D as H}from"./settings-links-CRsxvJIZ.js";import{G as z}from"./global-loading-progress-DVC8NxPo.js";import{N as E,a as M}from"./name-with-avatar-D8NZSkGp.js";import{D as B}from"./data-table-add-item-button-B_2m2pad.js";import{D as O}from"./data-table-header-CdCZHch7.js";import{D as q}from"./data-table-pagination-footer-B4yyc06A.js";import{u as L}from"./use-datatable-search-params-dzq5X78n.js";import{D as F}from"./data-table-emty-state-message-DsPxSC6g.js";import{a as K,D as Q,b as $,c as W}from"./datatable-page-with-header-layout-xcCtlWaX.js";import{u as G}from"./use-datatable-query-v3pOHYke.js";import{h as U}from"./main-BGmGAxtx.js";import{T as V}from"./table-CynOKbaN.js";import{M as X}from"./MoreHoriz-Df3_bV9s.js";import{C as Z}from"./confirmation-dialog-BzXs9ksK.js";import{S as p}from"./skeleton-D178v0-U.js";import{u as _}from"./use-clipboard-Jb2pyXiK.js";import"./dashboard-icons-BJ4c3Z5i.js";import"./library-icon-h4d3s9Ef.js";import"./messages-square-icon-D_3IR-rK.js";import"./Delete-DWP7kvj0.js";import"./Home-iO0iebLw.js";import"./SupervisorAccount-Bkn2ibMi.js";import"./Translate-DPB2wdvD.js";import"./TextFields-CM1xUWDR.js";import"./tabs-spjnXvK6.js";import"./form-chip-field-C7l8nGPv.js";import"./chip-list-DHXDGW6X.js";import"./select-D9niWe2H.js";import"./combobox-end-adornment-CWQ4Xgal.js";import"./external-link-Cxcw6nc_.js";import"./book-open-D91H26Dq.js";import"./Add-B1HfWgJf.js";import"./FilterAlt-CRhKT7zD.js";import"./select-filter-panel-hjhYEdoY.js";import"./filter-operator-names-BbrFb9i0.js";import"./normalized-model-field-D3Ui05eZ.js";import"./Edit-BaEHOLuK.js";import"./accordion-Dmxnze9z.js";import"./accordtion-animation-BGCK95Hj.js";import"./checkbox-CS7ILu6P.js";import"./CheckBoxOutlineBlank-DU0ZdwTb.js";import"./custom-menu-Dvq-fOnC.js";import"./use-toggle-dashboard-left-sidebar-DxaOS7gK.js";import"./toggle-left-sidebar-icon-j-5uTef5.js";import"./ArrowDownward-DHtsWMyK.js";import"./useEffectEvent-Offmqu_S.js";import"./is-ctrl-key-pressed-CaS-AM38.js";import"./useGlobalListeners-BGMP113F.js";function J(){const{trans:t}=g();return h({mutationFn:a=>Y(a),onSuccess:async()=>{await v.invalidateQueries({queryKey:l.agentInvites.invalidateKey}),d(t(j("Invite resent")))},onError:a=>x(a)})}function Y(t){return f.post(`helpdesk/agents/invite/${t.inviteId}/resend`,t).then(a=>a.data)}function ee(){const{trans:t}=g();return h({mutationFn:a=>te(a.inviteId),onSuccess:async()=>{await v.invalidateQueries({queryKey:l.agentInvites.invalidateKey}),d(t(j("Invite revoked")))},onError:a=>x(a)})}function te(t){return f.delete(`helpdesk/agents/invite/${t}`).then(a=>a.data)}const ae=[{key:"name",allowsSorting:!0,visibleInMode:"all",sortingKey:"email",header:()=>e.jsx(s,{message:"Email"}),body:(t,a)=>a.isPlaceholder?e.jsx(E,{showDescription:!0,className:"max-w-100"}):e.jsx(M,{label:t.email.split("@")[0],alwaysShowAvatar:!0,description:t.email,avatarCircle:!0})},{key:"role",header:()=>e.jsx(s,{message:"Role"}),body:(t,a)=>a.isPlaceholder?e.jsx(p,{variant:"rect",className:"max-w-80"}):t.role?e.jsx(I,{className:"w-max capitalize",radius:"rounded-panel",size:"sm",children:t.role}):null},{key:"status",header:()=>e.jsx(s,{message:"Status"}),hideHeader:!0,body:t=>e.jsx(se,{invite:t})},{key:"actions",header:()=>e.jsx(s,{message:"Actions"}),hideHeader:!0,visibleInMode:"all",align:"end",width:"w-42 flex-shrink-0",body:(t,a)=>a.isPlaceholder?e.jsx(p,{variant:"rect",size:"w-24 h-24"}):e.jsx(ie,{invite:t})}];function rt(){const{searchParams:t,sortDescriptor:a,mergeIntoSearchParams:i,setSearchQuery:o,isFiltering:n}=L(b),r=G(l.agentInvites.index(t));return e.jsxs(K,{children:[e.jsx(z,{query:r}),e.jsx(U,{children:e.jsx(s,{message:"Team - Invites"})}),e.jsx(Q,{title:e.jsx(s,{message:"Team"}),showSidebarToggleButton:!0,border:"border-none",rightContent:e.jsx(H,{variant:"button",link:w.pages.agentInvites,size:"xs"})}),e.jsx(A,{}),e.jsxs($,{children:[e.jsx(O,{searchValue:t.query,onSearchChange:o,actions:e.jsxs(y,{type:"modal",children:[e.jsx(B,{children:e.jsx(s,{message:"Invite teammates"})}),e.jsx(N,{})]})}),e.jsxs(W,{children:[e.jsx(V,{columns:ae,data:r.items,sortDescriptor:a,onSortChange:i,enableSelection:!1,cellHeight:"h-70"}),r.isEmpty&&e.jsx(F,{isFiltering:n,className:"mt-44",image:R,title:e.jsx(s,{message:"No invites have been sent yet"}),filteringTitle:e.jsx(s,{message:"No matching invites"})}),e.jsx(q,{hideIfOnlyOnePage:!0,query:r,onPageChange:m=>i({page:m}),onPerPageChange:m=>i({perPage:m})})]})]})]})}function se({invite:t}){const a=J();return e.jsx(D,{variant:"outline",color:"primary",size:"xs",disabled:a.isPending,onClick:()=>{a.mutate({inviteId:t.id})},children:e.jsx(s,{message:"Resend"})})}function ie({invite:t}){const[a,i]=c.useState(!1),{hasPermission:o}=k(),{base_url:n}=S(),[,r]=_(`${n}/agents/join/${t.id}?email=${encodeURIComponent(t.email)}`);return e.jsxs(c.Fragment,{children:[e.jsx(y,{type:"modal",isOpen:a,onOpenChange:i,children:e.jsx(re,{inviteId:t.id})}),e.jsxs(P,{children:[e.jsx(C,{size:"md",className:"text-muted",children:e.jsx(X,{})}),e.jsxs(T,{children:[e.jsx(u,{value:"copy",onSelected:()=>{r(),d({message:"Link copied"})},children:e.jsx(s,{message:"Copy invite link"})}),o("users.create")&&e.jsx(u,{value:"delete",className:"text-danger",onSelected:()=>{i(!0)},children:e.jsx(s,{message:"Revoke"})})]})]})]})}function re({inviteId:t}){const a=ee();return e.jsx(Z,{isDanger:!0,title:e.jsx(s,{message:"Revoke invite"}),body:e.jsx(s,{message:"Are you sure you want to revoke this invite?"}),confirm:e.jsx(s,{message:"Revoke"}),isLoading:a.isPending,onConfirm:()=>{a.mutate({inviteId:t})}})}export{rt as Component};
