import{l as y,r as j,j as e,T as a,aX as h,Q as p,b7 as n}from"./client-DtfdVV77.js";import{A as b}from"./attribute-renderer-C6KvryoI.js";import{a as w,C as f}from"./customer-avatar-ul3Z1Bt5.js";import{C as k}from"./conversation-priority-CeA32zhn.js";import{g as S}from"./get-status-color-DZZVbbOS.js";import{U as _}from"./unseen-messages-badge-CODRuz4h.js";import{U as C}from"./main-BGmGAxtx.js";import{u as v}from"./useSuspenseQuery-Bmt2-NKx.js";import{C as N}from"./chip-list-DHXDGW6X.js";import{M as z}from"./messages-square-icon-D_3IR-rK.js";import{C as A}from"./ConfirmationNumber-CY9CjtLz.js";import{S as T}from"./SupervisorAccount-Bkn2ibMi.js";import{T as W}from"./table-CynOKbaN.js";const I=s=>{const t=v(y.attributes.normalizedList({type:"conversation",for:"agent"})).data.attributes;return j.useMemo(()=>{const d=s.filter(r=>r.startsWith("ca_")).map(r=>{const m=r.replace("ca_",""),l=t.find(i=>i.key===m);if(l)return{key:r,header:()=>e.jsx(a,{message:l.name}),allowsSorting:!1,body:i=>{var g;const u=((g=i.attributes)==null?void 0:g[m])??null,x={...l,value:u};return e.jsx(b,{attribute:x})}}}).filter(r=>!!r);return d.length>0?[...c,...d]:c},[s,t])},c=[{key:"id",allowsSorting:!0,header:()=>e.jsx(a,{message:"ID"}),body:s=>s.id},{key:"status",sortingKey:"status_category",allowsSorting:!0,maxWidth:"max-w-100",header:()=>e.jsx(a,{message:"Status"}),body:s=>e.jsx(h,{size:"xs",color:S(s.status_category).button,fontWeight:"font-semibold",children:s.status_label})},{key:"type",allowsSorting:!0,header:()=>e.jsx(a,{message:"Type"}),body:s=>e.jsx("div",{className:"flex items-center gap-6",children:s.type==="ticket"?e.jsxs(e.Fragment,{children:[e.jsx(A,{size:"xs"}),e.jsx(a,{message:"Ticket"})]}):e.jsxs(e.Fragment,{children:[e.jsx(z,{size:"xs"}),e.jsx(a,{message:"Chat"})]})})},{key:"channel",allowsSorting:!0,header:()=>e.jsx(a,{message:"Channel"}),body:s=>e.jsx("div",{className:"capitalize",children:e.jsx(a,{message:s.channel})})},{key:"priority",allowsSorting:!0,header:()=>e.jsx(a,{message:"Priority"}),body:s=>e.jsx(k,{priority:s.priority})},{key:"user_id",allowsSorting:!0,maxWidth:"max-w-200",header:()=>e.jsx(a,{message:"Customer"}),body:s=>e.jsxs("div",{className:"flex items-center gap-12 pl-6 pr-24",children:[e.jsx(w,{user:s.user,size:"sm"}),e.jsx(f,{user:s.user})]})},{key:"subject",maxWidth:"max-w-400",header:()=>e.jsx(a,{message:"Subject"}),body:s=>s.subject},{key:"summary",maxWidth:"max-w-400",header:()=>e.jsx(a,{message:"Summary"}),body:s=>e.jsx(M,{conversation:s})},{key:"assignee_id",allowsSorting:!0,maxWidth:"max-w-200",header:()=>e.jsx(a,{message:"Assignee"}),body:s=>s.assignee?e.jsxs("div",{className:"flex items-center gap-8",children:[e.jsx(C,{size:"xs",withLink:!1,user:s.assignee}),s.assignee.name]}):e.jsxs("div",{className:"flex items-center gap-8",children:[e.jsx(T,{size:"w-18 h-18"}),e.jsx(a,{message:"Unassigned"})]})},{key:"group_id",allowsSorting:!0,maxWidth:"max-w-200",header:()=>e.jsx(a,{message:"Group"}),body:s=>s.group?e.jsxs("div",{className:"flex items-center gap-8",children:[e.jsx(p,{size:"xs",fallback:"initials",label:s.group.name}),s.group.name]}):null},{key:"updated_at",allowsSorting:!0,width:"w-100",header:()=>e.jsx(a,{message:"Last updated"}),body:s=>e.jsx(n,{date:s.updated_at,style:"narrow"})},{key:"created_at",width:"w-100",allowsSorting:!0,header:()=>e.jsx(a,{message:"Request date"}),body:s=>e.jsx(n,{date:s.created_at,style:"narrow"})},{key:"closed_at",width:"w-100",allowsSorting:!0,header:()=>e.jsx(a,{message:"Solved at"}),body:s=>e.jsx(n,{date:s.closed_at,style:"narrow"})},{key:"closed_by",allowsSorting:!0,header:()=>e.jsx(a,{message:"Closed by"}),body:s=>s.closed_by},{key:"assigned_at",width:"w-100",allowsSorting:!0,header:()=>e.jsx(a,{message:"Assigned at"}),body:s=>e.jsx(n,{date:s.assigned_at,style:"narrow"})}];function M({conversation:s}){var o;return e.jsxs("div",{className:"overflow-hidden overflow-ellipsis whitespace-nowrap",children:[e.jsxs("div",{className:"flex items-center gap-10",children:[e.jsx(_,{conversationId:s.id}),!!((o=s.tags)!=null&&o.length)&&e.jsx(N,{size:"xs",wrap:!1,children:s.tags.slice(0,3).map(t=>e.jsx(h,{children:t.name},t.id))}),e.jsx("div",{children:s.subject})]}),s.latest_message&&e.jsx("div",{className:"overflow-hidden overflow-ellipsis whitespace-nowrap pt-4 font-normal text-muted",children:s.latest_message.body})]})}function V({data:s,selectedTickets:o,onSelectionChange:t,sortDescriptor:d,onSortChange:r,className:m,onRowAction:l,activeColumns:i}){const u=I(i);return e.jsx(W,{tableStyle:"html",headerCellHeight:"h-36",cellHeight:"h-64",selectedRows:o,onSelectionChange:x=>t==null?void 0:t(x),columns:u,activeColumns:i,data:s||[],onAction:l,sortDescriptor:d,onSortChange:r,className:m,collapseOnMobile:!1,enableSelection:!!t})}export{V as G};
