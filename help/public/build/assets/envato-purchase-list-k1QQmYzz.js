import{j as e,p as c,r as u,X as h,l as f,P as v,T as i,a_ as w,aS as j,aT as N,u as g,al as b,am as D,ap as y,D as x,aq as _,B as p,av as P}from"./client-DtfdVV77.js";import{F as L}from"./formatted-duration-D1SZYLwf.js";import{u as T}from"./use-sync-envato-purchases-Xqd4DBys.js";import{L as k}from"./external-link-Cxcw6nc_.js";function S({children:s,className:a}){return e.jsx("div",{className:c("text-sm",a),children:s})}function d({label:s,children:a}){return e.jsxs("div",{className:"flex items-center py-6",children:[e.jsx("span",{className:"max-w-[50%] flex-shrink-0 overflow-hidden overflow-ellipsis whitespace-nowrap text-muted",children:s}),":"," ",e.jsx("div",{className:"ml-8 overflow-hidden overflow-ellipsis whitespace-nowrap",children:a})]})}function z({children:s,className:a}){const t=u.Children.toArray(s);return e.jsx("div",{className:a,children:t.map((r,l)=>u.cloneElement(r,{isLast:l===t.length-1}))})}function C({children:s,className:a,isLast:t,isActive:r}){return e.jsxs("div",{className:c("flex min-w-0 gap-12 py-6",a),children:[e.jsxs("div",{children:[e.jsx("div",{className:c("mt-4 h-12 w-12 flex-shrink-0 rounded-full border-[3px]",r&&"border-positive bg-positive-lighter")}),!t&&e.jsx("div",{className:"mx-auto mt-4 h-[calc(100%-12px)] w-2 bg-chip"})]}),e.jsx("div",{className:"min-w-0 flex-auto overflow-hidden overflow-ellipsis whitespace-nowrap text-sm",children:s})]})}function U({initialData:s,userId:a}){const{data:t}=h({...f.pageVisits.index(a,{perPage:"8"}),initialData:s}),r=(t==null?void 0:t.pagination.data)??[];return t?r.length?e.jsx(z,{className:"overflow-x-hidden",children:r.map((l,o)=>e.jsx(C,{isActive:o===0,className:"w-max",children:e.jsx(w,{label:l.url,delay:300,children:e.jsxs("div",{children:[e.jsx("a",{href:l.url,target:"_blank",rel:"noreferrer",children:l.title}),e.jsx("div",{className:"text-xs text-muted",children:e.jsx($,{start:l.created_at,end:l.ended_at,isLive:o===0})})]})})},l.id))}):e.jsx("div",{className:"font-italic text-xs text-muted",children:e.jsx(i,{message:"User has not visited any pages yet"})}):e.jsx("div",{className:"flex justify-center",children:e.jsx(v,{isIndeterminate:!0,size:"xs"})})}const $=u.memo(({start:s,end:a,isLive:t})=>{const[r]=u.useState(()=>{const l=j(s),n=(a?j(a):N()).toDate().getTime()-l.toDate().getTime();return n>1e3?n:1e3});return e.jsx(L,{ms:r,isLive:t,verbose:!0})});function X({session:s}){return e.jsxs(S,{children:[e.jsx(d,{label:e.jsx(i,{message:"IP address"}),children:s.ip_address}),!!s.platform&&e.jsxs(d,{label:e.jsx(i,{message:"Platform"}),children:[e.jsx(F,{platformName:s.platform})," ",e.jsx("span",{className:"capitalize",children:e.jsx(i,{message:s.platform})})]}),!!s.browser&&e.jsxs(d,{label:e.jsx(i,{message:"Browser"}),children:[e.jsx(B,{browserName:s.browser})," ",e.jsx("span",{className:"capitalize",children:e.jsx(i,{message:s.browser})})]}),!!s.device&&e.jsx(d,{label:e.jsx(i,{message:"Device"}),children:e.jsx("span",{className:"capitalize",children:e.jsx(i,{message:s.device})})})]})}const E=["chrome","firefox","safari","edge","brave","opera"];function B({browserName:s}){const{base_url:a}=g(),t=E.find(r=>s.toLowerCase().includes(r.toLowerCase()));if(t)return e.jsx("img",{src:`${a}/images/browsers/${t}.svg`,alt:s,className:"inline-block h-12 w-12 align-middle"})}const I=["windows","osx","linux","android","ios"];function F({platformName:s}){const{base_url:a}=g(),t=I.find(r=>s.toLowerCase().replace(" ","").includes(r.replace(" ","").toLowerCase()));if(t)return e.jsx("img",{src:`${a}/images/platforms/${t}.png`,alt:s,className:"mb-2 inline-block h-12 w-12 align-middle"})}function V({purchaseCode:s,userId:a}){const{close:t}=b(),r=T();return e.jsxs(D,{size:"md",children:[e.jsx(y,{children:e.jsxs("div",{className:"flex items-start gap-14 text-sm",children:[e.jsx("img",{src:s.image,alt:"",className:"h-80 w-80 flex-shrink-0 rounded"}),e.jsxs("div",{className:"flex-auto",children:[e.jsx("a",{href:s.url,target:"_blank",rel:"noreferrer",className:k,children:s.item_name}),e.jsx("div",{className:"mt-4 text-sm text-muted",children:s.code}),e.jsxs("div",{className:"mt-12",children:[e.jsx(m,{label:e.jsx(i,{message:"Customer"}),value:s.envato_username}),e.jsx(m,{label:e.jsx(i,{message:"Purchased"}),value:e.jsx(x,{date:s.purchased_at})}),e.jsx(m,{label:e.jsx(i,{message:"Supported until"}),value:e.jsx(x,{date:s.supported_until})}),e.jsx(m,{label:e.jsx(i,{message:"Last synced"}),value:e.jsx(x,{date:s.updated_at})})]})]})]})}),e.jsxs(_,{children:[e.jsx(p,{onClick:()=>t(),children:e.jsx(i,{message:"Cancel"})}),e.jsx(p,{variant:"flat",color:"primary",disabled:r.isPending,onClick:()=>r.mutate({userId:a}),children:e.jsx(i,{message:"Sync purchases"})})]})]})}function m({label:s,value:a}){return e.jsxs("div",{className:"mb-6 flex items-center gap-14",children:[e.jsxs("div",{children:[s,":"]}),e.jsx("div",{className:"text-muted",children:a})]})}function G({userId:s,initialData:a,itemClassName:t,selectedPurchaseId:r}){var o;const l=h({...f.envato.userPurchases(s),initialData:a?{purchases:a}:void 0});return e.jsx("div",{children:(o=l.data)==null?void 0:o.purchases.map(n=>e.jsxs(P,{type:"modal",children:[e.jsxs("div",{className:c("flex cursor-pointer items-center gap-8 rounded-panel p-8 hover:bg-hover",t,r===n.id&&"bg-primary-light/30"),children:[e.jsx("img",{src:n.image,alt:"",className:"h-30 w-30 rounded"}),e.jsxs("div",{className:"min-w-0 text-xs",children:[e.jsx("div",{className:"overflow-hidden overflow-ellipsis whitespace-nowrap",children:n.item_name}),e.jsx("div",{className:c("text-muted",n.support_expired&&"line-through"),children:n.supported_until?e.jsx(x,{date:n.supported_until}):n.support_expired?e.jsx(i,{message:"Support expired"}):"-"})]})]}),e.jsx(V,{purchaseCode:n,userId:s})]},n.id))})}export{S as D,G as E,U as P,X as T,d as a};
