import{j as e,T as t,D as b,b0 as L,br as w,bT as D,bb as k,p as N,r as T,a_ as F,c as B,X as A,l as S,B as V,L as O}from"./client-DtfdVV77.js";import{u as P,R as $}from"./use-date-range-C3EA7LPl.js";import{T as M}from"./teammate-performance-table-DPC-XyuP.js";import{R as g}from"./admin-report-card-row-B2ExoT8Z.js";import{B as C}from"./bar-chart-Bw8HGztD.js";import{C as z}from"./chart-layout-bzO7gkty.js";import{L as E}from"./line-chart-BnZuJz4K.js";import{C as Q}from"./report-table-QywmJl2G.js";import{h as q}from"./main-BGmGAxtx.js";import{F as G}from"./formatted-duration-D1SZYLwf.js";import{F as H}from"./formatted-number-CIAFur2S.js";import"./use-is-module-installed-CDjratdW.js";import"./datatable-page-with-header-layout-xcCtlWaX.js";import"./use-toggle-dashboard-left-sidebar-DxaOS7gK.js";import"./toggle-left-sidebar-icon-j-5uTef5.js";import"./select-D9niWe2H.js";import"./combobox-end-adornment-CWQ4Xgal.js";import"./name-with-avatar-D8NZSkGp.js";import"./skeleton-D178v0-U.js";import"./external-link-Cxcw6nc_.js";import"./TrendingFlat-6ceQSLnV.js";import"./formatted-bytes-CFeeP1Iy.js";import"./pretty-bytes-bO14ePu9.js";import"./table-CynOKbaN.js";import"./checkbox-CS7ILu6P.js";import"./CheckBoxOutlineBlank-DU0ZdwTb.js";import"./ArrowDownward-DHtsWMyK.js";import"./useEffectEvent-Offmqu_S.js";import"./is-ctrl-key-pressed-CaS-AM38.js";import"./useGlobalListeners-BGMP113F.js";import"./ArrowDropUp-Bo2AvQbZ.js";import"./custom-menu-Dvq-fOnC.js";const I={month:"long",day:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"};function X({date:s}){const r=e.jsx(b,{date:s,options:I});return e.jsxs("div",{className:"mt-44 text-center text-sm text-muted/40",children:[e.jsx("p",{children:e.jsx(t,{message:"This report was generated on :date",values:{date:r}})}),e.jsx("p",{children:e.jsx(t,{message:"All reports are displayed in your local time."})})]})}const _=[0,1,2,3,4,5,6],R=["0-2","2-4","4-6","6-8","8-10","10-12","12-14","14-16","16-18","18-20","20-22","22-24"];function J({report:s,className:r,colSpan:i="col-span-7",rowSpan:m="row-span-11"}){const a=L(),c=w({weekday:"short"}),p=D(k(),a.localeCode);return e.jsx(z,{title:e.jsx(t,{message:"Busiest time of day"}),className:N(r,i,m,"compact-scrollbar overflow-x-auto overflow-y-hidden"),children:e.jsxs("div",{className:"grid w-full grid-cols-[max-content,repeat(12,minmax(66px,1fr))] gap-1",children:[e.jsx("div",{className:"spacer"}),R.map(o=>e.jsx("div",{className:"py-6 text-center text-xs font-semibold",children:o},o)),_.map(o=>e.jsxs(T.Fragment,{children:[e.jsx("div",{className:"flex h-44 items-center pr-10 text-xs font-semibold",children:c.format(p.add({days:o}).toDate())}),R.map(l=>{const n=s?s.datasets[0].data[o].value[l]:0;return e.jsx(F,{label:e.jsxs("span",{children:[e.jsx(t,{message:(s==null?void 0:s.datasets[0].label)??"No data",values:{count:n}}),": ",n]}),children:e.jsx("div",{className:"h-44 bg-primary opacity-10 transition-opacity",style:{opacity:s?K(n,s.datasets[0].max):.1}})},l)})]},o))]})})}function K(s,r){return s===0?.1:Math.max(.1,Math.min(1,s/r))}function Ne(){var c,p,o,l,n,d,x,u,j,h,f,v,y;const{pathname:s}=B(),r=s.split("/").pop()==="tickets"?"ticket":"chat",[i,m]=P(),a=A(S.reports.get(`reports/conversations/${r}`,i));return e.jsxs($,{dateRange:i,channel:r==="ticket"?"tickets":"chats",onDateRangeChange:m,title:r==="ticket"?e.jsx(t,{message:"Tickets"}):e.jsx(t,{message:"Chats"}),children:[e.jsx(q,{children:r==="ticket"?e.jsx(t,{message:"Reports - Tickets"}):e.jsx(t,{message:"Reports - Chats"})}),e.jsxs("div",{className:"chart-grid",children:[e.jsx(U,{data:a.data}),e.jsx(E,{colSpan:"col-span-8",data:(c=a.data)==null?void 0:c.newConversations,isLoading:a.isLoading,title:e.jsx(t,{message:"New conversations"}),hideLegend:!0,description:e.jsx(t,{message:":count total conversations",values:{count:e.jsx(H,{value:((l=(o=(p=a.data)==null?void 0:p.newConversations)==null?void 0:o.datasets[0])==null?void 0:l.total)||0})}})}),e.jsx(C,{colSpan:"col-span-4",data:(n=a.data)==null?void 0:n.firstReplyTimes,direction:"vertical",individualBarColors:!0,isLoading:a.isLoading,hideLegend:!0,title:r==="ticket"?e.jsx(t,{message:"Hours until first agent reply"}):e.jsx(t,{message:"Minutes until first agent reply"}),description:(x=(d=a.data)==null?void 0:d.firstReplyTimes.datasets[0])!=null&&x.average?e.jsx(t,{message:":time average",values:{time:e.jsx(G,{seconds:((j=(u=a.data)==null?void 0:u.firstReplyTimes.datasets[0])==null?void 0:j.average)||0,verbose:!0})}}):null}),e.jsx(J,{report:(h=a.data)==null?void 0:h.busiestTimeOfDay}),e.jsx(C,{colSpan:"col-span-5",title:e.jsx(t,{message:"Conversations by tag"}),data:(f=a.data)==null?void 0:f.tags,direction:"horizontal",isLoading:a.isLoading,individualBarColors:!0,hideLegend:!0}),e.jsx(Q,{label:e.jsx(t,{message:"Teammate performance"}),actions:e.jsx(V,{variant:"outline",color:"primary",elementType:O,to:"../teammates",relative:"path",size:"xs",children:e.jsx(t,{message:"View all"})}),children:e.jsx(M,{report:(v=a.data)==null?void 0:v.agents})})]}),(y=a.data)!=null&&y.newConversations.generatedAt?e.jsx(X,{date:a.data.newConversations.generatedAt}):null]})}function U({data:s}){var a,c,p,o,l,n,d,x;const r=s==null?void 0:s.newConversations.datasets[0],i=s==null?void 0:s.newConversations.datasets[1],m=!s;return e.jsxs(T.Fragment,{children:[e.jsx(g,{currentValue:(r==null?void 0:r.total)??0,previousValue:(i==null?void 0:i.total)??void 0,isLoading:m,children:e.jsx(t,{message:"New Conversations"})}),e.jsx(g,{currentValue:((c=(a=s==null?void 0:s.agents)==null?void 0:a.datasets[0])==null?void 0:c.totalAgentReplies)??0,previousValue:((o=(p=s==null?void 0:s.agents)==null?void 0:p.datasets[1])==null?void 0:o.totalAgentReplies)??void 0,isLoading:m,children:e.jsx(t,{message:"Total agent replies"})}),e.jsx(g,{currentValue:((n=(l=s==null?void 0:s.agents)==null?void 0:l.datasets[0])==null?void 0:n.avgResponseTime)??0,previousValue:((x=(d=s==null?void 0:s.agents)==null?void 0:d.datasets[1])==null?void 0:x.avgResponseTime)??void 0,isLoading:m,type:"durationInSeconds",children:e.jsx(t,{message:"Average response time"})}),e.jsx(g,{type:"percentage",currentValue:(r==null?void 0:r.solvedOnFirstReplyPercentage)??0,previousValue:(i==null?void 0:i.solvedOnFirstReplyPercentage)??void 0,isLoading:m,children:e.jsx(t,{message:"Closed on first reply"})})]})}export{Ne as Component};
