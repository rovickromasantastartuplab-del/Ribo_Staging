import{i as p,s as d,q as n,t as f,m as j,k as g,h as x,j as t,T as o,bF as D,bU as w,B as b,L as v}from"./client-DtfdVV77.js";import{g as Q}from"./article-link-kVBPNf7I.js";import{h as l}from"./custom-menu-Dvq-fOnC.js";import{H as A,a as C,b as I,c as q,d as E}from"./hc-manager-title-DcnbfhCp.js";import{m as H}from"./use-sortable-CsHM4tcn.js";import{u as M}from"./use-required-params-BhaT_-q3.js";import{u as K}from"./useSuspenseQuery-Bmt2-NKx.js";import{C as R}from"./confirmation-dialog-BzXs9ksK.js";import"./slugify-string-CGmMIJK7.js";import"./breadcrumb-CaNBY_Ut.js";import"./useEffectEvent-Offmqu_S.js";import"./ChevronRight-C5OrfRtB.js";import"./MoreHoriz-Df3_bV9s.js";import"./admin-config-DXsixO44.js";import"./dashboard-icons-BJ4c3Z5i.js";import"./library-icon-h4d3s9Ef.js";import"./messages-square-icon-D_3IR-rK.js";import"./main-BGmGAxtx.js";import"./Delete-DWP7kvj0.js";import"./Home-iO0iebLw.js";import"./SupervisorAccount-Bkn2ibMi.js";import"./Translate-DPB2wdvD.js";import"./TextFields-CM1xUWDR.js";import"./settings-links-CRsxvJIZ.js";import"./external-link-Cxcw6nc_.js";import"./book-open-D91H26Dq.js";import"./datatable-page-with-header-layout-xcCtlWaX.js";import"./use-toggle-dashboard-left-sidebar-DxaOS7gK.js";import"./toggle-left-sidebar-icon-j-5uTef5.js";import"./DragIndicator-CvftiD3i.js";import"./MoreVert-BVDYtk4z.js";import"./is-touch-device-vJjKU1l2.js";import"./OpenInNew-C06CZDpe.js";import"./isScrollable-BSEN4xi5.js";import"./use-droppable-CpvjuNXE.js";import"./uploaded-file-DOXWsty7.js";import"./useGlobalListeners-BGMP113F.js";function T(){return p({mutationFn:e=>k(e),onSuccess:async()=>{await n.invalidateQueries({queryKey:l.articles.invalidateKey}),f(j("Article deleted"))},onError:e=>d(e)})}function k({ids:e}){return g.delete(`hc/articles/${e.join(",")}`).then(r=>r.data)}const u=e=>l.manager.articles(e).queryKey;function L(){return p({mutationFn:e=>{const r=n.getQueryData(u(e.sectionId)).articles.map(s=>s.id);return S({sectionId:e.sectionId,ids:r})},onMutate:async({oldIndex:e,newIndex:r,sectionId:s})=>{const a=u(s);await n.cancelQueries({queryKey:a});const m=n.getQueryData(a);return n.setQueryData(a,c=>{if(!c)return;const i={...c,articles:c.articles};return i.articles=H(i.articles,e,r),i}),{previousResponse:m}},onSuccess:async()=>{await n.invalidateQueries({queryKey:["articles"]})},onError:(e,r,s)=>{d(e),n.setQueryData(u(r.sectionId),s==null?void 0:s.previousResponse)}})}function S(e){return g.post(`hc/manager/sections/${e.sectionId}/articles/reorder`,e).then(r=>r.data)}function we(){const e=x(),{sectionId:r}=M(["sectionId"]),s=K(l.manager.articles(r)),a=s.data.articles,m=T(),c=L();return t.jsxs(A,{breadcrumb:t.jsx(E,{category:s.data.category,section:s.data.section}),actionButton:t.jsx(b,{size:"xs",variant:"flat",color:"primary",elementType:v,to:"articles/new",children:t.jsx(o,{message:"New article"})}),children:[a.length?t.jsx(C,{children:t.jsx(o,{message:"Articles (:count)",values:{count:a.length}})}):null,a.map(i=>t.jsx(I,{item:i,items:a,onSortEnd:(y,h)=>{c.mutate({sectionId:r,oldIndex:y,newIndex:h})},onEdit:()=>e(`articles/${i.id}/edit`),onClick:()=>e(`articles/${i.id}/edit`),onView:()=>e(Q(i,{section:s.data.section})),onDelete:()=>{D(R,{title:t.jsx(o,{message:"Delete article"}),body:t.jsx(o,{message:"Are you sure you want to delete this article?"}),confirm:t.jsx(o,{message:"Delete"}),isDanger:!0,isLoading:m.isPending,onConfirm:()=>m.mutate({ids:[i.id]},{onSuccess:()=>w()})})},children:i.title},i.id)),!a.length&&t.jsx(q,{title:t.jsx(o,{message:"This section is empty"}),description:t.jsx(o,{message:"Empty sections aren't visible in the Help Center. You can make them visible by adding an article."})})]})}export{we as Component};
