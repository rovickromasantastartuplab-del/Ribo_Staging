import{r as n,j as e}from"./ui-C-VW1P-5.js";import{u as y,K as v,m as C,ak as _,L as m,ab as w,B as L,a6 as N,t as p}from"./app-BQKKzqf3.js";import{S as I,a as D,b as E,c as Q,d as P}from"./select-ivmaqUw7.js";import{S as k}from"./switch-T0u5R7d_.js";import R from"./Template1-C_qi4Klx.js";import B from"./Template2-DDBHMmnj.js";import O from"./Template3-h64ZEYzk.js";import F from"./Template4-BJh6CdG2.js";import H from"./Template5-C_n4GoFr.js";import U from"./Template6-DBWTdLhY.js";import $ from"./Template7-C8EPl6IN.js";import A from"./Template8-C1CogZbi.js";import M from"./Template9-FT2EzxkW.js";import K from"./Template10-Ciq61FGw.js";import{I as X}from"./IframePortal-BwGjSup1.js";import"./vendor-CxtKjBZA.js";import"./utils-DCj7OOX3.js";import"./index-IS-ASe-l.js";import"./chevron-up-5kET5X99.js";import"./QRCodeComponent-CRXf3pHS.js";const z={template1:R,template2:B,template3:O,template4:F,template5:H,template6:U,template7:$,template8:A,template9:M,template10:K},u={quote:{quote_id:"00001",quote_number:"QT-2024-000001",issue_date:new Date().toISOString().split("T")[0],due_date:new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0],date_quoted:new Date().toISOString().split("T")[0],valid_until:new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0],total_tax:60,total_discount:150,sub_total:300,total_amount:210,totalQuantity:3,totalRate:300,totalTaxPrice:60,totalDiscount:150,creator:{name:"<Creator Name>",email:"<Creator Email>"},billing_contact:{name:"<Billing Contact>",email:"<Billing Email>",phone:"<Billing Phone>"},shipping_contact:{name:"<Shipping Contact>",email:"<Shipping Email>",phone:"<Shipping Phone>"},billing_address:"<Billing Address>",billing_city:"<Billing City>",billing_state:"<Billing State>",billing_postal_code:"<Billing Zip>",billing_country:"<Billing Country>",shipping_address:"<Shipping Address>",shipping_city:"<Shipping City>",shipping_state:"<Shipping State>",shipping_postal_code:"<Shipping Zip>",shipping_country:"<Shipping Country>"},items:[{name:"Item 1",quantity:1,price:100,discount:50,itemTax:[{name:"Tax 0",rate:"10 %",price:"$10"}]},{name:"Item 2",quantity:1,price:100,discount:50,itemTax:[{name:"Tax 1",rate:"10 %",price:"$10"}]},{name:"Item 3",quantity:1,price:100,discount:50,itemTax:[{name:"Tax 0",rate:"10 %",price:"$10"}]}],taxesData:{"Tax 0":30,"Tax 1":30},settings:{quoteLogo:null}},V={template1:"New York",template2:"Toronto",template3:"Rio",template4:"London",template5:"Istanbul",template6:"Mumbai",template7:"Hong Kong",template8:"Tokyo",template9:"Sydney",template10:"Paris"},W=["003580","666666","6676ef","f50102","f9b034","fbdd03","c1d82f","37a4e4","8a7966","6a737b","050f2c","0e3666","3baeff","3368e6","b84592","f64f81","f66c5f","fac168","46de98","40c7d0","be0028","2f9f45","371676","52325d","511378","0f3866","48c0b6","297cc0","ffffff","000000"];function Se(){const{t:s}=y(),{settings:l}=v().props,[Z,J]=n.useState(null),[Y,d]=n.useState(!1),[q,f]=n.useState(0),{data:a,setData:r,errors:c,reset:x}=C({quoteTemplate:l.quoteTemplate||"template1",quoteColor:l.quoteColor||"ffffff",quoteQrEnabled:l.quoteQrEnabled==="on"||l.quoteQrEnabled===!0,quoteLogoId:l.quoteLogoId||null,quoteLogoUrl:l.quoteLogo||null}),g=n.useRef(null);n.useEffect(()=>{if(!g.current)return;const t=new ResizeObserver(([o])=>{f(o.contentRect.height)});return t.observe(g.current),()=>t.disconnect()},[a.quoteLogoUrl]);const h=z[a.quoteTemplate],S=()=>{if(!h)return null;const t={...u.settings,quoteLogo:a.quoteLogoUrl,logoDark:l.logoDark},o={invoicePreviewMain:{maxWidth:"1000px"}};return e.jsx("div",{className:"transform scale-90 origin-top pt-10 w-full",children:e.jsx(X,{children:e.jsx(h,{quote:u.quote,items:u.items,taxesData:u.taxesData,settings:t,color:a.quoteColor,qr_invoice:a.quoteQrEnabled?"on":"off",qrCodeSvg:null,styles:o})})})},b=t=>{r("quoteLogoId",t),t?fetch(route("api.media.index")).then(o=>o.json()).then(o=>{const i=o.find(j=>j.id===Number(t));i&&r("quoteLogoUrl",i.url)}):r("quoteLogoUrl",null),setTimeout(()=>{const o=document.querySelector("[ref]");o&&f(o.offsetHeight)},150)},T=t=>{var o;return t.preventDefault(),d(!0),fetch(route("settings.quote-template"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((o=document.querySelector('meta[name="csrf-token"]'))==null?void 0:o.getAttribute("content"))||"",Accept:"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({quoteTemplate:a.quoteTemplate,quoteColor:a.quoteColor,quoteQrEnabled:a.quoteQrEnabled,quoteLogoId:a.quoteLogoId})}).then(i=>i.json()).then(i=>{i.success?(p.success(i.success),x("quoteLogo")):i.error?p.error(i.error):p.error(s(i.message)),d(!1)}).catch(i=>{p.error(s("Failed to update quote template settings")),d(!1)}),!1};return e.jsx(_,{title:s("Quote Settings"),description:s("Configure quote template, colors, and display options"),action:e.jsxs(L,{type:"submit",form:"quote-template-settings-form",size:"sm",children:[e.jsx(N,{className:"h-4 w-4 mr-2"}),s("Save Changes")]}),children:e.jsx("form",{onSubmit:T,id:"quote-template-settings-form",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[320px_1fr] lg:items-start gap-6",children:[e.jsxs("div",{ref:g,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"quote_template",children:s("Quote Template")}),e.jsxs(I,{value:a.quoteTemplate,onValueChange:t=>r("quoteTemplate",t),children:[e.jsx(D,{children:e.jsx(E,{placeholder:s("Select template")})}),e.jsx(Q,{children:Object.entries(V).map(([t,o])=>e.jsx(P,{value:t,children:o},t))})]}),c.quoteTemplate&&e.jsx("p",{className:"text-sm text-red-600",children:c.quoteTemplate})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(m,{htmlFor:"quote_qr_enabled",className:"text-sm font-medium",children:s("QR Display?")}),e.jsx(k,{id:"quote_qr_enabled",checked:a.quoteQrEnabled,onCheckedChange:t=>r("quoteQrEnabled",t)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:s("Color Input")}),e.jsx("div",{className:"grid grid-cols-6 gap-1 w-50",children:W.map(t=>e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"radio",name:"quoteColor",value:t,checked:a.quoteColor===t,onChange:o=>r("quoteColor",o.target.value),className:"sr-only"}),e.jsx("div",{className:`w-6 h-6 border-2 ${a.quoteColor===t?"border-primary ring-2 ring-primary/20":"border-gray-300"}`,style:{backgroundColor:`#${t}`}})]},t))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"quoteLogo",children:s("Quote Logo")}),e.jsx(w,{label:"",value:a.quoteLogoId||"",onChange:b,placeholder:s("Select quote logo..."),showPreview:!0,returnType:"id"}),c.quoteLogo&&e.jsx("p",{className:"text-sm text-red-600",children:c.quoteLogo}),e.jsx("p",{className:"text-xs text-gray-500",children:s("Select a logo for quotes")})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:s("Preview")}),e.jsx("div",{className:"border rounded-lg overflow-y-auto overflow-x-auto bg-white lg:sticky lg:top-6",style:{height:q-25||"auto"},children:S()})]})]})})})}export{Se as default};
