import{r as m,j as e}from"./ui-C-VW1P-5.js";import{u as W,m as N,C as $,a as B,b as k,D as P,am as Z,B as n,P as ee,l as q,n as A,o as _,L as T,I as ae,c as E,d as se,X as re,t,p as te}from"./app-BQKKzqf3.js";import{T as oe,a as le,b as F,c as i,d as ne,e as d}from"./table-Cm3ifs76.js";import{T as ce}from"./textarea-BvlD1v8z.js";import"./vendor-CxtKjBZA.js";import"./utils-DCj7OOX3.js";function xe({userType:c,payoutRequests:O,settings:o,stats:l}){var g,v,C,w,R;const{t:a}=W(),[H,p]=m.useState(!1),[M,u]=m.useState(!1),[x,j]=m.useState(null),{data:z,setData:L,post:f,processing:Y,errors:y,reset:I}=N({amount:""}),{data:U,setData:b,post:X,processing:G}=N({notes:""}),J=r=>{r.preventDefault(),f(route("referral.payout-request.create"),{onSuccess:s=>{p(!1),I(),s.props.flash.success?t.success(a(s.props.flash.success)):s.props.flash.error&&t.error(a(s.props.flash.error))},onError:s=>{typeof s=="string"?t.error(s):t.error(`Failed to create payout request: ${Object.values(s).join(", ")}`)}})},K=r=>{t.loading(a("Approving payout request...")),f(route("referral.payout-request.approve",r.id),{preserveScroll:!0,onSuccess:s=>{t.dismiss(),s.props.flash.success?t.success(a(s.props.flash.success)):s.props.flash.error&&t.error(a(s.props.flash.error))},onError:s=>{t.dismiss(),typeof s=="string"?t.error(s):t.error(`Failed to approve payout request: ${Object.values(s).join(", ")}`)}})},Q=r=>{r.preventDefault(),x&&X(route("referral.payout-request.reject",x.id),{preserveScroll:!0,onSuccess:s=>{u(!1),j(null),b("notes",""),s.props.flash.success?t.success(a(s.props.flash.success)):s.props.flash.error&&t.error(a(s.props.flash.error))},onError:s=>{typeof s=="string"?t.error(s):t.error(`Failed to reject payout request: ${Object.values(s).join(", ")}`)}})},V=r=>{const h={pending:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"}[r]||"bg-gray-100 text-gray-800";return e.jsx(te,{className:`capitalize ${h}`,children:a(r.charAt(0).toUpperCase()+r.slice(1))})};return e.jsxs("div",{className:"space-y-6",children:[c==="company"&&e.jsxs($,{children:[e.jsxs(B,{className:"flex flex-row items-center justify-between",children:[e.jsx(k,{children:a("Create Payout Request")}),e.jsxs(P,{open:H,onOpenChange:p,children:[e.jsx(Z,{asChild:!0,children:e.jsxs(n,{disabled:l.availableBalance<o.threshold_amount,children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),a("Request Payout")]})}),e.jsxs(q,{children:[e.jsx(A,{children:e.jsx(_,{children:a("Create Payout Request")})}),e.jsxs("form",{onSubmit:J,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(T,{htmlFor:"amount",children:a("Amount")}),e.jsx(ae,{id:"amount",type:"number",step:"0.01",min:o.threshold_amount,max:l.availableBalance,value:z.amount,onChange:r=>L("amount",r.target.value),placeholder:`Min: $${o.threshold_amount}`}),y.amount&&e.jsx("p",{className:"text-sm text-red-500",children:y.amount})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsxs("p",{children:[a("Available Balance"),": ",((g=window.appSettings)==null?void 0:g.formatCurrency(l.availableBalance))||`$${l.availableBalance}`]}),e.jsxs("p",{children:[a("Minimum Amount"),": ",((v=window.appSettings)==null?void 0:v.formatCurrency(o.threshold_amount))||`$${o.threshold_amount}`]})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(n,{type:"button",variant:"outline",onClick:()=>p(!1),children:a("Cancel")}),e.jsx(n,{type:"submit",disabled:Y,children:a("Submit Request")})]})]})]})]})]}),e.jsx(E,{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:l.availableBalance<o.threshold_amount?a("You need at least {{amount}} to request a payout",{amount:((C=window.appSettings)==null?void 0:C.formatCurrency(o.threshold_amount))||`$${o.threshold_amount}`}):a("You can request up to {{amount}} for payout",{amount:((w=window.appSettings)==null?void 0:w.formatCurrency(l.availableBalance))||`$${l.availableBalance}`})})})]}),e.jsxs($,{children:[e.jsx(B,{children:e.jsx(k,{children:a(c==="superadmin"?"All Payout Requests":"Your Payout Requests")})}),e.jsx(E,{children:e.jsxs(oe,{children:[e.jsx(le,{children:e.jsxs(F,{className:"dark:bg-gray-800 dark:border-gray-700",children:[c==="superadmin"&&e.jsx(i,{children:a("Company")}),e.jsx(i,{children:a("Amount")}),e.jsx(i,{children:a("Status")}),e.jsx(i,{children:a("Date")}),c==="superadmin"&&e.jsx(i,{children:a("Actions")})]})}),e.jsx(ne,{children:(R=O.data)==null?void 0:R.map(r=>{var s,h,S,D;return e.jsxs(F,{className:"dark:bg-gray-900 dark:border-gray-700 dark:hover:bg-gray-800",children:[c==="superadmin"&&e.jsx(d,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:(s=r.company)==null?void 0:s.name}),e.jsx("p",{className:"text-sm text-muted-foreground dark:text-gray-400",children:(h=r.company)==null?void 0:h.email})]})}),e.jsx(d,{children:((S=window.appSettings)==null?void 0:S.formatCurrency(r.amount))||`$${r.amount}`}),e.jsx(d,{children:V(r.status)}),e.jsx(d,{children:((D=window.appSettings)==null?void 0:D.formatDateTime(r.created_at,!1))||new Date(r.created_at).toLocaleDateString()}),c==="superadmin"&&r.status==="pending"&&e.jsx(d,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(n,{size:"sm",variant:"outline",onClick:()=>K(r),children:[e.jsx(se,{className:"h-4 w-4 mr-1"}),a("Approve")]}),e.jsxs(n,{size:"sm",variant:"outline",onClick:()=>{j(r),u(!0)},children:[e.jsx(re,{className:"h-4 w-4 mr-1"}),a("Reject")]})]})})]},r.id)})})]})})]}),e.jsx(P,{open:M,onOpenChange:u,children:e.jsxs(q,{children:[e.jsx(A,{children:e.jsx(_,{children:a("Reject Payout Request")})}),e.jsxs("form",{onSubmit:Q,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(T,{htmlFor:"notes",children:a("Rejection Reason")}),e.jsx(ce,{id:"notes",value:U.notes,onChange:r=>b("notes",r.target.value),placeholder:a("Enter reason for rejection...")})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(n,{type:"button",variant:"outline",onClick:()=>u(!1),children:a("Cancel")}),e.jsx(n,{type:"submit",variant:"destructive",disabled:G,children:a("Reject Request")})]})]})]})})]})}export{xe as default};
