import{r as l,j as e}from"./ui-C-VW1P-5.js";import{u as I,ai as j,ak as D,L as u,I as g,B as T,a6 as B,t as a,S as M}from"./app-BQKKzqf3.js";import{S as R}from"./switch-T0u5R7d_.js";import{A as q,a as K}from"./alert-Bt8OE1Tt.js";import{K as C,B as L}from"./key-D9NdYYsw.js";import{P as z}from"./phone-B9JuG5Em.js";import{M as G}from"./message-square-DJa7rgfT.js";import{S as k}from"./send-Ci4mpdkr.js";import{C as O}from"./circle-alert-Ba7f7jIF.js";import"./vendor-CxtKjBZA.js";import"./utils-DCj7OOX3.js";function se(){const{t}=I(),[w,N]=l.useState({}),[b,A]=l.useState([]),[h,v]=l.useState({twilio_sid:"",twilio_token:"",twilio_from:""}),[c,F]=l.useState(""),[y,f]=l.useState(!1),[p,n]=l.useState(null);l.useEffect(()=>{j.get(route("settings.twilio-notifications.available")).then(s=>{A(s.data)}).catch(s=>{console.error("Failed to load available notifications:",s)}),j.get(route("settings.twilio-notifications.get")).then(s=>{N(s.data)}).catch(s=>{console.error("Failed to load Twilio notification settings:",s)}),j.get(route("settings.twilio-config.get")).then(s=>{v(s.data)}).catch(s=>{console.error("Failed to load Twilio configuration:",s)})},[]);const _=(s,i)=>{N(o=>({...o,[s]:i}))},S=(s,i)=>{v(o=>({...o,[s]:i}))},E=s=>{s.preventDefault();const i={...w,...h};a.loading(t("Saving twilio settings...")),M.post(route("settings.twilio-notifications.update"),i,{preserveScroll:!0,onSuccess:o=>{var m,x;a.dismiss();const r=(m=o.props.flash)==null?void 0:m.success,d=(x=o.props.flash)==null?void 0:x.error;r?a.success(r):d?a.error(d):a.success("Twilio settings updated successfully.")},onError:()=>{a.error("Failed to update Twilio settings.")}})},P=s=>{if(s.preventDefault(),!c){a.error(t("Please enter a phone number"));return}f(!0),n(null),a.loading(t("Sending test SMS...")),M.post(route("settings.sms.test"),{phone:c},{preserveScroll:!0,onSuccess:i=>{var d,m;f(!1),a.dismiss();const o=(d=i.props.flash)==null?void 0:d.success,r=(m=i.props.flash)==null?void 0:m.error;if(o)a.success(o),n({success:!0,message:o});else if(r)a.error(r),n({success:!1,message:r});else{const x=t("Test SMS sent successfully to {{phone}}",{phone:c});a.success(x),n({success:!0,message:x})}setTimeout(()=>{n(null)},5e3)},onError:i=>{f(!1),a.dismiss();const o=i.error||Object.values(i).join(", ")||t("Failed to send test SMS");a.error(o),n({success:!1,message:o}),setTimeout(()=>{n(null)},5e3)}})};return e.jsx(D,{title:t("Twilio SMS Settings"),description:t("Configure Twilio settings for SMS notifications and communications"),action:e.jsxs(T,{onClick:E,size:"sm",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),t("Save Changes")]}),children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2 space-y-6",children:e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs(u,{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[e.jsx(C,{className:"h-4 w-4"}),t("Account SID")]}),e.jsx(g,{value:h.twilio_sid,onChange:s=>S("twilio_sid",s.target.value),placeholder:"ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",className:"font-mono"})]}),e.jsxs("div",{children:[e.jsxs(u,{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[e.jsx(C,{className:"h-4 w-4"}),t("Auth Token")]}),e.jsx(g,{type:"password",value:h.twilio_token,onChange:s=>S("twilio_token",s.target.value),placeholder:"••••••••••••••••••••",className:"font-mono"})]}),e.jsxs("div",{children:[e.jsxs(u,{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[e.jsx(z,{className:"h-4 w-4"}),t("From Phone Number")]}),e.jsx(g,{value:h.twilio_from,onChange:s=>S("twilio_from",s.target.value),placeholder:"+1234567890",className:"font-mono"})]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6 mt-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(G,{className:"h-5 w-5 text-blue-600"}),e.jsx("h3",{className:"font-medium text-blue-900",children:t("Twilio Setup Instructions")})]}),e.jsxs("ol",{className:"space-y-2 text-sm text-blue-800",children:[e.jsxs("li",{children:[t("1. Sign up for a Twilio account at")," ",e.jsxs("span",{className:"text-blue-600 underline",children:[e.jsx("a",{href:"https://www.twilio.com",children:"twilio.com"})," "]})]}),e.jsx("li",{children:t("2. Get your Account SID and Auth Token from the Twilio Console")}),e.jsx("li",{children:t("3. Purchase a phone number or use a trial number")}),e.jsx("li",{children:t("4. Enter your credentials and admin phone number")})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(L,{className:"h-5 w-5 text-emerald-500"}),e.jsx("h3",{className:"font-medium text-gray-900",children:t("SMS Notification Settings")})]}),b.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:b.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg",children:[e.jsx(u,{htmlFor:s.name,className:"text-sm font-medium",children:t(s.label)}),e.jsx(R,{id:s.name,checked:w[s.name]||!1,onCheckedChange:i=>_(s.name,i)})]},s.name))}):e.jsx("div",{className:"text-center py-8 text-gray-500",children:t("No notification template available")})]})}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 h-fit",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(k,{className:"h-4 w-4 text-emerald-500"}),e.jsx("h3",{className:"font-medium text-gray-900",children:t("Test SMS Configuration")})]}),e.jsxs("form",{onSubmit:P,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(u,{className:"text-sm font-medium text-gray-700 block",children:t("Send Test To")}),e.jsx(g,{value:c,onChange:s=>F(s.target.value),placeholder:"+1234567890",className:"font-mono",required:!0}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[t("Enter a phone number with country code")," ",t("e.g., +1234567890")]})]}),p&&e.jsxs(q,{variant:p.success?"default":"destructive",className:"py-2",children:[e.jsx(O,{className:"h-4 w-4"}),e.jsx(K,{children:p.message})]}),e.jsx(T,{type:"submit",className:"w-full bg-emerald-500 hover:bg-emerald-600 text-white",disabled:y||!c,children:y?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"animate-spin mr-2",children:"◌"}),t("Sending...")]}):e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),t("Send Test SMS")]})})]})]})]})})})}export{se as default};
