import{r as h,j as e}from"./ui-C-VW1P-5.js";import{u as E,k as I,B as N,C as F,a as L,b as T,c as A,L as C,I as $}from"./app-BQKKzqf3.js";import{l as q,E as B,u as D,a as O,C as w}from"./react-stripe.esm-DQmMnBY3.js";import{A as z}from"./arrow-left-CYc20UlY.js";import{C as P}from"./credit-card-CmRw-oUn.js";import{L as H}from"./loader-circle-DlS76Sc1.js";import"./vendor-CxtKjBZA.js";import"./utils-DCj7OOX3.js";const R=({invoice:r,amount:n,paymentType:m})=>{var o;const{t}=E(),a=D(),j=O(),[s,u]=h.useState(""),[l,d]=h.useState(!1),x=async f=>{var v;if(f.preventDefault(),!a||!j||!s.trim()){alert(t("Please fill in all required fields"));return}d(!0);const b=j.getElement(w);if(!b)return;const{error:y,paymentMethod:k}=await a.createPaymentMethod({type:"card",card:b,billing_details:{name:s}});if(y){alert(y.message||t("Payment failed")),d(!1);return}const i=document.createElement("form");i.method="POST",i.action=route("invoice.stripe.payment");const g=(v=document.querySelector('meta[name="csrf-token"]'))==null?void 0:v.getAttribute("content");if(g){const c=document.createElement("input");c.type="hidden",c.name="_token",c.value=g,i.appendChild(c)}const S={payment_method_id:k.id,cardholder_name:s,invoice_id:r.id,amount:n,payment_type:m};Object.entries(S).forEach(([c,_])=>{const p=document.createElement("input");p.type="hidden",p.name=c,p.value=_.toString(),i.appendChild(p)}),document.body.appendChild(i),i.submit()};return e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"cardholder-name",children:t("Name on card")}),e.jsx($,{id:"cardholder-name",type:"text",value:s,onChange:f=>u(f.target.value),placeholder:t("Enter cardholder name"),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:t("Card details")}),e.jsx("div",{className:"p-3 border rounded-md",children:e.jsx(w,{})})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(N,{type:"button",variant:"outline",onClick:()=>window.location.href=route("invoices.public",r.id),disabled:l,className:"flex-1",children:t("Cancel")}),e.jsx(N,{type:"submit",disabled:!a||l,className:"flex-1",children:l?e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"h-4 w-4 mr-2 animate-spin"}),t("Processing...")]}):t("Pay {{amount}}",{amount:((o=window.appSettings)==null?void 0:o.formatCurrency(Number(n||0)))||`$${Number(n||0).toFixed(2)}`})})]})]})};function X({invoice:r,paymentMethod:n,amount:m,paymentType:t,paymentSettings:a,currency:j}){const{t:s}=E(),[u,l]=h.useState(null);h.useEffect(()=>{n==="stripe"&&a.key&&l(q(a.key))},[n,a]);const d=x=>{var o;return((o=window.appSettings)==null?void 0:o.formatCurrency(Number(x||0)))||`$${Number(x||0).toFixed(2)}`};return e.jsxs(e.Fragment,{children:[e.jsx(I,{title:s("Pay Invoice {{invoiceNumber}}",{invoiceNumber:r.invoice_number})}),e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-2xl mx-auto px-4",children:[e.jsx("div",{className:"mb-6",children:e.jsxs(N,{variant:"outline",onClick:()=>window.location.href=route("invoices.public",r.id),className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-4 h-4"}),s("Back to Invoice")]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border mb-6",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(P,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:s("Payment for Invoice #{{invoiceNumber}}",{invoiceNumber:r.invoice_number})}),e.jsx("p",{className:"text-gray-600",children:r.name})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:s("Payment Type")}),e.jsx("p",{className:"font-semibold capitalize",children:s("{{paymentType}} Payment",{paymentType:t})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:s("Amount")}),e.jsx("p",{className:"font-semibold",children:d(m)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:s("Total Invoice")}),e.jsx("p",{className:"font-semibold",children:d(r.total_amount)})]})]})]})}),e.jsxs(F,{children:[e.jsx(L,{children:e.jsxs(T,{className:"flex items-center gap-2",children:[e.jsx(P,{className:"w-5 h-5"}),s("Payment Details")]})}),e.jsx(A,{children:n==="stripe"&&a.key&&u?e.jsx(B,{stripe:u,children:e.jsx(R,{invoice:r,amount:m,paymentType:t})}):e.jsx("div",{className:"p-4 text-center text-red-500",children:s("Payment method not configured")})})]})]})})]})}export{X as default};
