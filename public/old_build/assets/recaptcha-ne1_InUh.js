import{r as d,j as w}from"./ui-C-VW1P-5.js";import{K as f}from"./app-BQKKzqf3.js";function g(){const{settings:c={}}=f().props,p=c.recaptchaEnabled==="true"||c.recaptchaEnabled===!0||c.recaptchaEnabled===1||c.recaptchaEnabled==="1",r=c.recaptchaVersion||"v2",t=c.recaptchaSiteKey||"";return{recaptchaEnabled:p,recaptchaVersion:r,recaptchaSiteKey:t}}function y({onVerify:c,onExpired:p,onError:r}){const t=d.useRef(null),n=d.useRef(null),{recaptchaEnabled:s,recaptchaVersion:i,recaptchaSiteKey:a}=g();return d.useEffect(()=>{if(!s||!a)return;const h=()=>{try{i==="v2"?l():u()}catch(e){console.error("ReCaptcha load error:",e),r&&r()}},l=()=>{if(window.grecaptcha&&window.grecaptcha.render&&t.current)try{if(n.current!==null){window.grecaptcha.reset(n.current);return}if(t.current.hasChildNodes())return;n.current=window.grecaptcha.render(t.current,{sitekey:a,callback:c,"expired-callback":p||(()=>{}),"error-callback":r||(()=>{})})}catch(e){console.error("ReCaptcha v2 render error:",e)}},u=()=>{if(window.grecaptcha&&window.grecaptcha.ready)try{window.grecaptcha.ready(()=>{window.grecaptcha.execute(a,{action:"submit"}).then(e=>{c(e)}).catch(e=>{console.error("ReCaptcha v3 execute error:",e),r&&r()})})}catch(e){console.error("ReCaptcha v3 ready error:",e)}};if(window.grecaptcha&&window.grecaptcha.render)h();else{if(document.querySelector('script[src*="google.com/recaptcha"]')){window.onRecaptchaLoad=h;return}window.onRecaptchaLoad=h;const o=document.createElement("script");o.src=`https://www.google.com/recaptcha/api.js?onload=onRecaptchaLoad&render=${i==="v3"?a:"explicit"}`,o.async=!0,o.defer=!0,o.onerror=()=>{console.error("Failed to load ReCaptcha script"),r&&r()},document.head.appendChild(o)}return()=>{try{n.current!==null&&window.grecaptcha&&window.grecaptcha.reset&&window.grecaptcha.reset(n.current)}catch(e){console.error("ReCaptcha cleanup error:",e)}}},[s,i,a]),!s||!a?null:i==="v2"?w.jsx("div",{ref:t}):null}export{y as R,g as u};
