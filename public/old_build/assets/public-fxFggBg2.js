import{r as _,j as e}from"./ui-C-VW1P-5.js";import{u as ee,K as te,t as B,k as se,h as ae,d as re}from"./app-BQKKzqf3.js";import M from"./Template1-anPZeVzs.js";import ie from"./Template2-EZOat_u9.js";import le from"./Template3-DlPUGTqk.js";import ne from"./Template4-DWfsBKSA.js";import oe from"./Template5-fO6pdQZ8.js";import de from"./Template6-CJvwboVz.js";import me from"./Template7--VDUjNgB.js";import ce from"./Template8-CwwL9PyY.js";import xe from"./Template9-BeWmvPPg.js";import he from"./Template10-Czrofriy.js";import{I as pe}from"./IframePortal-BwGjSup1.js";import{C as ge}from"./copy-D-hAzd4M.js";import{P as ue}from"./printer-CMSe0GyN.js";import{D as be}from"./dollar-sign-BO1aYhXH.js";import{P as T}from"./package-BHhWwbAI.js";import{C as E}from"./calendar-BZ7v_rN9.js";import{T as fe}from"./truck--5x8h15q.js";import{B as je}from"./building-DYqVTalU.js";import{U as Ne}from"./user-B-NTs7Zv.js";import"./vendor-CxtKjBZA.js";import"./utils-DCj7OOX3.js";import"./QRCodeComponent-CRXf3pHS.js";const ye={template1:M,template2:ie,template3:le,template4:ne,template5:oe,template6:de,template7:me,template8:ce,template9:xe,template10:he};function Ke({salesOrder:a,templateId:F="template1",color:H="ffffff",qrEnabled:Q=!1,settings:z={},themeColor:C="blue",customColor:G=null}){var q,I,U,L,R;const{t}=ee(),{props:c}=te(),[D,S]=_.useState(!1),j=c.auth||{},J=(j==null?void 0:j.permissions)||[];_.useEffect(()=>{var s,r;(s=c.flash)!=null&&s.success&&B.success(t(c.flash.success)),(r=c.flash)!=null&&r.error&&B.error(t(c.flash.error))},[c.flash,t]);const N=C==="custom"?G:{blue:"#3b82f6",green:"#10b77f",purple:"#8b5cf6",orange:"#f97316",red:"#ef4444"}[C]||"#3b82f6",i={primary:N,secondary:N},l=s=>{var r;return((r=window.appSettings)==null?void 0:r.formatCurrency(Number(s||0)))||`$${Number(s||0).toFixed(2)}`},x=s=>{var r;return s?((r=window.appSettings)==null?void 0:r.formatDateTime(s,!1))||new Date(s).toLocaleDateString():t("-")},K=()=>{var o;let s=0,r=0,n=0;return(o=a.products)==null||o.forEach(d=>{const m=Number(d.pivot.total_price)||0,p=Number(d.pivot.discount_amount)||0,h=m-p;s+=h,n+=p,d.tax&&(r+=h*Number(d.tax.rate)/100)}),{subtotal:s,totalTax:r,totalDiscount:n,grandTotal:s+r}},{subtotal:k,totalTax:y,totalDiscount:u,grandTotal:P}=K(),V=a.products.map(s=>{var m;const r=s.pivot.quantity*s.pivot.unit_price,n=s.pivot.discount_amount||0,o=r-n,d=s.tax?o*s.tax.rate/100:0;return{name:s.name,quantity:s.pivot.quantity,price:s.pivot.unit_price,tax:((m=s.tax)==null?void 0:m.rate)||0,discount:n,itemTax:s.tax?[{name:s.tax.name,rate:`${s.tax.rate}%`,price:l(d)}]:[]}}),W=a.products.reduce((s,r)=>{if(r.tax){const n=r.pivot.quantity*r.pivot.unit_price,o=r.pivot.discount_amount||0,m=(n-o)*r.tax.rate/100;s[r.tax.name]=(s[r.tax.name]||0)+m}return s},{}),X={...a,sales_order_number:a.order_number,order_date:x(a.order_date||new Date().toISOString()),delivery_date:x(a.delivery_date||new Date().toISOString()),sub_total:k,total_tax:y,total_amount:P,totalQuantity:a.products.reduce((s,r)=>s+r.pivot.quantity,0),totalRate:a.products.reduce((s,r)=>s+r.pivot.quantity*r.pivot.unit_price,0),totalTaxPrice:y,totalDiscount:u,total_discount:u},Y=ye[F]||M,A=_.useRef(null),Z=()=>{var s;(s=A.current)==null||s.print()},O=async()=>{try{await navigator.clipboard.writeText(window.location.href),S(!0),setTimeout(()=>S(!1),2e3)}catch(s){console.error("Failed to copy link:",s)}},$=s=>{const r={draft:"bg-gray-50 text-gray-600 ring-gray-500/10",confirmed:"bg-blue-50 text-blue-700 ring-blue-700/10",processing:"bg-yellow-50 text-yellow-800 ring-yellow-600/20",shipped:"bg-purple-50 text-purple-700 ring-purple-700/10",delivered:"bg-green-50 text-green-700 ring-green-600/20",cancelled:"bg-red-50 text-red-700 ring-red-600/10"};return e.jsx("span",{className:`inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset ${r[s]||r.draft}`,children:t((s==null?void 0:s.charAt(0).toUpperCase())+(s==null?void 0:s.slice(1)))||t("Draft")})};return e.jsxs(e.Fragment,{children:[e.jsx(se,{title:t("Sales Order {{orderNumber}}",{orderNumber:a.order_number})}),e.jsx("div",{className:"min-h-screen bg-gray-50 dark:from-gray-900 dark:to-gray-800 py-8 print:p-0 print:m-0 print:bg-white",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 print-container",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8 print:hidden",children:[e.jsxs("div",{className:"mb-4 sm:mb-0",children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:[t("Sales Order Details")," - ",a.order_number]}),e.jsx("p",{className:"text-gray-600 mt-1",children:t("View your sales order")})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[ae(J,"view-sales-orders")&&e.jsxs("button",{onClick:O,className:"inline-flex items-center px-4 py-2.5 bg-white border border-gray-200 rounded-xl text-sm font-medium text-gray-700 hover:bg-gray-50 hover:border-gray-300 transition-all duration-200 shadow-sm hover:shadow-md",children:[D?e.jsx(re,{className:"w-4 h-4 mr-2 text-green-600"}):e.jsx(ge,{className:"w-4 h-4 mr-2"}),t(D?"Copied!":"Copy Link")]}),e.jsxs("button",{onClick:Z,className:"inline-flex items-center px-4 py-2.5 text-white rounded-xl text-sm font-medium transition-all duration-200 shadow-sm hover:shadow-md",style:{backgroundColor:N,":hover":{filter:"brightness(0.9)"}},children:[e.jsx(ue,{className:"w-4 h-4 mr-2"}),t("Print Sales Order")]})]})]}),e.jsx("div",{className:"hidden print:block",children:e.jsx(pe,{ref:A,children:e.jsx(Y,{salesOrder:X,items:V,taxesData:W,settings:z,color:H,qr_invoice:Q?"on":"off"})})}),e.jsxs("div",{className:"mx-auto space-y-6 print:hidden",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm border p-8 print:hidden",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-lg font-bold text-gray-900 leading-tight",children:a.name}),e.jsx("p",{className:"text-base text-gray-600 mt-2 leading-relaxed max-w-3xl",children:a.description||t("No description provided")})]}),e.jsxs("div",{className:"text-right ml-6",children:[$(a.status),e.jsx("p",{className:"text-sm font-medium text-gray-700 mt-2 font-mono",children:a.order_number})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx("div",{className:"border-l-4 hover:shadow-lg transition-shadow bg-white rounded-lg shadow-sm border",style:{borderLeftColor:i.primary},children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase tracking-wide",children:t("Total Amount")}),e.jsx("h3",{className:"mt-2 text-2xl font-bold leading-none",style:{color:i.primary},children:l(a.total_amount)})]}),e.jsx("div",{className:"rounded-full p-4",style:{backgroundColor:`${i.primary}15`},children:e.jsx(be,{className:"h-5 w-5",style:{color:i.primary}})})]})})}),e.jsx("div",{className:"border-l-4 hover:shadow-lg transition-shadow bg-white rounded-lg shadow-sm border",style:{borderLeftColor:i.secondary},children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase tracking-wide",children:t("Products")}),e.jsx("h3",{className:"mt-2 text-2xl font-bold leading-none",style:{color:i.secondary},children:((q=a.products)==null?void 0:q.length)||0})]}),e.jsx("div",{className:"rounded-full p-4",style:{backgroundColor:`${i.secondary}15`},children:e.jsx(T,{className:"h-5 w-5",style:{color:i.secondary}})})]})})}),e.jsx("div",{className:"border-l-4 border-l-orange-500 hover:shadow-lg transition-shadow bg-white rounded-lg shadow-sm border",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase tracking-wide",children:t("Order Date")}),e.jsx("h3",{className:"mt-2 text-lg font-bold text-orange-600 leading-tight",children:x(a.order_date)})]}),e.jsx("div",{className:"rounded-full bg-orange-100 p-4",children:e.jsx(E,{className:"h-5 w-5 text-orange-600"})})]})})}),e.jsx("div",{className:"border-l-4 border-l-purple-500 hover:shadow-lg transition-shadow bg-white rounded-lg shadow-sm border",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase tracking-wide",children:t("Delivery Date")}),e.jsx("h3",{className:"mt-2 text-lg font-bold text-purple-600 leading-tight",children:x(a.delivery_date)})]}),e.jsx("div",{className:"rounded-full bg-purple-100 p-4",children:e.jsx(fe,{className:"h-5 w-5 text-purple-600"})})]})})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[e.jsx("div",{className:"bg-gray-50 border-b px-6 py-4",children:e.jsx("h3",{className:"text-lg font-semibold",children:t("Sales Order Information")})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:t("Order Number")}),e.jsx("p",{className:"text-sm mt-1",children:a.order_number})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:t("Status")}),e.jsx("div",{className:"mt-1",children:$(a.status)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:t("Created By")}),e.jsx("p",{className:"text-sm mt-1",children:((I=a.creator)==null?void 0:I.name)||t("-")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:t("Assigned To")}),e.jsx("p",{className:"text-sm mt-1",children:((U=a.assignedUser)==null?void 0:U.name)||t("Unassigned")})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:t("Subtotal")}),e.jsx("p",{className:"text-sm mt-1",children:l(a.subtotal)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:t("Discount Amount")}),e.jsxs("p",{className:"text-sm mt-1",children:["-",l(u)]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:t("Created At")}),e.jsx("p",{className:"text-sm mt-1",children:x(a.created_at)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:t("Updated At")}),e.jsx("p",{className:"text-sm mt-1",children:x(a.updated_at)})]})]})]})})]}),(a.account||a.quote||a.shipping_provider_type)&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[e.jsx("div",{className:"bg-gray-50 border-b px-6 py-4",children:e.jsxs("h3",{className:"flex items-center text-lg font-semibold",children:[e.jsx(je,{className:"h-5 w-5 mr-3 text-muted-foreground"}),t("Related Data")]})}),e.jsx("div",{className:"p-8",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.account&&e.jsxs("div",{className:"p-6 bg-green-50 rounded-xl border border-green-200 hover:shadow-md transition-shadow",children:[e.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase tracking-wide mb-2",children:t("Account")}),e.jsx("p",{className:"text-base font-medium text-green-700",children:a.account.name})]}),a.quote&&e.jsxs("div",{className:"p-6 bg-purple-50 rounded-xl border border-purple-200 hover:shadow-md transition-shadow",children:[e.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase tracking-wide mb-2",children:t("Quote")}),e.jsx("p",{className:"text-base font-medium text-purple-700",children:a.quote.name})]}),a.shipping_provider_type&&e.jsxs("div",{className:"p-6 bg-orange-50 rounded-xl border border-orange-200 hover:shadow-md transition-shadow",children:[e.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase tracking-wide mb-2",children:t("Shipping Provider")}),e.jsx("p",{className:"text-base font-medium text-orange-700",children:a.shipping_provider_type.name})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[e.jsx("div",{className:"bg-gray-50 border-b px-6 py-4",children:e.jsxs("h3",{className:"flex items-center text-lg font-semibold",children:[e.jsx(Ne,{className:"h-5 w-5 mr-3 text-muted-foreground"}),t("Billing & Shipping Details")]})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 pb-2 border-b border-gray-200",children:t("Billing Details")}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:t("Contact")}),e.jsx("p",{className:"text-sm mt-1",children:((L=a.billing_contact)==null?void 0:L.name)||t("-")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:t("Address")}),e.jsx("p",{className:"text-sm mt-1",children:a.billing_address||t("-")})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:t("City")}),e.jsx("p",{className:"text-sm mt-1",children:a.billing_city||t("-")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:t("State")}),e.jsx("p",{className:"text-sm mt-1",children:a.billing_state||t("-")})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:t("Postal Code")}),e.jsx("p",{className:"text-sm mt-1",children:a.billing_postal_code||t("-")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:t("Country")}),e.jsx("p",{className:"text-sm mt-1",children:a.billing_country||t("-")})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 pb-2 border-b border-gray-200",children:t("Shipping Details")}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:t("Contact")}),e.jsx("p",{className:"text-sm mt-1",children:((R=a.shipping_contact)==null?void 0:R.name)||t("-")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:t("Address")}),e.jsx("p",{className:"text-sm mt-1",children:a.shipping_address||t("-")})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:t("City")}),e.jsx("p",{className:"text-sm mt-1",children:a.shipping_city||t("-")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:t("State")}),e.jsx("p",{className:"text-sm mt-1",children:a.shipping_state||t("-")})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:t("Postal Code")}),e.jsx("p",{className:"text-sm mt-1",children:a.shipping_postal_code||t("-")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:t("Country")}),e.jsx("p",{className:"text-sm mt-1",children:a.shipping_country||t("-")})]})]})]})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[e.jsx("div",{className:"bg-gray-50 border-b px-6 py-4",children:e.jsxs("h3",{className:"flex items-center text-lg font-semibold",children:[e.jsx(T,{className:"h-5 w-5 mr-3 text-muted-foreground"}),t("Products")]})}),e.jsx("div",{className:"p-0",children:a.products&&a.products.length>0?e.jsx("div",{className:"overflow-hidden",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:i.primary},children:[e.jsx("th",{className:"text-base font-bold text-white py-4 px-6 w-1/3 text-left",children:t("Product")}),e.jsx("th",{className:"text-right text-base font-bold text-white py-4 px-4",children:t("Quantity")}),e.jsx("th",{className:"text-right text-base font-bold text-white py-4 px-4",children:t("Unit Price")}),e.jsx("th",{className:"text-right text-base font-bold text-white py-4 px-4",children:t("Discount")}),e.jsx("th",{className:"text-right text-base font-bold text-white py-4 px-4",children:t("Tax")}),e.jsx("th",{className:"text-right text-base font-bold text-white py-4 px-4 w-1/6",children:t("Total")})]})}),e.jsxs("tbody",{children:[a.products.map((s,r)=>{const n=Number(s.pivot.total_price)||0,o=Number(s.pivot.discount_amount)||0,d=n-o;return e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"font-semibold text-base text-gray-900 py-4 px-6",children:s.name}),e.jsx("td",{className:"text-right text-base font-medium py-4 px-4",children:s.pivot.quantity}),e.jsx("td",{className:"text-right text-base font-semibold py-4 px-4",children:l(s.pivot.unit_price)}),e.jsx("td",{className:"text-right py-4 px-4",children:s.pivot.discount_type&&s.pivot.discount_type!=="none"&&s.pivot.discount_value>0?e.jsxs("div",{className:"text-base",children:[e.jsx("div",{className:"font-semibold text-gray-700",children:s.pivot.discount_type==="percentage"?`${Number(s.pivot.discount_value)}%`:l(Number(s.pivot.discount_value))}),e.jsxs("div",{className:"text-red-600 font-bold",children:["(-",l(o),")"]})]}):e.jsx("span",{className:"text-gray-500 font-medium",children:"-"})}),e.jsx("td",{className:"text-right text-base py-4 px-4",children:s.tax?e.jsxs("div",{className:"text-base",children:[e.jsx("div",{className:"font-semibold text-gray-700",children:s.tax.name}),e.jsxs("div",{className:"text-gray-600 font-medium",children:["(",s.tax.rate,"%)"]})]}):e.jsx("span",{className:"text-gray-500 font-medium",children:t("No Tax")})}),e.jsx("td",{className:"text-right font-bold text-base py-4 px-4",children:o>0?e.jsxs("div",{children:[e.jsx("div",{className:"line-through text-gray-400 text-sm font-medium",children:l(n)}),e.jsx("div",{className:"text-green-600 font-semibold",children:l(d)})]}):e.jsx("span",{className:"text-green-600 font-semibold",children:l(n)})})]},r)}),e.jsxs("tr",{style:{backgroundColor:`${i.primary}10`},children:[e.jsxs("td",{colSpan:5,className:"text-right font-semibold text-base py-3 px-4",style:{color:i.primary},children:[t("Total Discount"),":"]}),e.jsxs("td",{className:"text-right font-semibold text-base py-3 px-4",style:{color:i.primary},children:["-",l(u)]})]}),e.jsxs("tr",{style:{backgroundColor:`${i.primary}10`},children:[e.jsxs("td",{colSpan:5,className:"text-right font-semibold text-base py-3 px-4",style:{color:i.primary},children:[t("Subtotal"),":"]}),e.jsx("td",{className:"text-right font-semibold text-base py-3 px-4",style:{color:i.primary},children:l(k)})]}),e.jsxs("tr",{style:{backgroundColor:`${i.primary}10`},children:[e.jsxs("td",{colSpan:5,className:"text-right font-semibold text-base py-3 px-4",style:{color:i.primary},children:[t("Total Tax"),":"]}),e.jsx("td",{className:"text-right font-semibold text-base py-3 px-4",style:{color:i.primary},children:l(y)})]}),e.jsxs("tr",{className:"border-t-2",style:{backgroundColor:`${i.primary}15`,borderTopColor:i.primary},children:[e.jsxs("td",{colSpan:5,className:"text-right font-bold text-lg py-4 px-4",style:{color:i.primary},children:[t("Grand Total"),":"]}),e.jsx("td",{className:"text-right py-4 px-4",children:e.jsx("span",{className:"font-bold text-xl",style:{color:i.primary},children:l(P)})})]})]})]})}):e.jsxs("div",{className:"text-center py-16 text-gray-500",children:[e.jsx(T,{className:"h-16 w-16 mx-auto mb-6 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium",children:t("No products added to this sales order")})]})})]}),a.notes&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:t("Notes")}),e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:a.notes})]}),a.activities&&a.activities.length>0&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[e.jsx("div",{className:"bg-gray-50 border-b px-6 py-4",children:e.jsxs("h3",{className:"flex items-center text-lg font-semibold",children:[e.jsx(E,{className:"h-5 w-5 mr-3 text-muted-foreground"}),t("Activity Stream")]})}),e.jsx("div",{className:"p-6 max-h-96 overflow-y-auto",children:e.jsx("div",{className:"space-y-2",children:a.activities.map((s,r)=>{var o,d,m,p;const n=h=>{const b=new Date(h),g=Math.floor((new Date().getTime()-b.getTime())/(1e3*60));if(g<1)return t("Just now");if(g<60)return t("{{count}} {{unit}} ago",{count:g,unit:t(g===1?"minute":"minutes")});const f=Math.floor(g/60);if(f<24)return t("{{count}} {{unit}} ago",{count:f,unit:t(f===1?"hour":"hours")});const w=Math.floor(f/24);return w<7?t("{{count}} {{unit}} ago",{count:w,unit:t(w===1?"day":"days")}):b.toLocaleDateString()};return e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full overflow-hidden border-2 border-gray-200",children:e.jsx("img",{src:((o=s.user)==null?void 0:o.avatar)||"/images/avatar/default.png",alt:((d=s.user)==null?void 0:d.name)||"User",className:"w-full h-full object-cover",onError:h=>{var v;const b=h.target;b.src=`https://ui-avatars.com/api/?name=${encodeURIComponent(((v=s.user)==null?void 0:v.name)||"User")}&background=e5e7eb&color=374151&size=32`}})}),r<a.activities.length-1&&e.jsx("div",{className:"w-px h-8 bg-gray-200 mt-2"})]}),e.jsxs("div",{className:"flex-1 min-w-0 pb-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs text-gray-400",children:((m=s.user)==null?void 0:m.name)||t("System")}),e.jsx("span",{className:"text-xs text-gray-500 font-medium",children:n(s.created_at)})]}),e.jsxs("div",{className:"bg-white border rounded-lg p-3 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",dangerouslySetInnerHTML:{__html:s.title.replace(new RegExp(`^(${((p=s.user)==null?void 0:p.name)||"System"})`,"g"),'<span class="font-bold text-sm">$1</span>')}}),e.jsx("span",{className:"inline-flex items-center rounded-md px-2 py-1 text-xs font-medium bg-gray-50 text-gray-700 ring-1 ring-inset ring-gray-600/20",children:s.activity_type.charAt(0).toUpperCase()+s.activity_type.slice(1)})]}),s.description&&e.jsx("div",{className:"mb-2",children:s.field_changed==="status"||s.field_changed==="name"||s.field_changed==="assigned_to"||s.description.includes("into")?e.jsx("p",{className:"text-sm text-gray-600",dangerouslySetInnerHTML:{__html:s.description}}):e.jsx("p",{className:"text-sm text-gray-600",children:s.description})})]})]})]},s.id||r)})})})]})]})]})})]})}export{Ke as default};
