import{r as y,j as e}from"./ui-C-VW1P-5.js";import{P as A}from"./page-template-CDM26U5Q.js";import{u as O,K as F,S as u,B as E,D as B,l as I,n as R,o as $}from"./app-BQKKzqf3.js";import{P as z}from"./pagination-mhOv5uX0.js";import{S as J}from"./search-and-filter-bar-CB2HkcPS.js";import{E as M}from"./eye-DxUCHEvv.js";import"./vendor-CxtKjBZA.js";import"./textarea-BvlD1v8z.js";import"./select-ivmaqUw7.js";import"./index-IS-ASe-l.js";import"./chevron-up-5kET5X99.js";import"./react-country-flag.esm-B_SRkH7q.js";import"./language-BbwPiY59.js";import"./loader-circle-DlS76Sc1.js";import"./copy-D-hAzd4M.js";import"./language-switcher-BX314FqS.js";import"./switch-T0u5R7d_.js";import"./refresh-cw-BnxOCyDc.js";import"./globe-BSt65iB3.js";import"./settings-G3vQs6CU.js";import"./chevron-right-C7M1oeKV.js";import"./credit-card-CmRw-oUn.js";import"./dollar-sign-BO1aYhXH.js";import"./mail-DI9tSiFs.js";import"./users-CrY8npWB.js";import"./package-BHhWwbAI.js";import"./calendar-BZ7v_rN9.js";import"./phone-B9JuG5Em.js";import"./trending-up-BUQ_r1Kz.js";import"./user-B-NTs7Zv.js";import"./use-favicon-D-Hpb8YY.js";import"./utils-DCj7OOX3.js";import"./grid-3x3-B93v7dH2.js";import"./list-D15qstQa.js";function be({loginHistories:a,filters:o={}}){var w,j,v,N,k;const{t:s}=O(),[l,b]=y.useState(o.search||""),[S,g]=y.useState(!1),[f,D]=y.useState(null),{auth:i}=F().props,P=[{title:s("Dashboard"),href:route("dashboard")},((w=i==null?void 0:i.user)==null?void 0:w.type)==="superadmin"||((j=i==null?void 0:i.user)==null?void 0:j.type)==="super admin"?{title:s("Companies"),href:route("companies.index")}:{title:s("User"),href:route("users.index")},{title:s("User Logs")}],_=t=>{t.preventDefault(),L()},L=()=>{const t={page:1};l&&(t.search=l),o.per_page&&(t.per_page=o.per_page),u.get(route("users.all-logs"),t,{preserveState:!0,preserveScroll:!0})},C=t=>{if(!t)return{location:"-",device:"-"};let r=t;if(typeof t=="string")try{r=JSON.parse(t)}catch{return{location:"-",device:"-"}}const d=[];r.city&&d.push(r.city),r.regionName&&d.push(r.regionName),r.country&&d.push(r.country);const x=d.length>0?d.join(", "):r.query||"-",n=r.browser_name||"",p=r.os_name||"",m=r.device_type||"";let c="";return n&&p?(c=`${n} on ${p}`,m&&(c+=` (${m})`)):n?c=n:p?c=p:c="-",{location:x,device:c}},T=t=>{D(t.details),g(!0)},U=t=>{if(!t)return{};let r=t;if(typeof t=="string")try{r=JSON.parse(t)}catch{return{}}return r};return e.jsxs(A,{title:s("User Logs"),url:"/users-logs",breadcrumbs:P,noPadding:!0,children:[e.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow mb-4 p-4",children:e.jsx(J,{searchTerm:l,onSearchChange:b,onSearch:_,filters:[],showFilters:!1,setShowFilters:()=>{},hasActiveFilters:()=>!1,activeFilterCount:()=>0,onResetFilters:()=>{},currentPerPage:((v=o.per_page)==null?void 0:v.toString())||"10",onPerPageChange:t=>{const r={page:1,per_page:parseInt(t)};l&&(r.search=l),u.get(route("users.all-logs"),r,{preserveState:!0,preserveScroll:!0})}})}),e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:s("User")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:s("IP Address")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:s("Location & Device")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:s("Role")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:s("Time")}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:s("Actions")})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",children:(N=a==null?void 0:a.data)==null?void 0:N.map(t=>{var x,n,p,m,c,h;const{location:r,device:d}=C(t.details);return e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:((x=t.user)==null?void 0:x.name)||"Unknown User"}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:((n=t.user)==null?void 0:n.email)||"-"})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:t.ip}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:r}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:d})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:((c=(m=(p=t.user)==null?void 0:p.roles)==null?void 0:m[0])==null?void 0:c.name)||t.type||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:((h=window.appSettings)==null?void 0:h.formatDateTime(t.created_at))||new Date(t.created_at).toLocaleString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:e.jsx(E,{variant:"ghost",size:"sm",onClick:()=>T(t),className:"text-blue-500 hover:text-blue-700",children:e.jsx(M,{className:"h-4 w-4"})})})]},t.id)})})]})}),((k=a==null?void 0:a.data)==null?void 0:k.length)===0&&e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:s("No user logs found.")})}),e.jsx(z,{from:(a==null?void 0:a.from)||0,to:(a==null?void 0:a.to)||0,total:(a==null?void 0:a.total)||0,links:a==null?void 0:a.links,entityName:s("logs"),onPageChange:t=>u.get(t)})]}),e.jsx(B,{open:S,onOpenChange:g,children:e.jsxs(I,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsx(R,{children:e.jsx($,{children:s("Login Details")})}),e.jsx("div",{className:"space-y-4",children:f&&Object.entries(U(f)).map(([t,r])=>e.jsxs("div",{className:"grid grid-cols-3 gap-4 py-2 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-300 capitalize",children:t.replace(/_/g," ")}),e.jsx("div",{className:"col-span-2 text-gray-900 dark:text-white break-all",children:r!=null?String(r):"-"})]},t))})]})})]})}export{be as default};
