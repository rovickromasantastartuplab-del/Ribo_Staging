import{r as d,j as e}from"./ui-C-VW1P-5.js";import{u as q,ak as Q,aa as w,s as M,v as E,B as x,w as L,T as $,D as J,l as K,n as X,o as Y,L as y,I as Z,P as _,ai as C,t as g}from"./app-BQKKzqf3.js";import{S as O,a as W,b as A,c as I,d as l}from"./select-ivmaqUw7.js";import{T as ee,a as se,b as v,c as p,d as ae,e as j}from"./table-Cm3ifs76.js";import{C as te}from"./CrudDeleteModal-Bjo4FQXD.js";import{L as re}from"./link-2-ZacHXNCA.js";import{S as le}from"./square-pen-DbvvCy40.js";import"./vendor-CxtKjBZA.js";import"./utils-DCj7OOX3.js";import"./index-IS-ASe-l.js";import"./chevron-up-5kET5X99.js";function pe({webhooks:P=[]}){const{t:s}=q(),[k,b]=d.useState(P),[z,c]=d.useState(!1),[h,T]=d.useState(null),[F,f]=d.useState(!1),[o,N]=d.useState(null),[m,u]=d.useState({module:"",method:"GET",url:""}),S=()=>{u({module:"",method:"GET",url:""}),T(null)},G=()=>{S(),c(!0)},U=a=>{u({module:a.module,method:a.method,url:a.url}),T(a),c(!0)},R=async a=>{var t,i;a.preventDefault();try{if(h){const r=await C.put(route("settings.webhooks.update",h.id),m);b(n=>n.map(D=>D.id===h.id?r.data.webhook:D)),g.success(r.data.message)}else{const r=await C.post(route("settings.webhooks.store"),m);b(n=>[...n,r.data.webhook]),g.success(r.data.message)}c(!1),S()}catch(r){const n=((i=(t=r.response)==null?void 0:t.data)==null?void 0:i.message)||s("An error occurred");g.error(n)}},B=a=>{N(a),f(!0)},H=async()=>{var a,t;if(o)try{const i=await C.delete(route("settings.webhooks.destroy",o.id));b(r=>r.filter(n=>n.id!==o.id)),g.success(i.data.message)}catch(i){const r=((t=(a=i.response)==null?void 0:a.data)==null?void 0:t.message)||s("An error occurred");g.error(r)}finally{f(!1),N(null)}},V=()=>{f(!1),N(null)};return e.jsx(Q,{title:s("Webhook Settings"),description:s("Manage webhooks for external integrations"),action:e.jsxs(x,{onClick:G,size:"sm",children:[e.jsx(_,{className:"h-4 w-4 mr-2"}),s("Add Webhook")]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs(ee,{children:[e.jsx(se,{children:e.jsxs(v,{className:"bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700",children:[e.jsx(p,{className:"py-2.5 font-semibold",children:s("Module")}),e.jsx(p,{className:"py-2.5 font-semibold",children:s("Method")}),e.jsx(p,{className:"py-2.5 font-semibold",children:s("URL")}),e.jsx(p,{className:"w-24 py-2.5 font-semibold text-right",children:s("Actions")})]})}),e.jsx(ae,{children:k.length===0?e.jsx(v,{children:e.jsx(j,{colSpan:4,className:"h-24 text-center text-muted-foreground dark:text-gray-400",children:s("No webhooks configured")})}):k.map(a=>e.jsxs(v,{className:"hover:bg-gray-50 dark:hover:bg-gray-700 border-b dark:border-gray-700 dark:bg-gray-900",children:[e.jsx(j,{className:"py-2.5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(re,{className:"h-4 w-4 mr-2 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:a.module})]})}),e.jsx(j,{className:"py-2.5",children:e.jsx("span",{className:`inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset ${a.method==="GET"?"bg-blue-50 text-blue-700 ring-blue-700/10 dark:bg-blue-900/30 dark:text-blue-400 dark:ring-blue-400/30":"bg-green-50 text-green-700 ring-green-700/10 dark:bg-green-900/30 dark:text-green-400 dark:ring-green-400/30"}`,children:a.method})}),e.jsx(j,{className:"py-2.5",children:e.jsx("div",{className:"max-w-xs truncate text-sm font-mono text-muted-foreground dark:text-gray-400",children:a.url})}),e.jsx(j,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx(w,{children:e.jsxs(M,{children:[e.jsx(E,{asChild:!0,children:e.jsx(x,{variant:"ghost",size:"icon",className:"h-8 w-8 text-amber-500 hover:text-amber-700",onClick:()=>U(a),children:e.jsx(le,{className:"h-4 w-4"})})}),e.jsx(L,{children:e.jsx("p",{children:s("Edit")})})]})}),e.jsx(w,{children:e.jsxs(M,{children:[e.jsx(E,{asChild:!0,children:e.jsx(x,{variant:"ghost",size:"icon",className:"h-8 w-8 text-red-500 hover:text-red-700",onClick:()=>B(a),children:e.jsx($,{className:"h-4 w-4"})})}),e.jsx(L,{children:e.jsx("p",{children:s("Delete")})})]})})]})})]},a.id))})]}),e.jsx(J,{open:z,onOpenChange:c,children:e.jsxs(K,{children:[e.jsx(X,{children:e.jsx(Y,{children:s(h?"Edit Webhook":"Add New Webhook")})}),e.jsxs("form",{onSubmit:R,className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(y,{htmlFor:"module",children:s("Module")}),e.jsxs(O,{value:m.module,onValueChange:a=>u(t=>({...t,module:a})),children:[e.jsx(W,{children:e.jsx(A,{placeholder:s("Select module")})}),e.jsxs(I,{className:"z-[60000]",children:[e.jsx(l,{value:"New User",children:s("New User")}),e.jsx(l,{value:"Lead Assigned",children:s("Lead Create")}),e.jsx(l,{value:"Case Created",children:s("Case Create")}),e.jsx(l,{value:"Meeting Invitation",children:s("Meeting Invitation")}),e.jsx(l,{value:"Opportunity Created",children:s("Opportunity Create")}),e.jsx(l,{value:"Quote Created",children:s("Quote Create")}),e.jsx(l,{value:"Task Assigned",children:s("Task Create")})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(y,{htmlFor:"method",children:s("Method")}),e.jsxs(O,{value:m.method,onValueChange:a=>u(t=>({...t,method:a})),children:[e.jsx(W,{children:e.jsx(A,{placeholder:s("Select method")})}),e.jsxs(I,{className:"z-[60000]",children:[e.jsx(l,{value:"GET",children:"GET"}),e.jsx(l,{value:"POST",children:"POST"})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(y,{htmlFor:"url",children:s("URL")}),e.jsx(Z,{id:"url",type:"url",placeholder:"https://example.com/webhook",value:m.url,onChange:a=>u(t=>({...t,url:a.target.value})),required:!0})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(x,{type:"button",variant:"outline",onClick:()=>c(!1),children:s("Cancel")}),e.jsx(x,{type:"submit",children:s(h?"Update":"Create")})]})]})]})}),e.jsx(te,{isOpen:F,onClose:V,onConfirm:H,itemName:(o==null?void 0:o.module)||"",entityName:s("Webhook")})]})})}export{pe as default};
