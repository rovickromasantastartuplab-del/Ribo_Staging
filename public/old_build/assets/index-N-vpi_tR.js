import{r as m,j as t}from"./ui-C-VW1P-5.js";import{P as mt,B as ut}from"./page-template-CDM26U5Q.js";import{u as pt,K as xt,h as c,a8 as gt,P as Se,S as b,C as Ce,B as P,T as z,t as i}from"./app-BQKKzqf3.js";import{D as Le,a as De,b as Ae,c as _,d as K}from"./language-switcher-BX314FqS.js";import{C as ht}from"./CrudTable-DuIO85h3.js";import{C as R}from"./CrudFormModal-BgN_j_X-.js";import{C as vt}from"./CrudDeleteModal-Bjo4FQXD.js";import{I as ft}from"./ImportModal-DDVlJKGF.js";import{P as Fe}from"./pagination-mhOv5uX0.js";import{S as bt}from"./search-and-filter-bar-CB2HkcPS.js";import{u as yt}from"./use-initials-C9WE3Vip.js";import{D as wt}from"./download-CUJ4p28I.js";import{E as Pe}from"./ellipsis-BsqioQZd.js";import{E as B}from"./eye-DxUCHEvv.js";import{S as W}from"./square-pen-DbvvCy40.js";import{U as jt}from"./users-CrY8npWB.js";import{U as Nt}from"./user-B-NTs7Zv.js";import"./vendor-CxtKjBZA.js";import"./textarea-BvlD1v8z.js";import"./select-ivmaqUw7.js";import"./index-IS-ASe-l.js";import"./chevron-up-5kET5X99.js";import"./react-country-flag.esm-B_SRkH7q.js";import"./language-BbwPiY59.js";import"./loader-circle-DlS76Sc1.js";import"./copy-D-hAzd4M.js";import"./chevron-right-C7M1oeKV.js";import"./credit-card-CmRw-oUn.js";import"./settings-G3vQs6CU.js";import"./dollar-sign-BO1aYhXH.js";import"./mail-DI9tSiFs.js";import"./package-BHhWwbAI.js";import"./calendar-BZ7v_rN9.js";import"./phone-B9JuG5Em.js";import"./trending-up-BUQ_r1Kz.js";import"./use-favicon-D-Hpb8YY.js";import"./utils-DCj7OOX3.js";import"./switch-T0u5R7d_.js";import"./refresh-cw-BnxOCyDc.js";import"./globe-BSt65iB3.js";import"./table-Cm3ifs76.js";import"./activity-BlqoVjjD.js";import"./unlink-CIrE65Ci.js";import"./archive-Clb3Wsap.js";import"./arrow-left-CYc20UlY.js";import"./arrow-right-B7V9NE53.js";import"./circle-help-DoNFXKiW.js";import"./lock-open-CBxZhRNn.js";import"./award-ClOH67b_.js";import"./wallet-G_F5INNy.js";import"./key-D9NdYYsw.js";import"./webhook-DRgOw1J7.js";import"./store-W0ENpN1D.js";import"./building-DYqVTalU.js";import"./camera-Cy0DV6zN.js";import"./chart-column-DLMw04GC.js";import"./chart-pie-C3AvH4oN.js";import"./chevron-left-Cy-TANhf.js";import"./circle-alert-Ba7f7jIF.js";import"./circle-check-big-ClvvRvVa.js";import"./circle-BMwBABJJ.js";import"./clock-DRJ3azky.js";import"./code-DoOxvyWM.js";import"./grid-3x3-B93v7dH2.js";import"./external-link-nVhYE8Jw.js";import"./eye-off-Dy-fpfrJ.js";import"./instagram-Dy7YsGuh.js";import"./file-2l6WoCvh.js";import"./folder-open-Berbn4mP.js";import"./grip-vertical-hmSrLZiM.js";import"./hard-drive-CBRsIzd1.js";import"./heart-CUqaTJ0A.js";import"./indian-rupee-D8_RKA6E.js";import"./info-ZEKNfV81.js";import"./lightbulb-B6cGkit3.js";import"./link-2-ZacHXNCA.js";import"./twitter-DwqeIVgg.js";import"./list-D15qstQa.js";import"./lock-DLCREvz4.js";import"./map-pin-BDUdmeW2.js";import"./menu-DkHdB524.js";import"./message-square-DJa7rgfT.js";import"./monitor-BaCWvDIc.js";import"./percent-Ca67PI5w.js";import"./play-BIO6trhV.js";import"./power-ph8Hxezk.js";import"./printer-CMSe0GyN.js";import"./wifi-D3ejDzoN.js";import"./quote-D-eoVvuu.js";import"./send-Ci4mpdkr.js";import"./server-VPjmlBKw.js";import"./shield-DgdOjZQK.js";import"./shopping-cart-BQ16UXZH.js";import"./square-check-big-BV0umpWv.js";import"./star-D7bZLLWj.js";import"./tag-Cr3RI_n7.js";import"./target-BI71-IGe.js";import"./triangle-alert-DtTk7Xcn.js";import"./truck--5x8h15q.js";import"./type-CuVOkJfB.js";import"./user-plus-BGAma7su.js";import"./weight-Ch9O_shw.js";import"./zap-CYBGuK61.js";import"./radio-group-CSjni1r3.js";import"./checkbox-mSB0gHip.js";import"./scroll-area-vUH8MN0-.js";import"./alert-Bt8OE1Tt.js";function ka(){var le,oe,de,ce,me,ue,pe,xe,ge,he,ve,fe,be;const{t:e}=pt(),{auth:k,leads:r,leadStatuses:C=[],leadSources:G=[],accounts:Te=[],campaigns:Ee=[],accountIndustries:Oe=[],accountTypes:Ie=[],users:Y=[],samplePath:Me,filters:g={},kanbanData:_t}=xt().props,d=(k==null?void 0:k.permissions)||[],M=((le=k==null?void 0:k.user)==null?void 0:le.type)==="company",Ve=c(d,"manage-leads"),V=yt(),[y,H]=m.useState(g.search||""),[j,X]=m.useState(g.lead_status_id||"all"),[h,J]=m.useState(g.lead_source_id||"all"),[v,Q]=m.useState(g.status||"all"),[w,Z]=m.useState(g.is_converted||"all"),[N,ee]=m.useState(g.assigned_to||"all"),[$e,te]=m.useState(!1),[qe,D]=m.useState(!1),[Ue,$]=m.useState(!1),[ze,T]=m.useState(!1),[Ke,se]=m.useState(!1),[F,ae]=m.useState("account"),[u,q]=m.useState(null),[o,U]=m.useState("create"),[f,Re]=m.useState(g.view||"kanban"),[E,Be]=m.useState(null),[kt,We]=m.useState(null),[Ge,re]=m.useState(!1),[ie,Ye]=m.useState(""),He=()=>y!==""||j!=="all"||h!=="all"||v!=="all"||w!=="all"||N!=="all",Xe=()=>(y?1:0)+(j!=="all"?1:0)+(h!=="all"?1:0)+(v!=="all"?1:0)+(w!=="all"?1:0)+(N!=="all"?1:0),Je=s=>{s.preventDefault(),ne()},ne=()=>{b.get(route("leads.index"),{view:f,page:1,search:y||void 0,lead_status_id:j!=="all"?j:void 0,lead_source_id:h!=="all"?h:void 0,status:v!=="all"?v:void 0,assigned_to:N!=="all"?N:void 0},{preserveState:!0,preserveScroll:!0})},Qe=()=>{var s,a;(a=(s=R).handleExport)==null||a.call(s)},Ze=s=>{const a=g.sort_field===s&&g.sort_direction==="desc"?"asc":"desc";b.get(route("leads.index"),{sort_field:s,sort_direction:a,page:1,search:y||void 0,lead_status_id:j!=="all"?j:void 0,lead_source_id:h!=="all"?h:void 0,status:v!=="all"?v:void 0,is_converted:w!=="all"?w:void 0,assigned_to:N!=="all"?N:void 0,...g.per_page&&g.per_page!==10&&{per_page:g.per_page}},{preserveState:!0,preserveScroll:!0})},p=(s,a)=>{switch(q(a),s){case"view":b.get(route("leads.show",a.id));break;case"edit":U("edit"),D(!0);break;case"delete":$(!0);break;case"toggle-status":rt(a);break;case"convert-to-account":ae("account"),T(!0);break;case"convert-to-contact":ae("contact"),T(!0);break}},et=()=>{q(null),U("create"),D(!0)},tt=s=>{q(null),U("create"),Ye(s),D(!0)},st=s=>{if(o==="create")i.loading(e("Creating lead...")),b.post(route("leads.store"),s,{onSuccess:a=>{D(!1),i.dismiss(),a.props.flash.success?i.success(e(a.props.flash.success)):a.props.flash.error?i.error(e(a.props.flash.error)):a.props.flash.warning&&i.warning(e(a.props.flash.warning)),f==="kanban"&&A()},onError:a=>{i.dismiss(),typeof a=="string"?i.error(a):i.error(e("Failed to create: {{errors}}",{errors:Object.values(a).join(", ")}))}});else if(o==="edit"){if(!c(d,"edit-leads")){i.error(e("Permission denied."));return}i.loading(e("Updating lead...")),b.put(route("leads.update",u.id),s,{onSuccess:a=>{D(!1),i.dismiss(),a.props.flash.success?i.success(e(a.props.flash.success)):a.props.flash.error?i.error(e(a.props.flash.error)):a.props.flash.warning&&i.warning(e(a.props.flash.warning))},onError:a=>{i.dismiss(),typeof a=="string"?i.error(a):i.error(e("Failed to update: {{errors}}",{errors:Object.values(a).join(", ")}))}})}},at=()=>{i.loading(e("Deleting lead...")),b.delete(route("leads.destroy",u.id),{onSuccess:s=>{$(!1),i.dismiss(),s.props.flash.success?i.success(e(s.props.flash.success)):s.props.flash.error?i.error(e(s.props.flash.error)):s.props.flash.warning&&i.warning(e(s.props.flash.warning)),f==="kanban"&&A()},onError:s=>{i.dismiss(),typeof s=="string"?i.error(s):i.error(e("Failed to delete: {{errors}}",{errors:Object.values(s).join(", ")}))}})},rt=s=>{if(!c(d,"toggle-status-leads")){i.error(e("Permission denied."));return}const a=s.status==="active"?"inactive":"active";i.loading(`${e(a==="active"?"Activating":"Deactivating")} lead...`),b.put(route("leads.toggle-status",s.id),{},{onSuccess:l=>{i.dismiss(),l.props.flash.success?i.success(e(l.props.flash.success)):l.props.flash.error?i.error(e(l.props.flash.error)):l.props.flash.warning&&i.warning(e(l.props.flash.warning)),f==="kanban"&&A()},onError:l=>{i.dismiss(),typeof l=="string"?i.error(l):i.error(e("Failed to update status: {{errors}}",{errors:Object.values(l).join(", ")}))}})},it=s=>{const a=F==="account"?"leads.convert-to-account":"leads.convert-to-contact";i.loading(e(`Converting lead to ${F}...`)),b.put(route(a,u.id),s,{onSuccess:l=>{T(!1),i.dismiss(),l.props.flash.success?i.success(e(l.props.flash.success)):l.props.flash.error?i.error(e(l.props.flash.error)):l.props.flash.warning&&i.warning(e(l.props.flash.warning)),f==="kanban"&&A()},onError:l=>{i.dismiss(),typeof l=="string"?i.error(l):i.error(e("Failed to convert: {{errors}}",{errors:Object.values(l).join(", ")}))}})},nt=()=>{H(""),X("all"),J("all"),Q("all"),Z("all"),ee("all"),te(!1),b.get(route("leads.index"),{view:f,page:1},{preserveState:!0,preserveScroll:!0})},A=()=>{if(f!=="kanban"||C.length===0)return;re(!0);const s=(r==null?void 0:r.data)||[],a={};C.forEach(l=>{a[l.id]={status:l,items:s.filter(n=>{var ye,we,je,Ne,_e,ke;const S=((ye=n.lead_status)==null?void 0:ye.id)===l.id,L=!y||((we=n.name)==null?void 0:we.toLowerCase().includes(y.toLowerCase()))||((je=n.email)==null?void 0:je.toLowerCase().includes(y.toLowerCase()))||((Ne=n.phone)==null?void 0:Ne.toLowerCase().includes(y.toLowerCase()))||((_e=n.company)==null?void 0:_e.toLowerCase().includes(y.toLowerCase())),x=h==="all"||((ke=n.lead_source_id)==null?void 0:ke.toString())===h,I=v==="all"||n.status===v,ct=w==="all"||w==="1"&&n.is_converted||w==="0"&&!n.is_converted;return S&&L&&x&&I&&ct})}}),Be(a),We(a),re(!1)};m.useEffect(()=>{f==="kanban"&&C.length>0&&A()},[f,r,y,h,v,w,C]);const O=[];c(d,"export-leads")&&O.push({label:e("Export"),icon:t.jsx(wt,{className:"h-4 w-4 mr-2"}),variant:"outline",onClick:()=>Qe()}),c(d,"import-leads")&&O.push({label:e("Import"),icon:t.jsx(gt,{className:"h-4 w-4 mr-2"}),variant:"outline",onClick:()=>se(!0)}),c(d,"create-leads")&&O.push({label:e("Add Lead"),icon:t.jsx(Se,{className:"h-4 w-4 mr-2"}),variant:"default",onClick:()=>et()});const lt=[{title:e("Dashboard"),href:route("dashboard")},{title:e("Lead Management")},{title:e("Leads")}],ot=[{key:"name",label:e("Name"),sortable:!0,render:(s,a)=>t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-primary text-white",children:V(a.name)}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:a.name}),t.jsx("div",{className:"text-sm text-muted-foreground",children:a.email||e("No email")})]})]})},{key:"company",label:e("Company"),render:s=>s||e("-")},{key:"value",label:e("Value"),sortable:!0,render:s=>{var a;return s?((a=window.appSettings)==null?void 0:a.formatCurrency(parseFloat(s)))||`$${parseFloat(s).toFixed(2)}`:e("-")}},{key:"lead_status",label:e("Progress"),render:s=>s?t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:s.color}}),t.jsx("span",{children:s.name})]}):e("-")},{key:"status",label:e("Status"),render:s=>t.jsx("span",{className:`inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ${s==="active"?"bg-green-50 text-green-700 ring-1 ring-inset ring-green-600/20":"bg-red-50 text-red-700 ring-1 ring-inset ring-red-600/20"}`,children:e(s==="active"?"Active":"Inactive")})},{key:"assigned_user",label:e("Assigned To"),render:s=>(s==null?void 0:s.name)||e("Unassigned")},{key:"is_converted",label:e("Converted"),render:s=>t.jsx("span",{className:`inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ${s?"bg-green-50 text-green-700 ring-1 ring-inset ring-green-600/20":"bg-gray-50 text-gray-700 ring-1 ring-inset ring-gray-600/20"}`,children:e(s?"Yes":"No")})},{key:"created_at",label:e("Created At"),sortable:!0,render:s=>{var a;return((a=window.appSettings)==null?void 0:a.formatDateTime(s,!1))||new Date(s).toLocaleDateString()}}],dt=[{label:e("View"),icon:"Eye",action:"view",className:"text-blue-500",requiredPermission:"view-leads"},{label:e("Edit"),icon:"Edit",action:"edit",className:"text-amber-500",requiredPermission:"edit-leads"},{label:e("Toggle Status"),icon:"Lock",action:"toggle-status",className:"text-amber-500",requiredPermission:"toggle-status-leads"},{label:e("Convert to Account"),icon:"Building2",action:"convert-to-account",className:"text-green-500",requiredPermission:"convert-leads",condition:s=>!s.is_converted},{label:e("Convert to Contact"),icon:"Users",action:"convert-to-contact",className:"text-blue-500",requiredPermission:"convert-leads",condition:s=>!s.is_converted},{label:e("Delete"),icon:"Trash2",action:"delete",className:"text-red-500",requiredPermission:"delete-leads"}];return t.jsxs(mt,{title:e("Leads"),url:"/leads",actions:O,breadcrumbs:lt,noPadding:!0,className:f==="kanban"?"overflow-hidden":"",children:[t.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow mb-4 p-4",children:t.jsx(bt,{searchTerm:y,onSearchChange:H,onSearch:Je,filters:[{name:"lead_status_id",label:e("Lead Status"),type:"select",value:j,onChange:X,options:[{value:"all",label:e("All Statuses")},...C.map(s=>({value:s.id.toString(),label:s.name}))]},{name:"lead_source_id",label:e("Lead Source"),type:"select",value:h,onChange:J,options:[{value:"all",label:e("All Sources")},...G.map(s=>({value:s.id.toString(),label:s.name}))]},{name:"status",label:e("Status"),type:"select",value:v,onChange:Q,options:[{value:"all",label:e("All Status")},{value:"active",label:e("Active")},{value:"inactive",label:e("Inactive")}]},{name:"is_converted",label:e("Converted"),type:"select",value:w,onChange:Z,options:[{value:"all",label:e("All")},{value:"1",label:e("Yes")},{value:"0",label:e("No")}]},...M||Ve?[{name:"assigned_to",label:e("Assigned To"),type:"select",value:N,onChange:ee,options:[{value:"all",label:e("All Users")},...Y.map(s=>({value:s.id.toString(),label:s.name}))]}]:[]],showFilters:$e,setShowFilters:te,hasActiveFilters:He,activeFilterCount:Xe,onResetFilters:nt,onApplyFilters:ne,...f!=="kanban"&&{currentPerPage:((oe=g.per_page)==null?void 0:oe.toString())||"10",onPerPageChange:s=>{const a={page:1,search:y||void 0,lead_status_id:j!=="all"?j:void 0,lead_source_id:h!=="all"?h:void 0,status:v!=="all"?v:void 0,is_converted:w!=="all"?w:void 0,assigned_to:N!=="all"?N:void 0};parseInt(s)!==10&&(a.per_page=parseInt(s)),b.get(route("leads.index"),a,{preserveState:!0,preserveScroll:!0})}},showViewToggle:!0,activeView:f,onViewChange:s=>{Re(s),b.get(route("leads.index"),{view:s,search:y||void 0,lead_status_id:j!=="all"?j:void 0,lead_source_id:h!=="all"?h:void 0,status:v!=="all"?v:void 0,is_converted:w!=="all"?w:void 0,assigned_to:N!=="all"?N:void 0},{preserveState:!0,preserveScroll:!0})},viewOptions:[{value:"list",label:e("List View"),icon:"List"},{value:"kanban",label:e("Kanban View"),icon:"Columns"},{value:"grid",label:e("Grid View"),icon:"Grid3X3"}]})}),f==="list"?t.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow overflow-hidden",children:[t.jsx(ht,{columns:ot,actions:dt,data:(r==null?void 0:r.data)||[],from:(r==null?void 0:r.from)||1,onAction:p,sortField:g.sort_field,sortDirection:g.sort_direction,onSort:Ze,permissions:d,entityPermissions:{view:"view-leads",create:"create-leads",edit:"edit-leads",delete:"delete-leads"}}),t.jsx(Fe,{from:(r==null?void 0:r.from)||1,to:(r==null?void 0:r.to)||((de=r==null?void 0:r.data)==null?void 0:de.length)||0,total:(r==null?void 0:r.total)||((ce=r==null?void 0:r.data)==null?void 0:ce.length)||0,links:r==null?void 0:r.links,entityName:e("leads"),onPageChange:s=>b.get(s)})]}):f==="kanban"?t.jsx(t.Fragment,{children:t.jsxs("div",{className:"w-full",children:[t.jsx("style",{children:`
              .kanban-scroll {
                overflow-x: auto;
                overflow-y: hidden;
              }
              .kanban-scroll::-webkit-scrollbar {
                height: 8px;
              }
              .kanban-scroll::-webkit-scrollbar-track {
                background: #f1f5f9;
                border-radius: 4px;
              }
              .kanban-scroll::-webkit-scrollbar-thumb {
                background: #cbd5e1;
                border-radius: 4px;
              }
              .kanban-scroll::-webkit-scrollbar-thumb:hover {
                background: #94a3b8;
              }
              main {
                max-width: 100vw;
                overflow-x: hidden;
              }
              body {
                overflow-x: hidden !important;
              }
            `}),t.jsx("div",{className:"bg-gray-50 p-4 rounded-lg overflow-hidden",children:Ge?t.jsx("div",{className:"flex items-center justify-center h-full",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),t.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:e("Loading kanban board...")})]})}):t.jsx("div",{className:"flex gap-4 overflow-x-auto pb-4",style:{height:"calc(100vh - 280px)",width:"100%"},children:C.map(s=>{var l;const a=((l=E==null?void 0:E[s.id])==null?void 0:l.items)||[];return t.jsx("div",{className:"flex-shrink-0",style:{minWidth:"calc(20% - 16px)",width:"calc(20% - 16px)"},onDrop:n=>{n.preventDefault(),n.currentTarget.classList.remove("bg-blue-50");const S=n.dataTransfer.getData("leadId");if(S){if(!c(d,"edit-leads")){i.error(e("Permission denied."));return}i.loading("Updating lead status...");const L=Object.values(E).flatMap(x=>x.items).find(x=>x.id.toString()===S);L&&b.put(route("leads.update",S),{...L,lead_status_id:s.id},{onSuccess:x=>{var I;i.dismiss(),(I=x.props.flash)!=null&&I.success?i.success(e(x.props.flash.success)):x.props.flash.error&&i.error(e(x.props.flash.error)),A()},onError:()=>{i.dismiss(),i.error(e("Failed to update lead status"))}})}},onDragOver:n=>{n.preventDefault(),n.currentTarget.classList.add("bg-blue-50")},onDragLeave:n=>{n.currentTarget.classList.remove("bg-blue-50")},children:t.jsxs("div",{className:"bg-gray-100 rounded-lg h-full flex flex-col",children:[t.jsxs("div",{className:"p-3 border-b border-gray-200",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:s.color}}),t.jsx("h3",{className:"font-semibold text-sm text-gray-700",children:s.name})]}),t.jsx("span",{className:"text-xs text-gray-500 bg-gray-200 px-2 py-1 rounded-full",children:a.length})]}),c(d,"create-leads")&&t.jsxs("button",{onClick:()=>tt(s.id.toString()),className:"w-full text-xs text-gray-600 hover:text-blue-600 hover:bg-blue-50 py-2 px-3 rounded-md border border-dashed border-gray-300 hover:border-blue-300 transition-all duration-200 flex items-center justify-center gap-1",children:[t.jsx(Se,{className:"h-3 w-3"}),e("Add Lead")]})]}),t.jsxs("div",{className:"p-2 space-y-2 overflow-y-auto flex-1",style:{maxHeight:"calc(100vh - 350px)"},children:[a.map(n=>{var S,L;return t.jsx("div",{draggable:c(d,"edit-leads"),onDragStart:x=>{if(!c(d,"edit-leads")){x.preventDefault();return}x.dataTransfer.setData("leadId",n.id.toString()),x.currentTarget.classList.add("opacity-50","scale-95")},onDragEnd:x=>{x.currentTarget.classList.remove("opacity-50","scale-95")},className:`transition-all duration-200 ${c(d,"edit-leads")?"cursor-move":"cursor-default"}`,children:t.jsx(Ce,{className:"hover:shadow-md transition-all duration-200 border-l-4 hover:scale-105",style:{borderLeftColor:s.color},children:t.jsx("div",{className:"p-3",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsx("h4",{className:"font-medium text-sm line-clamp-2 hover:text-blue-600 transition-colors cursor-pointer flex-1",onClick:()=>p("view",n),children:n.name}),t.jsxs(Le,{children:[t.jsx(De,{asChild:!0,children:t.jsx(P,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 text-gray-400 hover:text-gray-600",children:t.jsx(Pe,{className:"h-4 w-4"})})}),t.jsxs(Ae,{align:"end",className:"w-40",children:[t.jsxs(_,{onClick:()=>p("view",n),children:[t.jsx(B,{className:"h-4 w-4 mr-2"}),e("View")]}),c(d,"edit-leads")&&t.jsxs(_,{onClick:()=>p("edit",n),children:[t.jsx(W,{className:"h-4 w-4 mr-2"}),e("Edit")]}),c(d,"convert-leads")&&!n.is_converted&&t.jsxs(t.Fragment,{children:[t.jsx(K,{}),t.jsxs(_,{onClick:()=>p("convert-to-account",n),className:"text-green-600",children:[t.jsx(ut,{className:"h-4 w-4 mr-2"}),e("Convert to Account")]}),t.jsxs(_,{onClick:()=>p("convert-to-contact",n),className:"text-blue-600",children:[t.jsx(jt,{className:"h-4 w-4 mr-2"}),e("Convert to Contact")]})]}),c(d,"delete-leads")&&t.jsxs(t.Fragment,{children:[t.jsx(K,{}),t.jsxs(_,{onClick:()=>p("delete",n),className:"text-red-600",children:[t.jsx(z,{className:"h-4 w-4 mr-2"}),e("Delete")]})]})]})]})]}),t.jsxs("div",{className:"text-xs text-gray-600",children:[n.email&&t.jsx("div",{children:n.email}),n.company&&t.jsx("div",{children:n.company})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("div",{className:"text-xs text-gray-500",children:n.value?((S=window.appSettings)==null?void 0:S.formatCurrency(parseFloat(n.value)))||`$${parseFloat(n.value).toFixed(2)}`:e("No value")}),n.assigned_user&&t.jsx("div",{className:"flex h-5 w-5 items-center justify-center rounded-full bg-primary text-white text-xs",children:V(n.assigned_user.name)})]}),t.jsxs("div",{className:"flex justify-between items-center text-xs text-gray-500",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[n.is_converted&&t.jsx("span",{className:"inline-flex items-center rounded-md px-2 py-1 text-xs font-medium bg-green-50 text-green-700 ring-1 ring-inset ring-green-600/20",children:e("Converted")}),t.jsx("span",{className:`inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ${n.status==="active"?"bg-green-50 text-green-700 ring-1 ring-inset ring-green-600/20":"bg-red-50 text-red-700 ring-1 ring-inset ring-red-600/20"}`,children:n.status==="active"?e("Active"):e("Inactive")})]}),t.jsx("span",{children:((L=window.appSettings)==null?void 0:L.formatDateTime(n.created_at,!1))||new Date(n.created_at).toLocaleDateString()})]})]})})})},n.id)}),a.length===0&&t.jsxs("div",{className:"text-center py-8 text-gray-400",children:[t.jsx(Nt,{className:"h-8 w-8 mx-auto mb-2"}),t.jsx("p",{className:"text-sm",children:e("No leads")})]})]})]})},s.id)})})})]})}):t.jsxs("div",{children:[t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:(me=r==null?void 0:r.data)==null?void 0:me.map(s=>{var a,l;return t.jsx(Ce,{className:"bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-700 rounded-lg shadow",children:t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex items-start justify-between mb-4",children:[t.jsxs("div",{className:"flex items-start space-x-4",children:[t.jsx("div",{className:"h-16 w-16 rounded-full bg-primary text-white flex items-center justify-center text-lg font-bold",children:V(s.name)}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-2",children:s.name}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-3",children:s.email||e("No email")}),t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:`h-2 w-2 rounded-full mr-2 ${s.status==="active"?"bg-green-500":"bg-gray-400"}`}),t.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:s.status==="active"?e("Active"):e("Inactive")})]})]})]}),t.jsxs(Le,{children:[t.jsx(De,{asChild:!0,children:t.jsx(P,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-gray-400 hover:text-gray-600 dark:text-gray-400 dark:hover:text-gray-300",children:t.jsx(Pe,{className:"h-4 w-4"})})}),t.jsxs(Ae,{align:"end",className:"w-48 z-50",sideOffset:5,children:[c(d,"view-leads")&&t.jsxs(_,{onClick:()=>p("view",s),children:[t.jsx(B,{className:"h-4 w-4 mr-2"}),t.jsx("span",{children:e("View Lead")})]}),c(d,"toggle-status-leads")&&t.jsx(_,{onClick:()=>p("toggle-status",s),children:t.jsx("span",{children:s.status==="active"?e("Deactivate"):e("Activate")})}),c(d,"convert-leads")&&!s.is_converted&&t.jsxs(t.Fragment,{children:[t.jsx(_,{onClick:()=>p("convert-to-account",s),className:"text-green-600",children:t.jsx("span",{children:e("Convert to Account")})}),t.jsx(_,{onClick:()=>p("convert-to-contact",s),className:"text-blue-600",children:t.jsx("span",{children:e("Convert to Contact")})})]}),t.jsx(K,{}),c(d,"edit-leads")&&t.jsxs(_,{onClick:()=>p("edit",s),className:"text-amber-600",children:[t.jsx(W,{className:"h-4 w-4 mr-2"}),t.jsx("span",{children:e("Edit")})]}),c(d,"delete-leads")&&t.jsxs(_,{onClick:()=>p("delete",s),className:"text-rose-600",children:[t.jsx(z,{className:"h-4 w-4 mr-2"}),t.jsx("span",{children:e("Delete")})]})]})]})]}),t.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-md p-3 mb-4",children:[t.jsx("div",{className:"mb-2",children:t.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[e("Company"),": ",s.company||e("-")]})}),t.jsx("div",{className:"mb-2",children:t.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[e("Value"),": ",s.value?((a=window.appSettings)==null?void 0:a.formatCurrency(parseFloat(s.value)))||`$${parseFloat(s.value).toFixed(2)}`:e("-")]})}),t.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.lead_status&&t.jsxs("span",{className:"inline-flex items-center rounded-md bg-blue-50 dark:bg-blue-900/30 px-2 py-1 text-xs font-medium text-blue-700 dark:text-blue-300",children:[t.jsx("div",{className:"w-2 h-2 rounded-full mr-1",style:{backgroundColor:s.lead_status.color}}),s.lead_status.name]}),s.is_converted&&t.jsx("span",{className:"inline-flex items-center rounded-md bg-green-50 dark:bg-green-900/30 px-2 py-1 text-xs font-medium text-green-700 dark:text-green-300",children:e("Converted")})]})]}),t.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-4",children:[e("Created:")," ",((l=window.appSettings)==null?void 0:l.formatDateTime(s.created_at,!1))||new Date(s.created_at).toLocaleDateString()]}),t.jsxs("div",{className:"flex gap-2",children:[c(d,"edit-leads")&&t.jsxs(P,{variant:"outline",size:"sm",onClick:()=>p("edit",s),className:"flex-1 h-9 text-sm border-gray-300 dark:border-gray-600 dark:text-gray-200",children:[t.jsx(W,{className:"h-4 w-4 mr-2"}),e("Edit")]}),c(d,"view-leads")&&t.jsxs(P,{variant:"outline",size:"sm",onClick:()=>p("view",s),className:"flex-1 h-9 text-sm border-gray-300 dark:border-gray-600 dark:text-gray-200",children:[t.jsx(B,{className:"h-4 w-4 mr-2"}),e("View")]}),c(d,"delete-leads")&&t.jsxs(P,{variant:"outline",size:"sm",onClick:()=>p("delete",s),className:"flex-1 h-9 text-sm text-gray-700 border-gray-300 dark:border-gray-600 dark:text-gray-200",children:[t.jsx(z,{className:"h-4 w-4 mr-2"}),e("Delete")]})]})]})},s.id)})}),t.jsx("div",{className:"mt-6 bg-white dark:bg-gray-900 rounded-lg shadow overflow-hidden",children:t.jsx(Fe,{from:(r==null?void 0:r.from)||1,to:(r==null?void 0:r.to)||((ue=r==null?void 0:r.data)==null?void 0:ue.length)||0,total:(r==null?void 0:r.total)||((pe=r==null?void 0:r.data)==null?void 0:pe.length)||0,links:r==null?void 0:r.links,entityName:e("leads"),onPageChange:s=>b.get(s)})})]}),t.jsx(R,{isOpen:qe,onClose:()=>D(!1),onSubmit:st,formConfig:{...c(d,"export-leads")&&{exportRoute:"lead.export"},fields:[{name:"name",label:e("Lead Name"),type:"text",required:!0},{name:"email",label:e("Email"),type:"email"},{name:"phone",label:e("Phone"),type:"text"},{name:"company",label:e("Company"),type:"text"},{name:"account_name",label:e("Account Name"),type:"text"},{name:o==="view"?"account_industry_name":"account_industry_id",label:e("Account Industry"),type:o==="view"?"text":"select",readOnly:o==="view",options:o==="view"?[]:[...Oe.map(s=>({value:s.id,label:s.name}))]},{name:"website",label:e("Website"),type:"text"},{name:"position",label:e("Position"),type:"text"},{name:"value",label:e("Lead Value"),type:"number",step:"0.01",min:"0"},{name:o==="view"?"lead_status_name":"lead_status_id",label:e("Lead Status"),type:o==="view"?"text":"select",required:o!=="view",readOnly:o==="view",options:o==="view"?[]:C.map(s=>({value:s.id,label:s.name})),defaultValue:ie||void 0,hidden:o==="create"&&ie},{name:o==="view"?"lead_source_name":"lead_source_id",label:e("Lead Source"),type:o==="view"?"text":"select",required:o!=="view",readOnly:o==="view",options:o==="view"?[]:G.map(s=>({value:s.id,label:s.name}))},{name:"address",label:e("Address"),type:"textarea"},{name:o==="view"?"campaign_name":"campaign_id",label:e("Campaign"),type:o==="view"?"text":"select",readOnly:o==="view",options:o==="view"?[]:[...Ee.map(s=>({value:s.id,label:s.name}))]},{name:"notes",label:e("Notes"),type:"textarea"},...M?[{name:o==="view"?"assigned_user_name":"assigned_to",label:e("Assign To"),type:o==="view"?"text":"select",options:o==="view"?[]:[...Y.map(s=>({value:s.id,label:`${s.name} (${s.email})`}))],readOnly:o==="view",hidden:!M||(u==null?void 0:u.assigned_to)===((xe=k==null?void 0:k.user)==null?void 0:xe.id)}]:[],{name:"status",label:e("Status"),type:"select",options:[{value:"active",label:e("Active")},{value:"inactive",label:e("Inactive")}],defaultValue:"active"}],modalSize:"xl"},initialData:u?{...u,assigned_user_name:((ge=u.assigned_user)==null?void 0:ge.name)||e("Unassigned"),lead_status_name:((he=u.lead_status)==null?void 0:he.name)||e("-"),lead_source_name:((ve=u.lead_source)==null?void 0:ve.name)||e("-"),campaign_name:((fe=u.campaign)==null?void 0:fe.name)||e("No Campaign"),account_industry_name:((be=u.account_industry)==null?void 0:be.name)||e("-")}:null,title:e(o==="create"?"Add New Lead":o==="edit"?"Edit Lead":"View Lead"),mode:o}),t.jsx(vt,{isOpen:Ue,onClose:()=>$(!1),onConfirm:at,itemName:(u==null?void 0:u.name)||"",entityName:e("lead")}),t.jsx(R,{isOpen:ze,onClose:()=>T(!1),onSubmit:it,formConfig:{fields:F==="account"?[{name:"account_type_id",label:e("Account Type"),type:"select",required:!0,options:Ie.map(s=>({value:s.id,label:s.name}))},{name:"website",label:e("Website"),type:"text"},{name:"address",label:e("Address"),type:"textarea"}]:[{name:"account_id",label:e("Account"),type:"select",required:!0,options:Te.map(s=>({value:s.id,label:s.name}))},{name:"position",label:e("Position"),type:"text"},{name:"address",label:e("Address"),type:"textarea"}],modalSize:"lg"},initialData:u?{address:u.address,website:F==="account"?u.website:void 0}:null,title:e(`Convert Lead to ${F==="account"?"Account":"Contact"}`),mode:"create"}),t.jsx(ft,{isOpen:Ke,onClose:()=>se(!1),title:e("Import Leads from CSV/Excel"),importRoute:"lead.import",parseRoute:"lead.parse",samplePath:Me,importNotes:e("Ensure that the values entered for Lead Status, Lead Source, Account Industry, Campaign match the existing records in your system."),databaseFields:[{key:"name",required:!0},{key:"email"},{key:"phone"},{key:"company"},{key:"account_name"},{key:"account_industry"},{key:"website"},{key:"position"},{key:"value"},{key:"lead_status",required:!0},{key:"lead_source",required:!0},{key:"address"},{key:"campaign"},{key:"notes"},{key:"status"}]})]})}export{ka as default};
