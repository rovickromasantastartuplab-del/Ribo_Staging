import{r as l,j as a}from"./ui-C-VW1P-5.js";import{P as K}from"./page-template-CDM26U5Q.js";import{u as I,K as M,ad as B,t as o,B as g,g as $,S as x,C as J,I as w,D as U,l as W,n as _,o as z,r as G,T as Q}from"./app-BQKKzqf3.js";import{S as V}from"./scroll-area-vUH8MN0-.js";import{R as Y}from"./react-country-flag.esm-B_SRkH7q.js";import{L as Z}from"./lock-DLCREvz4.js";import{R as ee}from"./refresh-cw-BnxOCyDc.js";import{P as ae}from"./power-ph8Hxezk.js";import"./vendor-CxtKjBZA.js";import"./textarea-BvlD1v8z.js";import"./select-ivmaqUw7.js";import"./index-IS-ASe-l.js";import"./chevron-up-5kET5X99.js";import"./language-BbwPiY59.js";import"./loader-circle-DlS76Sc1.js";import"./copy-D-hAzd4M.js";import"./language-switcher-BX314FqS.js";import"./switch-T0u5R7d_.js";import"./globe-BSt65iB3.js";import"./settings-G3vQs6CU.js";import"./chevron-right-C7M1oeKV.js";import"./credit-card-CmRw-oUn.js";import"./dollar-sign-BO1aYhXH.js";import"./mail-DI9tSiFs.js";import"./users-CrY8npWB.js";import"./package-BHhWwbAI.js";import"./calendar-BZ7v_rN9.js";import"./phone-B9JuG5Em.js";import"./trending-up-BUQ_r1Kz.js";import"./user-B-NTs7Zv.js";import"./use-favicon-D-Hpb8YY.js";import"./utils-DCj7OOX3.js";function Oe(){var y,L,S;const{t:s}=I(),{languages:N,defaultLang:i,defaultData:d,availableLanguages:T,isCurrentLanguageEnabled:D,auth:m}=M().props,[n,E]=l.useState(i),[j,c]=l.useState(d),[k,p]=l.useState(!1),[v,h]=l.useState(!1),[f,R]=l.useState(""),[A,u]=l.useState(!1),[b,C]=l.useState(!1),F=((L=(y=m==null?void 0:m.user)==null?void 0:y.roles)==null?void 0:L.map(e=>e.name))||[],O=B("superadmin",F);l.useEffect(()=>{E(i)},[i]),l.useEffect(()=>{if(n===i&&Object.keys(d).length>0){c(d);return}p(!0),fetch(`${route("language.load")}?lang=${n}`).then(e=>e.json()).then(e=>{e.data?c(e.data):c({}),p(!1)}).catch(()=>{c({}),p(!1),o.error(s("Failed to load language file"))})},[n,i,d,s]);const P=(e,t)=>{c(r=>({...r,[e]:t}))},q=e=>{var t;return e&&e.preventDefault(),h(!0),fetch(route("language.save"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"))||"",Accept:"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({_method:"PATCH",lang:n,data:j})}).then(r=>r.json()).then(r=>{r.success?o.success(r.success||s("Language updated successfully")):r.error?o.error(r.error):o.error(s(r.message)),h(!1)}).catch(r=>{console.error("Save error:",r),o.error(s("Failed to update language file")),h(!1)}),!1},X=async()=>{var e;try{const t=await fetch(route("languages.delete",n),{method:"DELETE",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((e=document.querySelector('meta[name="csrf-token"]'))==null?void 0:e.getAttribute("content"))||"",Accept:"application/json"}});if(t.ok)o.success("Language deleted successfully"),u(!1),x.get(route("manage-language",{lang:"en"}));else{const r=await t.json();o.error(r.message||"Failed to delete language")}}catch{o.error("Failed to delete language")}},H=async()=>{var e;C(!0);try{const t=await fetch(route("languages.toggle",n),{method:"PATCH",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((e=document.querySelector('meta[name="csrf-token"]'))==null?void 0:e.getAttribute("content"))||"",Accept:"application/json"}});if(t.ok)o.success("Language status updated successfully"),x.get(route("manage-language",{lang:"en"}));else{const r=await t.json();o.error(r.message||"Failed to update language status")}}catch(t){console.log("Toggle error : ",t),o.error("Failed to update language status")}finally{C(!1)}};return a.jsxs(K,{title:s("Manage Language"),url:"/manage-language",actions:[...n!=="en"&&O?[{label:s(b?"Updating...":D?"Disable Language":"Enable Language"),icon:b?a.jsx(ee,{className:"h-4 w-4 animate-spin"}):a.jsx(ae,{className:"h-4 w-4"}),variant:"outline",onClick:H},{label:s("Delete Language"),icon:a.jsx(Q,{className:"h-4 w-4"}),variant:"destructive",onClick:()=>u(!0)}]:[]],children:[a.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[a.jsx("div",{className:"md:w-64 flex-shrink-0",children:a.jsx("div",{className:"sticky top-20",children:a.jsx(V,{className:"h-[calc(100vh-5rem)]",children:a.jsx("div",{className:"pr-4 space-y-1",children:T.map(e=>{const t=e.enabled===!0||e.enabled===void 0&&!e.hasOwnProperty("enabled");return a.jsxs(g,{variant:"ghost",className:$("w-full justify-start gap-2",{"bg-muted font-medium":n===e.code,"text-muted-foreground":!t}),onClick:()=>{n!==e.code&&x.get(route("manage-language",{lang:e.code}))},children:[e.countryCode&&a.jsx(Y,{countryCode:e.countryCode,svg:!0,style:{width:"1.2em",height:"1.2em"}}),a.jsx("span",{className:t?"":"text-muted-foreground",children:e.name}),!t&&a.jsx(Z,{className:"h-3 w-3 ml-auto text-muted-foreground"})]},e.code)})})})})}),a.jsx("div",{className:"flex-1",children:a.jsxs(J,{className:"p-6",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-4 gap-2",children:[a.jsxs("h2",{className:"text-lg font-semibold",children:[s("Edit Labels for")," ",(S=N.find(e=>e.code===n))==null?void 0:S.name]}),a.jsx(w,{placeholder:s("Search labels..."),value:f,onChange:e=>R(e.target.value),className:"w-full md:w-72"})]}),k?a.jsx("div",{children:s("Loading...")}):a.jsx("form",{onSubmit:e=>(e.preventDefault(),q(e),!1),children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:Object.entries(j).filter(([e,t])=>e.toLowerCase().includes(f.toLowerCase())||t.toLowerCase().includes(f.toLowerCase())).map(([e,t])=>a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsx("label",{className:"text-xs text-muted-foreground truncate mb-1",children:e}),a.jsx(w,{className:"w-full",value:t,onChange:r=>P(e,r.target.value)})]},e))}),a.jsx("div",{className:"pt-6 text-right",children:a.jsx(g,{type:"submit",disabled:v,children:v?a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"animate-spin h-4 w-4 border-2 border-t-transparent border-primary rounded-full"}),s("Saving...")]}):s("Save Changes")})})]})})]})})]}),a.jsx(U,{open:A,onOpenChange:u,children:a.jsxs(W,{children:[a.jsx(_,{children:a.jsx(z,{children:s("Delete Language")})}),a.jsxs("p",{children:[s("Are you sure you want to delete the")," ",a.jsx("strong",{children:n})," ",s("language? This will remove all translation files and cannot be undone."),"."]}),a.jsxs(G,{children:[a.jsx(g,{variant:"outline",onClick:()=>u(!1),children:s("Cancel")}),a.jsx(g,{variant:"destructive",onClick:X,children:s("Delete Language")})]})]})})]})}export{Oe as default};
